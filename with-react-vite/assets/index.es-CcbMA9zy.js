const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-96QSbOuv.js","assets/index-D-c5h5Hy.js","assets/index-BZcti3oU.css"])))=>i.map(i=>d[i]);
import{bR as xi,as as oe,dE as Xg,f1 as Zg,fs as F3,c9 as an,c4 as hn,ft as U3,fu as L3,fv as Mi,fw as of,fx as Np,b9 as B3}from"./index-D-c5h5Hy.js";const q3=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,j3=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,$3=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function k3(r,t){if(r==="__proto__"||r==="constructor"&&t&&typeof t=="object"&&"prototype"in t){z3(r);return}return t}function z3(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function kc(r,t={}){if(typeof r!="string")return r;const e=r.trim();if(r[0]==='"'&&r.endsWith('"')&&!r.includes("\\"))return e.slice(1,-1);if(e.length<=9){const i=e.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!$3.test(r)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(q3.test(r)||j3.test(r)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,k3)}return JSON.parse(r)}catch(i){if(t.strict)throw i;return r}}function H3(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function mr(r,...t){try{return H3(r(...t))}catch(e){return Promise.reject(e)}}function K3(r){const t=typeof r;return r===null||t!=="object"&&t!=="function"}function V3(r){const t=Object.getPrototypeOf(r);return!t||t.isPrototypeOf(Object)}function tu(r){if(K3(r))return String(r);if(V3(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return tu(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function t1(){if(typeof xi>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const Cl="base64:";function G3(r){if(typeof r=="string")return r;t1();const t=xi.from(r).toString("base64");return Cl+t}function W3(r){return typeof r!="string"||!r.startsWith(Cl)?r:(t1(),xi.from(r.slice(Cl.length),"base64"))}function Kr(r){return r?r.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Y3(...r){return Kr(r.join(":"))}function zc(r){return r=Kr(r),r?r+":":""}const J3="memory",Q3=()=>{const r=new Map;return{name:J3,getInstance:()=>r,hasItem(t){return r.has(t)},getItem(t){return r.get(t)??null},getItemRaw(t){return r.get(t)??null},setItem(t,e){r.set(t,e)},setItemRaw(t,e){r.set(t,e)},removeItem(t){r.delete(t)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function X3(r={}){const t={mounts:{"":r.driver||Q3()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},e=l=>{for(const w of t.mountpoints)if(l.startsWith(w))return{base:w,relativeKey:l.slice(w.length),driver:t.mounts[w]};return{base:"",relativeKey:l,driver:t.mounts[""]}},i=(l,w)=>t.mountpoints.filter(_=>_.startsWith(l)||w&&l.startsWith(_)).map(_=>({relativeBase:l.length>_.length?l.slice(_.length):void 0,mountpoint:_,driver:t.mounts[_]})),s=(l,w)=>{if(t.watching){w=Kr(w);for(const _ of t.watchListeners)_(l,w)}},a=async()=>{if(!t.watching){t.watching=!0;for(const l in t.mounts)t.unwatch[l]=await Tp(t.mounts[l],s,l)}},u=async()=>{if(t.watching){for(const l in t.unwatch)await t.unwatch[l]();t.unwatch={},t.watching=!1}},h=(l,w,_)=>{const I=new Map,S=M=>{let G=I.get(M.base);return G||(G={driver:M.driver,base:M.base,items:[]},I.set(M.base,G)),G};for(const M of l){const G=typeof M=="string",V=Kr(G?M:M.key),Z=G?void 0:M.value,H=G||!M.options?w:{...w,...M.options},W=e(V);S(W).items.push({key:V,value:Z,relativeKey:W.relativeKey,options:H})}return Promise.all([...I.values()].map(M=>_(M))).then(M=>M.flat())},d={hasItem(l,w={}){l=Kr(l);const{relativeKey:_,driver:I}=e(l);return mr(I.hasItem,_,w)},getItem(l,w={}){l=Kr(l);const{relativeKey:_,driver:I}=e(l);return mr(I.getItem,_,w).then(S=>kc(S))},getItems(l,w){return h(l,w,_=>_.driver.getItems?mr(_.driver.getItems,_.items.map(I=>({key:I.relativeKey,options:I.options})),w).then(I=>I.map(S=>({key:Y3(_.base,S.key),value:kc(S.value)}))):Promise.all(_.items.map(I=>mr(_.driver.getItem,I.relativeKey,I.options).then(S=>({key:I.key,value:kc(S)})))))},getItemRaw(l,w={}){l=Kr(l);const{relativeKey:_,driver:I}=e(l);return I.getItemRaw?mr(I.getItemRaw,_,w):mr(I.getItem,_,w).then(S=>W3(S))},async setItem(l,w,_={}){if(w===void 0)return d.removeItem(l);l=Kr(l);const{relativeKey:I,driver:S}=e(l);S.setItem&&(await mr(S.setItem,I,tu(w),_),S.watch||s("update",l))},async setItems(l,w){await h(l,w,async _=>{if(_.driver.setItems)return mr(_.driver.setItems,_.items.map(I=>({key:I.relativeKey,value:tu(I.value),options:I.options})),w);_.driver.setItem&&await Promise.all(_.items.map(I=>mr(_.driver.setItem,I.relativeKey,tu(I.value),I.options)))})},async setItemRaw(l,w,_={}){if(w===void 0)return d.removeItem(l,_);l=Kr(l);const{relativeKey:I,driver:S}=e(l);if(S.setItemRaw)await mr(S.setItemRaw,I,w,_);else if(S.setItem)await mr(S.setItem,I,G3(w),_);else return;S.watch||s("update",l)},async removeItem(l,w={}){typeof w=="boolean"&&(w={removeMeta:w}),l=Kr(l);const{relativeKey:_,driver:I}=e(l);I.removeItem&&(await mr(I.removeItem,_,w),(w.removeMeta||w.removeMata)&&await mr(I.removeItem,_+"$",w),I.watch||s("remove",l))},async getMeta(l,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),l=Kr(l);const{relativeKey:_,driver:I}=e(l),S=Object.create(null);if(I.getMeta&&Object.assign(S,await mr(I.getMeta,_,w)),!w.nativeOnly){const M=await mr(I.getItem,_+"$",w).then(G=>kc(G));M&&typeof M=="object"&&(typeof M.atime=="string"&&(M.atime=new Date(M.atime)),typeof M.mtime=="string"&&(M.mtime=new Date(M.mtime)),Object.assign(S,M))}return S},setMeta(l,w,_={}){return this.setItem(l+"$",w,_)},removeMeta(l,w={}){return this.removeItem(l+"$",w)},async getKeys(l,w={}){l=zc(l);const _=i(l,!0);let I=[];const S=[];for(const M of _){const G=await mr(M.driver.getKeys,M.relativeBase,w);for(const V of G){const Z=M.mountpoint+Kr(V);I.some(H=>Z.startsWith(H))||S.push(Z)}I=[M.mountpoint,...I.filter(V=>!V.startsWith(M.mountpoint))]}return l?S.filter(M=>M.startsWith(l)&&M[M.length-1]!=="$"):S.filter(M=>M[M.length-1]!=="$")},async clear(l,w={}){l=zc(l),await Promise.all(i(l,!1).map(async _=>{if(_.driver.clear)return mr(_.driver.clear,_.relativeBase,w);if(_.driver.removeItem){const I=await _.driver.getKeys(_.relativeBase||"",w);return Promise.all(I.map(S=>_.driver.removeItem(S,w)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(l=>Rp(l)))},async watch(l){return await a(),t.watchListeners.push(l),async()=>{t.watchListeners=t.watchListeners.filter(w=>w!==l),t.watchListeners.length===0&&await u()}},async unwatch(){t.watchListeners=[],await u()},mount(l,w){if(l=zc(l),l&&t.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(t.mountpoints.push(l),t.mountpoints.sort((_,I)=>I.length-_.length)),t.mounts[l]=w,t.watching&&Promise.resolve(Tp(w,s,l)).then(_=>{t.unwatch[l]=_}).catch(console.error),d},async unmount(l,w=!0){l=zc(l),!(!l||!t.mounts[l])&&(t.watching&&l in t.unwatch&&(t.unwatch[l](),delete t.unwatch[l]),w&&await Rp(t.mounts[l]),t.mountpoints=t.mountpoints.filter(_=>_!==l),delete t.mounts[l])},getMount(l=""){l=Kr(l)+":";const w=e(l);return{driver:w.driver,base:w.base}},getMounts(l="",w={}){return l=Kr(l),i(l,w.parents).map(I=>({driver:I.driver,base:I.mountpoint}))},keys:(l,w={})=>d.getKeys(l,w),get:(l,w={})=>d.getItem(l,w),set:(l,w,_={})=>d.setItem(l,w,_),has:(l,w={})=>d.hasItem(l,w),del:(l,w={})=>d.removeItem(l,w),remove:(l,w={})=>d.removeItem(l,w)};return d}function Tp(r,t,e){return r.watch?r.watch((i,s)=>t(i,e+s)):()=>{}}async function Rp(r){typeof r.dispose=="function"&&await mr(r.dispose)}function js(r){return new Promise((t,e)=>{r.oncomplete=r.onsuccess=()=>t(r.result),r.onabort=r.onerror=()=>e(r.error)})}function e1(r,t){const e=indexedDB.open(r);e.onupgradeneeded=()=>e.result.createObjectStore(t);const i=js(e);return(s,a)=>i.then(u=>a(u.transaction(t,s).objectStore(t)))}let Jh;function Ma(){return Jh||(Jh=e1("keyval-store","keyval")),Jh}function Fp(r,t=Ma()){return t("readonly",e=>js(e.get(r)))}function Z3(r,t,e=Ma()){return e("readwrite",i=>(i.put(t,r),js(i.transaction)))}function t6(r,t=Ma()){return t("readwrite",e=>(e.delete(r),js(e.transaction)))}function e6(r=Ma()){return r("readwrite",t=>(t.clear(),js(t.transaction)))}function r6(r,t){return r.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},js(r.transaction)}function i6(r=Ma()){return r("readonly",t=>{if(t.getAllKeys)return js(t.getAllKeys());const e=[];return r6(t,i=>e.push(i.key)).then(()=>e)})}const n6=r=>JSON.stringify(r,(t,e)=>typeof e=="bigint"?e.toString()+"n":e),s6=r=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,e=r.replace(t,'$1"$2n"$3');return JSON.parse(e,(i,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Ls(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return s6(r)}catch{return r}}function qn(r){return typeof r=="string"?r:n6(r)||""}const o6="idb-keyval";var a6=(r={})=>{const t=r.base&&r.base.length>0?`${r.base}:`:"",e=s=>t+s;let i;return r.dbName&&r.storeName&&(i=e1(r.dbName,r.storeName)),{name:o6,options:r,async hasItem(s){return!(typeof await Fp(e(s),i)>"u")},async getItem(s){return await Fp(e(s),i)??null},setItem(s,a){return Z3(e(s),a,i)},removeItem(s){return t6(e(s),i)},getKeys(){return i6(i)},clear(){return e6(i)}}};const c6="WALLET_CONNECT_V2_INDEXED_DB",u6="keyvaluestorage";let h6=class{constructor(){this.indexedDb=X3({driver:a6({dbName:c6,storeName:u6})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const e=await this.indexedDb.getItem(t);if(e!==null)return e}async setItem(t,e){await this.indexedDb.setItem(t,qn(e))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Qh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof oe<"u"?oe:typeof self<"u"?self:{},eu={exports:{}};(function(){let r;function t(){}r=t,r.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},r.prototype.setItem=function(e,i){this[e]=String(i)},r.prototype.removeItem=function(e){delete this[e]},r.prototype.clear=function(){const e=this;Object.keys(e).forEach(function(i){e[i]=void 0,delete e[i]})},r.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Qh<"u"&&Qh.localStorage?eu.exports=Qh.localStorage:typeof window<"u"&&window.localStorage?eu.exports=window.localStorage:eu.exports=new t})();function l6(r){var t;return[r[0],Ls((t=r[1])!=null?t:"")]}let f6=class{constructor(){this.localStorage=eu.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(l6)}async getItem(t){const e=this.localStorage.getItem(t);if(e!==null)return Ls(e)}async setItem(t,e){this.localStorage.setItem(t,qn(e))}async removeItem(t){this.localStorage.removeItem(t)}};const d6="wc_storage_version",Up=1,p6=async(r,t,e)=>{const i=d6,s=await t.getItem(i);if(s&&s>=Up){e(t);return}const a=await r.getKeys();if(!a.length){e(t);return}const u=[];for(;a.length;){const h=a.shift();if(!h)continue;const d=h.toLowerCase();if(d.includes("wc@")||d.includes("walletconnect")||d.includes("wc_")||d.includes("wallet_connect")){const l=await r.getItem(h);await t.setItem(h,l),u.push(h)}}await t.setItem(i,Up),e(t),g6(r,u)},g6=async(r,t)=>{t.length&&t.forEach(async e=>{await r.removeItem(e)})};let m6=class{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const t=new f6;this.storage=t;try{const e=new h6;p6(t,e,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,e){return await this.initialize(),this.storage.setItem(t,e)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const e=setInterval(()=>{this.initialized&&(clearInterval(e),t())},20)})}};var mt={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ol=function(r,t){return Ol=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])},Ol(r,t)};function v6(r,t){Ol(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Nl=function(){return Nl=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++){e=arguments[i];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Nl.apply(this,arguments)};function y6(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(r);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(r,i[s])&&(e[i[s]]=r[i[s]]);return e}function w6(r,t,e,i){var s=arguments.length,a=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,i);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a}function b6(r,t){return function(e,i){t(e,i,r)}}function _6(r,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,t)}function E6(r,t,e,i){function s(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function h(w){try{l(i.next(w))}catch(_){u(_)}}function d(w){try{l(i.throw(w))}catch(_){u(_)}}function l(w){w.done?a(w.value):s(w.value).then(h,d)}l((i=i.apply(r,t||[])).next())})}function A6(r,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,s,a,u;return u={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(l){return function(w){return d([l,w])}}function d(l){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,s&&(a=l[0]&2?s.return:l[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,l[1])).done)return a;switch(s=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,s=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=t.call(r,e)}catch(w){l=[6,w],s=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function S6(r,t,e,i){i===void 0&&(i=e),r[i]=t[e]}function I6(r,t){for(var e in r)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=r[e])}function Tl(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],i=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function r1(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var i=e.call(r),s,a=[],u;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(h){u={error:h}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(u)throw u.error}}return a}function D6(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(r1(arguments[t]));return r}function x6(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var i=Array(r),s=0,t=0;t<e;t++)for(var a=arguments[t],u=0,h=a.length;u<h;u++,s++)i[s]=a[u];return i}function wa(r){return this instanceof wa?(this.v=r,this):new wa(r)}function M6(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(r,t||[]),s,a=[];return s={},u("next"),u("throw"),u("return"),s[Symbol.asyncIterator]=function(){return this},s;function u(I){i[I]&&(s[I]=function(S){return new Promise(function(M,G){a.push([I,S,M,G])>1||h(I,S)})})}function h(I,S){try{d(i[I](S))}catch(M){_(a[0][3],M)}}function d(I){I.value instanceof wa?Promise.resolve(I.value.v).then(l,w):_(a[0][2],I)}function l(I){h("next",I)}function w(I){h("throw",I)}function _(I,S){I(S),a.shift(),a.length&&h(a[0][0],a[0][1])}}function P6(r){var t,e;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,a){t[s]=r[s]?function(u){return(e=!e)?{value:wa(r[s](u)),done:s==="return"}:a?a(u):u}:a}}function C6(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r[Symbol.asyncIterator],e;return t?t.call(r):(r=typeof Tl=="function"?Tl(r):r[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(a){e[a]=r[a]&&function(u){return new Promise(function(h,d){u=r[a](u),s(h,d,u.done,u.value)})}}function s(a,u,h,d){Promise.resolve(d).then(function(l){a({value:l,done:h})},u)}}function O6(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r}function N6(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)Object.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}function T6(r){return r&&r.__esModule?r:{default:r}}function R6(r,t){if(!t.has(r))throw new TypeError("attempted to get private field on non-instance");return t.get(r)}function F6(r,t,e){if(!t.has(r))throw new TypeError("attempted to set private field on non-instance");return t.set(r,e),e}const U6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nl},__asyncDelegator:P6,__asyncGenerator:M6,__asyncValues:C6,__await:wa,__awaiter:E6,__classPrivateFieldGet:R6,__classPrivateFieldSet:F6,__createBinding:S6,__decorate:w6,__exportStar:I6,__extends:v6,__generator:A6,__importDefault:T6,__importStar:N6,__makeTemplateObject:O6,__metadata:_6,__param:b6,__read:r1,__rest:y6,__spread:D6,__spreadArrays:x6,__values:Tl},Symbol.toStringTag,{value:"Module"})),Iu=Xg(U6);var Xh={},Xo={},Lp;function L6(){if(Lp)return Xo;Lp=1,Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.delay=void 0;function r(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}return Xo.delay=r,Xo}var Ms={},Zh={},Ps={},Bp;function B6(){return Bp||(Bp=1,Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.ONE_THOUSAND=Ps.ONE_HUNDRED=void 0,Ps.ONE_HUNDRED=100,Ps.ONE_THOUSAND=1e3),Ps}var tl={},qp;function q6(){return qp||(qp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(tl)),tl}var jp;function i1(){return jp||(jp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const t=Iu;t.__exportStar(B6(),r),t.__exportStar(q6(),r)}(Zh)),Zh}var $p;function j6(){if($p)return Ms;$p=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.fromMiliseconds=Ms.toMiliseconds=void 0;const r=i1();function t(i){return i*r.ONE_THOUSAND}Ms.toMiliseconds=t;function e(i){return Math.floor(i/r.ONE_THOUSAND)}return Ms.fromMiliseconds=e,Ms}var kp;function $6(){return kp||(kp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const t=Iu;t.__exportStar(L6(),r),t.__exportStar(j6(),r)}(Xh)),Xh}var ho={},zp;function k6(){if(zp)return ho;zp=1,Object.defineProperty(ho,"__esModule",{value:!0}),ho.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const i=this.get(e);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${e}`);const s=Date.now()-i.started;this.timestamps.set(e,{started:i.started,elapsed:s})}get(e){const i=this.timestamps.get(e);if(typeof i>"u")throw new Error(`No timestamp found for label: ${e}`);return i}elapsed(e){const i=this.get(e);return i.elapsed||Date.now()-i.started}}return ho.Watch=r,ho.default=r,ho}var el={},Zo={},Hp;function z6(){if(Hp)return Zo;Hp=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.IWatch=void 0;class r{}return Zo.IWatch=r,Zo}var Kp;function H6(){return Kp||(Kp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Iu.__exportStar(z6(),r)}(el)),el}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const t=Iu;t.__exportStar($6(),r),t.__exportStar(k6(),r),t.__exportStar(H6(),r),t.__exportStar(i1(),r)})(mt);class $s{}function K6(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var V6=G6;function G6(r,t,e){var i=e&&e.stringify||K6,s=1;if(typeof r=="object"&&r!==null){var a=t.length+s;if(a===1)return r;var u=new Array(a);u[0]=i(r);for(var h=1;h<a;h++)u[h]=i(t[h]);return u.join(" ")}if(typeof r!="string")return r;var d=t.length;if(d===0)return r;for(var l="",w=1-s,_=-1,I=r&&r.length||0,S=0;S<I;){if(r.charCodeAt(S)===37&&S+1<I){switch(_=_>-1?_:0,r.charCodeAt(S+1)){case 100:case 102:if(w>=d||t[w]==null)break;_<S&&(l+=r.slice(_,S)),l+=Number(t[w]),_=S+2,S++;break;case 105:if(w>=d||t[w]==null)break;_<S&&(l+=r.slice(_,S)),l+=Math.floor(Number(t[w])),_=S+2,S++;break;case 79:case 111:case 106:if(w>=d||t[w]===void 0)break;_<S&&(l+=r.slice(_,S));var M=typeof t[w];if(M==="string"){l+="'"+t[w]+"'",_=S+2,S++;break}if(M==="function"){l+=t[w].name||"<anonymous>",_=S+2,S++;break}l+=i(t[w]),_=S+2,S++;break;case 115:if(w>=d)break;_<S&&(l+=r.slice(_,S)),l+=String(t[w]),_=S+2,S++;break;case 37:_<S&&(l+=r.slice(_,S)),l+="%",_=S+2,S++,w--;break}++w}++S}return _===-1?r:(_<I&&(l+=r.slice(_)),l)}const Vp=V6;var go=ln;const ba=iE().console||{},W6={mapHttpRequest:Hc,mapHttpResponse:Hc,wrapRequestSerializer:rl,wrapResponseSerializer:rl,wrapErrorSerializer:rl,req:Hc,res:Hc,err:Z6};function Y6(r,t){return Array.isArray(r)?r.filter(function(i){return i!=="!stdSerializers.err"}):r===!0?Object.keys(t):!1}function ln(r){r=r||{},r.browser=r.browser||{};const t=r.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const e=r.browser.write||ba;r.browser.write&&(r.browser.asObject=!0);const i=r.serializers||{},s=Y6(r.browser.serialize,i);let a=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);const u=["error","fatal","warn","info","debug","trace"];typeof e=="function"&&(e.error=e.fatal=e.warn=e.info=e.debug=e.trace=e),r.enabled===!1&&(r.level="silent");const h=r.level||"info",d=Object.create(e);d.log||(d.log=_a),Object.defineProperty(d,"levelVal",{get:w}),Object.defineProperty(d,"level",{get:_,set:I});const l={transmit:t,serialize:s,asObject:r.browser.asObject,levels:u,timestamp:tE(r)};d.levels=ln.levels,d.level=h,d.setMaxListeners=d.getMaxListeners=d.emit=d.addListener=d.on=d.prependListener=d.once=d.prependOnceListener=d.removeListener=d.removeAllListeners=d.listeners=d.listenerCount=d.eventNames=d.write=d.flush=_a,d.serializers=i,d._serialize=s,d._stdErrSerialize=a,d.child=S,t&&(d._logEvent=Rl());function w(){return this.level==="silent"?1/0:this.levels.values[this.level]}function _(){return this._level}function I(M){if(M!=="silent"&&!this.levels.values[M])throw Error("unknown level "+M);this._level=M,lo(l,d,"error","log"),lo(l,d,"fatal","error"),lo(l,d,"warn","error"),lo(l,d,"info","log"),lo(l,d,"debug","log"),lo(l,d,"trace","log")}function S(M,G){if(!M)throw new Error("missing bindings for child Pino");G=G||{},s&&M.serializers&&(G.serializers=M.serializers);const V=G.serializers;if(s&&V){var Z=Object.assign({},i,V),H=r.browser.serialize===!0?Object.keys(Z):s;delete M.serializers,Du([M],H,Z,this._stdErrSerialize)}function W(U){this._childLevel=(U._childLevel|0)+1,this.error=fo(U,M,"error"),this.fatal=fo(U,M,"fatal"),this.warn=fo(U,M,"warn"),this.info=fo(U,M,"info"),this.debug=fo(U,M,"debug"),this.trace=fo(U,M,"trace"),Z&&(this.serializers=Z,this._serialize=H),t&&(this._logEvent=Rl([].concat(U._logEvent.bindings,M)))}return W.prototype=this,new W(this)}return d}ln.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ln.stdSerializers=W6;ln.stdTimeFunctions=Object.assign({},{nullTime:n1,epochTime:s1,unixTime:eE,isoTime:rE});function lo(r,t,e,i){const s=Object.getPrototypeOf(t);t[e]=t.levelVal>t.levels.values[e]?_a:s[e]?s[e]:ba[e]||ba[i]||_a,J6(r,t,e)}function J6(r,t,e){!r.transmit&&t[e]===_a||(t[e]=function(i){return function(){const a=r.timestamp(),u=new Array(arguments.length),h=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ba?ba:this;for(var d=0;d<u.length;d++)u[d]=arguments[d];if(r.serialize&&!r.asObject&&Du(u,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?i.call(h,Q6(this,e,u,a)):i.apply(h,u),r.transmit){const l=r.transmit.level||t.level,w=ln.levels.values[l],_=ln.levels.values[e];if(_<w)return;X6(this,{ts:a,methodLevel:e,methodValue:_,transmitLevel:l,transmitValue:ln.levels.values[r.transmit.level||t.level],send:r.transmit.send,val:t.levelVal},u)}}}(t[e]))}function Q6(r,t,e,i){r._serialize&&Du(e,r._serialize,r.serializers,r._stdErrSerialize);const s=e.slice();let a=s[0];const u={};i&&(u.time=i),u.level=ln.levels.values[t];let h=(r._childLevel|0)+1;if(h<1&&(h=1),a!==null&&typeof a=="object"){for(;h--&&typeof s[0]=="object";)Object.assign(u,s.shift());a=s.length?Vp(s.shift(),s):void 0}else typeof a=="string"&&(a=Vp(s.shift(),s));return a!==void 0&&(u.msg=a),u}function Du(r,t,e,i){for(const s in r)if(i&&r[s]instanceof Error)r[s]=ln.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s]))for(const a in r[s])t&&t.indexOf(a)>-1&&a in e&&(r[s][a]=e[a](r[s][a]))}function fo(r,t,e){return function(){const i=new Array(1+arguments.length);i[0]=t;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return r[e].apply(this,i)}}function X6(r,t,e){const i=t.send,s=t.ts,a=t.methodLevel,u=t.methodValue,h=t.val,d=r._logEvent.bindings;Du(e,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=s,r._logEvent.messages=e.filter(function(l){return d.indexOf(l)===-1}),r._logEvent.level.label=a,r._logEvent.level.value=u,i(a,r._logEvent,h),r._logEvent=Rl(d)}function Rl(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function Z6(r){const t={type:r.constructor.name,msg:r.message,stack:r.stack};for(const e in r)t[e]===void 0&&(t[e]=r[e]);return t}function tE(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?n1:s1}function Hc(){return{}}function rl(r){return r}function _a(){}function n1(){return!1}function s1(){return Date.now()}function eE(){return Math.round(Date.now()/1e3)}function rE(){return new Date(Date.now()).toISOString()}function iE(){function r(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const Pa=Zg(go),nE={level:"info"},Ca="custom_context",af=1e3*1024;let sE=class{constructor(t){this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Gp=class{constructor(t){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const e=new sE(t);if(e.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${e.size}`);for(;this.size+e.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=e),this.tail=e):(this.head=e,this.tail=e),this.lengthInNodes++,this.sizeInBytes+=e.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let e=this.head;for(;e!==null;)t.push(e.value),e=e.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const e=t.value;return t=t.next,{done:!1,value:e}}}}},o1=class{constructor(t,e=af){this.level=t??"error",this.levelValue=go.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=e,this.logs=new Gp(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,e){e===go.levels.values.error?console.error(t):e===go.levels.values.warn?console.warn(t):e===go.levels.values.debug?console.debug(t):e===go.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(qn({timestamp:new Date().toISOString(),log:t}));const e=typeof t=="string"?JSON.parse(t).level:t.level;e>=this.levelValue&&this.forwardToConsole(t,e)}getLogs(){return this.logs}clearLogs(){this.logs=new Gp(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const e=this.getLogArray();return e.push(qn({extraMetadata:t})),new Blob(e,{type:"application/json"})}},oE=class{constructor(t,e=af){this.baseChunkLogger=new o1(t,e)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const e=URL.createObjectURL(this.logsToBlob(t)),i=document.createElement("a");i.href=e,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(e)}};class aE{constructor(t,e=af){this.baseChunkLogger=new o1(t,e)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}}var cE=Object.defineProperty,uE=Object.defineProperties,hE=Object.getOwnPropertyDescriptors,Wp=Object.getOwnPropertySymbols,lE=Object.prototype.hasOwnProperty,fE=Object.prototype.propertyIsEnumerable,Yp=(r,t,e)=>t in r?cE(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,hu=(r,t)=>{for(var e in t||(t={}))lE.call(t,e)&&Yp(r,e,t[e]);if(Wp)for(var e of Wp(t))fE.call(t,e)&&Yp(r,e,t[e]);return r},lu=(r,t)=>uE(r,hE(t));function xu(r){return lu(hu({},r),{level:(r==null?void 0:r.level)||nE.level})}function dE(r,t=Ca){return r[t]||""}function pE(r,t,e=Ca){return r[e]=t,r}function Jr(r,t=Ca){let e="";return typeof r.bindings>"u"?e=dE(r,t):e=r.bindings().context||"",e}function gE(r,t,e=Ca){const i=Jr(r,e);return i.trim()?`${i}/${t}`:t}function Br(r,t,e=Ca){const i=gE(r,t,e),s=r.child({context:i});return pE(s,i,e)}function mE(r){var t,e;const i=new oE((t=r.opts)==null?void 0:t.level,r.maxSizeInBytes);return{logger:Pa(lu(hu({},r.opts),{level:"trace",browser:lu(hu({},(e=r.opts)==null?void 0:e.browser),{write:s=>i.write(s)})})),chunkLoggerController:i}}function vE(r){var t;const e=new aE((t=r.opts)==null?void 0:t.level,r.maxSizeInBytes);return{logger:Pa(lu(hu({},r.opts),{level:"trace"}),e),chunkLoggerController:e}}function yE(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?mE(r):vE(r)}var cf={},os={},Mu={},Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});Pu.BrowserRandomSource=void 0;const Jp=65536;class wE{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const e=new Uint8Array(t);for(let i=0;i<e.length;i+=Jp)this._crypto.getRandomValues(e.subarray(i,i+Math.min(e.length-i,Jp)));return e}}Pu.BrowserRandomSource=wE;function bE(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Cu={},oi={};Object.defineProperty(oi,"__esModule",{value:!0});function _E(r){for(var t=0;t<r.length;t++)r[t]=0;return r}oi.wipe=_E;Object.defineProperty(Cu,"__esModule",{value:!0});Cu.NodeRandomSource=void 0;const EE=oi;class AE{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof bE<"u"){const t=F3();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let e=this._crypto.randomBytes(t);if(e.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(t);for(let s=0;s<i.length;s++)i[s]=e[s];return(0,EE.wipe)(e),i}}Cu.NodeRandomSource=AE;Object.defineProperty(Mu,"__esModule",{value:!0});Mu.SystemRandomSource=void 0;const SE=Pu,IE=Cu;class DE{constructor(){if(this.isAvailable=!1,this.name="",this._source=new SE.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new IE.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Mu.SystemRandomSource=DE;var ae={},a1={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function t(h,d){var l=h>>>16&65535,w=h&65535,_=d>>>16&65535,I=d&65535;return w*I+(l*I+w*_<<16>>>0)|0}r.mul=Math.imul||t;function e(h,d){return h+d|0}r.add=e;function i(h,d){return h-d|0}r.sub=i;function s(h,d){return h<<d|h>>>32-d}r.rotl=s;function a(h,d){return h<<32-d|h>>>d}r.rotr=a;function u(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h}r.isInteger=Number.isInteger||u,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(h){return r.isInteger(h)&&h>=-r.MAX_SAFE_INTEGER&&h<=r.MAX_SAFE_INTEGER}})(a1);Object.defineProperty(ae,"__esModule",{value:!0});var c1=a1;function xE(r,t){return t===void 0&&(t=0),(r[t+0]<<8|r[t+1])<<16>>16}ae.readInt16BE=xE;function ME(r,t){return t===void 0&&(t=0),(r[t+0]<<8|r[t+1])>>>0}ae.readUint16BE=ME;function PE(r,t){return t===void 0&&(t=0),(r[t+1]<<8|r[t])<<16>>16}ae.readInt16LE=PE;function CE(r,t){return t===void 0&&(t=0),(r[t+1]<<8|r[t])>>>0}ae.readUint16LE=CE;function u1(r,t,e){return t===void 0&&(t=new Uint8Array(2)),e===void 0&&(e=0),t[e+0]=r>>>8,t[e+1]=r>>>0,t}ae.writeUint16BE=u1;ae.writeInt16BE=u1;function h1(r,t,e){return t===void 0&&(t=new Uint8Array(2)),e===void 0&&(e=0),t[e+0]=r>>>0,t[e+1]=r>>>8,t}ae.writeUint16LE=h1;ae.writeInt16LE=h1;function Fl(r,t){return t===void 0&&(t=0),r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]}ae.readInt32BE=Fl;function Ul(r,t){return t===void 0&&(t=0),(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])>>>0}ae.readUint32BE=Ul;function Ll(r,t){return t===void 0&&(t=0),r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]}ae.readInt32LE=Ll;function Bl(r,t){return t===void 0&&(t=0),(r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t])>>>0}ae.readUint32LE=Bl;function fu(r,t,e){return t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0),t[e+0]=r>>>24,t[e+1]=r>>>16,t[e+2]=r>>>8,t[e+3]=r>>>0,t}ae.writeUint32BE=fu;ae.writeInt32BE=fu;function du(r,t,e){return t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0),t[e+0]=r>>>0,t[e+1]=r>>>8,t[e+2]=r>>>16,t[e+3]=r>>>24,t}ae.writeUint32LE=du;ae.writeInt32LE=du;function OE(r,t){t===void 0&&(t=0);var e=Fl(r,t),i=Fl(r,t+4);return e*4294967296+i-(i>>31)*4294967296}ae.readInt64BE=OE;function NE(r,t){t===void 0&&(t=0);var e=Ul(r,t),i=Ul(r,t+4);return e*4294967296+i}ae.readUint64BE=NE;function TE(r,t){t===void 0&&(t=0);var e=Ll(r,t),i=Ll(r,t+4);return i*4294967296+e-(e>>31)*4294967296}ae.readInt64LE=TE;function RE(r,t){t===void 0&&(t=0);var e=Bl(r,t),i=Bl(r,t+4);return i*4294967296+e}ae.readUint64LE=RE;function l1(r,t,e){return t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0),fu(r/4294967296>>>0,t,e),fu(r>>>0,t,e+4),t}ae.writeUint64BE=l1;ae.writeInt64BE=l1;function f1(r,t,e){return t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0),du(r>>>0,t,e),du(r/4294967296>>>0,t,e+4),t}ae.writeUint64LE=f1;ae.writeInt64LE=f1;function FE(r,t,e){if(e===void 0&&(e=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>t.length-e)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,s=1,a=r/8+e-1;a>=e;a--)i+=t[a]*s,s*=256;return i}ae.readUintBE=FE;function UE(r,t,e){if(e===void 0&&(e=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>t.length-e)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,s=1,a=e;a<e+r/8;a++)i+=t[a]*s,s*=256;return i}ae.readUintLE=UE;function LE(r,t,e,i){if(e===void 0&&(e=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!c1.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var s=1,a=r/8+i-1;a>=i;a--)e[a]=t/s&255,s*=256;return e}ae.writeUintBE=LE;function BE(r,t,e,i){if(e===void 0&&(e=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!c1.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var s=1,a=i;a<i+r/8;a++)e[a]=t/s&255,s*=256;return e}ae.writeUintLE=BE;function qE(r,t){t===void 0&&(t=0);var e=new DataView(r.buffer,r.byteOffset,r.byteLength);return e.getFloat32(t)}ae.readFloat32BE=qE;function jE(r,t){t===void 0&&(t=0);var e=new DataView(r.buffer,r.byteOffset,r.byteLength);return e.getFloat32(t,!0)}ae.readFloat32LE=jE;function $E(r,t){t===void 0&&(t=0);var e=new DataView(r.buffer,r.byteOffset,r.byteLength);return e.getFloat64(t)}ae.readFloat64BE=$E;function kE(r,t){t===void 0&&(t=0);var e=new DataView(r.buffer,r.byteOffset,r.byteLength);return e.getFloat64(t,!0)}ae.readFloat64LE=kE;function zE(r,t,e){t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat32(e,r),t}ae.writeFloat32BE=zE;function HE(r,t,e){t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat32(e,r,!0),t}ae.writeFloat32LE=HE;function KE(r,t,e){t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat64(e,r),t}ae.writeFloat64BE=KE;function VE(r,t,e){t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat64(e,r,!0),t}ae.writeFloat64LE=VE;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const t=Mu,e=ae,i=oi;r.defaultRandomSource=new t.SystemRandomSource;function s(l,w=r.defaultRandomSource){return w.randomBytes(l)}r.randomBytes=s;function a(l=r.defaultRandomSource){const w=s(4,l),_=(0,e.readUint32LE)(w);return(0,i.wipe)(w),_}r.randomUint32=a;const u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function h(l,w=u,_=r.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let I="";const S=w.length,M=256-256%S;for(;l>0;){const G=s(Math.ceil(l*256/M),_);for(let V=0;V<G.length&&l>0;V++){const Z=G[V];Z<M&&(I+=w.charAt(Z%S),l--)}(0,i.wipe)(G)}return I}r.randomString=h;function d(l,w=u,_=r.defaultRandomSource){const I=Math.ceil(l/(Math.log(w.length)/Math.LN2));return h(I,w,_)}r.randomStringForEntropy=d})(os);var d1={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=ae,e=oi;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function h(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return h.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},h.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},h.prototype.clean=function(){e.wipe(this._buffer),e.wipe(this._tempHi),e.wipe(this._tempLo),this.reset()},h.prototype.update=function(d,l){if(l===void 0&&(l=d.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=d[w++],l--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(w=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,d,w,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=d[w++],l--;return this},h.prototype.finish=function(d){if(!this._finished){var l=this._bytesHashed,w=this._bufferLength,_=l/536870912|0,I=l<<3,S=l%128<112?128:256;this._buffer[w]=128;for(var M=w+1;M<S-8;M++)this._buffer[M]=0;t.writeUint32BE(_,this._buffer,S-8),t.writeUint32BE(I,this._buffer,S-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,S),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)t.writeUint32BE(this._stateHi[M],d,M*8),t.writeUint32BE(this._stateLo[M],d,M*8+4);return this},h.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},h.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},h.prototype.restoreState=function(d){return this._stateHi.set(d.stateHi),this._stateLo.set(d.stateLo),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},h.prototype.cleanSavedState=function(d){e.wipe(d.stateHi),e.wipe(d.stateLo),d.buffer&&e.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},h}();r.SHA512=i;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(h,d,l,w,_,I,S){for(var M=l[0],G=l[1],V=l[2],Z=l[3],H=l[4],W=l[5],U=l[6],$=l[7],k=w[0],v=w[1],R=w[2],st=w[3],dt=w[4],pt=w[5],yt=w[6],f=w[7],y,b,P,C,O,B,D,g;S>=128;){for(var T=0;T<16;T++){var rt=8*T+I;h[T]=t.readUint32BE(_,rt),d[T]=t.readUint32BE(_,rt+4)}for(var T=0;T<80;T++){var lt=M,E=G,tt=V,L=Z,q=H,z=W,p=U,F=$,et=k,ot=v,at=R,Mt=st,Ct=dt,It=pt,Ae=yt,$t=f;if(y=$,b=f,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=(H>>>14|dt<<18)^(H>>>18|dt<<14)^(dt>>>9|H<<23),b=(dt>>>14|H<<18)^(dt>>>18|H<<14)^(H>>>9|dt<<23),O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,y=H&W^~H&U,b=dt&pt^~dt&yt,O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,y=s[T*2],b=s[T*2+1],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,y=h[T%16],b=d[T%16],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,P=D&65535|g<<16,C=O&65535|B<<16,y=P,b=C,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=(M>>>28|k<<4)^(k>>>2|M<<30)^(k>>>7|M<<25),b=(k>>>28|M<<4)^(M>>>2|k<<30)^(M>>>7|k<<25),O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,y=M&G^M&V^G&V,b=k&v^k&R^v&R,O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,F=D&65535|g<<16,$t=O&65535|B<<16,y=L,b=Mt,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=P,b=C,O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,L=D&65535|g<<16,Mt=O&65535|B<<16,G=lt,V=E,Z=tt,H=L,W=q,U=z,$=p,M=F,v=et,R=ot,st=at,dt=Mt,pt=Ct,yt=It,f=Ae,k=$t,T%16===15)for(var rt=0;rt<16;rt++)y=h[rt],b=d[rt],O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=h[(rt+9)%16],b=d[(rt+9)%16],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,P=h[(rt+1)%16],C=d[(rt+1)%16],y=(P>>>1|C<<31)^(P>>>8|C<<24)^P>>>7,b=(C>>>1|P<<31)^(C>>>8|P<<24)^(C>>>7|P<<25),O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,P=h[(rt+14)%16],C=d[(rt+14)%16],y=(P>>>19|C<<13)^(C>>>29|P<<3)^P>>>6,b=(C>>>19|P<<13)^(P>>>29|C<<3)^(C>>>6|P<<26),O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,h[rt]=D&65535|g<<16,d[rt]=O&65535|B<<16}y=M,b=k,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[0],b=w[0],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[0]=M=D&65535|g<<16,w[0]=k=O&65535|B<<16,y=G,b=v,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[1],b=w[1],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[1]=G=D&65535|g<<16,w[1]=v=O&65535|B<<16,y=V,b=R,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[2],b=w[2],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[2]=V=D&65535|g<<16,w[2]=R=O&65535|B<<16,y=Z,b=st,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[3],b=w[3],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[3]=Z=D&65535|g<<16,w[3]=st=O&65535|B<<16,y=H,b=dt,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[4],b=w[4],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[4]=H=D&65535|g<<16,w[4]=dt=O&65535|B<<16,y=W,b=pt,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[5],b=w[5],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[5]=W=D&65535|g<<16,w[5]=pt=O&65535|B<<16,y=U,b=yt,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[6],b=w[6],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[6]=U=D&65535|g<<16,w[6]=yt=O&65535|B<<16,y=$,b=f,O=b&65535,B=b>>>16,D=y&65535,g=y>>>16,y=l[7],b=w[7],O+=b&65535,B+=b>>>16,D+=y&65535,g+=y>>>16,B+=O>>>16,D+=B>>>16,g+=D>>>16,l[7]=$=D&65535|g<<16,w[7]=f=O&65535|B<<16,I+=128,S-=128}return I}function u(h){var d=new i;d.update(h);var l=d.digest();return d.clean(),l}r.hash=u})(d1);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const t=os,e=d1,i=oi;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function s(L){const q=new Float64Array(16);if(L)for(let z=0;z<L.length;z++)q[z]=L[z];return q}const a=new Uint8Array(32);a[0]=9;const u=s(),h=s([1]),d=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function S(L,q){for(let z=0;z<16;z++)L[z]=q[z]|0}function M(L){let q=1;for(let z=0;z<16;z++){let p=L[z]+q+65535;q=Math.floor(p/65536),L[z]=p-q*65536}L[0]+=q-1+37*(q-1)}function G(L,q,z){const p=~(z-1);for(let F=0;F<16;F++){const et=p&(L[F]^q[F]);L[F]^=et,q[F]^=et}}function V(L,q){const z=s(),p=s();for(let F=0;F<16;F++)p[F]=q[F];M(p),M(p),M(p);for(let F=0;F<2;F++){z[0]=p[0]-65517;for(let ot=1;ot<15;ot++)z[ot]=p[ot]-65535-(z[ot-1]>>16&1),z[ot-1]&=65535;z[15]=p[15]-32767-(z[14]>>16&1);const et=z[15]>>16&1;z[14]&=65535,G(p,z,1-et)}for(let F=0;F<16;F++)L[2*F]=p[F]&255,L[2*F+1]=p[F]>>8}function Z(L,q){let z=0;for(let p=0;p<32;p++)z|=L[p]^q[p];return(1&z-1>>>8)-1}function H(L,q){const z=new Uint8Array(32),p=new Uint8Array(32);return V(z,L),V(p,q),Z(z,p)}function W(L){const q=new Uint8Array(32);return V(q,L),q[0]&1}function U(L,q){for(let z=0;z<16;z++)L[z]=q[2*z]+(q[2*z+1]<<8);L[15]&=32767}function $(L,q,z){for(let p=0;p<16;p++)L[p]=q[p]+z[p]}function k(L,q,z){for(let p=0;p<16;p++)L[p]=q[p]-z[p]}function v(L,q,z){let p,F,et=0,ot=0,at=0,Mt=0,Ct=0,It=0,Ae=0,$t=0,xt=0,Lt=0,_t=0,Et=0,Vt=0,wt=0,At=0,Ut=0,bt=0,Pt=0,Bt=0,Ot=0,Nt=0,se=0,Rt=0,Tt=0,We=0,ue=0,ge=0,Ye=0,we=0,Ee=0,Mr=0,Gt=z[0],kt=z[1],De=z[2],Wt=z[3],Kt=z[4],Se=z[5],Qt=z[6],Xt=z[7],xe=z[8],Zt=z[9],Yt=z[10],Ce=z[11],Jt=z[12],qt=z[13],Fe=z[14],te=z[15];p=q[0],et+=p*Gt,ot+=p*kt,at+=p*De,Mt+=p*Wt,Ct+=p*Kt,It+=p*Se,Ae+=p*Qt,$t+=p*Xt,xt+=p*xe,Lt+=p*Zt,_t+=p*Yt,Et+=p*Ce,Vt+=p*Jt,wt+=p*qt,At+=p*Fe,Ut+=p*te,p=q[1],ot+=p*Gt,at+=p*kt,Mt+=p*De,Ct+=p*Wt,It+=p*Kt,Ae+=p*Se,$t+=p*Qt,xt+=p*Xt,Lt+=p*xe,_t+=p*Zt,Et+=p*Yt,Vt+=p*Ce,wt+=p*Jt,At+=p*qt,Ut+=p*Fe,bt+=p*te,p=q[2],at+=p*Gt,Mt+=p*kt,Ct+=p*De,It+=p*Wt,Ae+=p*Kt,$t+=p*Se,xt+=p*Qt,Lt+=p*Xt,_t+=p*xe,Et+=p*Zt,Vt+=p*Yt,wt+=p*Ce,At+=p*Jt,Ut+=p*qt,bt+=p*Fe,Pt+=p*te,p=q[3],Mt+=p*Gt,Ct+=p*kt,It+=p*De,Ae+=p*Wt,$t+=p*Kt,xt+=p*Se,Lt+=p*Qt,_t+=p*Xt,Et+=p*xe,Vt+=p*Zt,wt+=p*Yt,At+=p*Ce,Ut+=p*Jt,bt+=p*qt,Pt+=p*Fe,Bt+=p*te,p=q[4],Ct+=p*Gt,It+=p*kt,Ae+=p*De,$t+=p*Wt,xt+=p*Kt,Lt+=p*Se,_t+=p*Qt,Et+=p*Xt,Vt+=p*xe,wt+=p*Zt,At+=p*Yt,Ut+=p*Ce,bt+=p*Jt,Pt+=p*qt,Bt+=p*Fe,Ot+=p*te,p=q[5],It+=p*Gt,Ae+=p*kt,$t+=p*De,xt+=p*Wt,Lt+=p*Kt,_t+=p*Se,Et+=p*Qt,Vt+=p*Xt,wt+=p*xe,At+=p*Zt,Ut+=p*Yt,bt+=p*Ce,Pt+=p*Jt,Bt+=p*qt,Ot+=p*Fe,Nt+=p*te,p=q[6],Ae+=p*Gt,$t+=p*kt,xt+=p*De,Lt+=p*Wt,_t+=p*Kt,Et+=p*Se,Vt+=p*Qt,wt+=p*Xt,At+=p*xe,Ut+=p*Zt,bt+=p*Yt,Pt+=p*Ce,Bt+=p*Jt,Ot+=p*qt,Nt+=p*Fe,se+=p*te,p=q[7],$t+=p*Gt,xt+=p*kt,Lt+=p*De,_t+=p*Wt,Et+=p*Kt,Vt+=p*Se,wt+=p*Qt,At+=p*Xt,Ut+=p*xe,bt+=p*Zt,Pt+=p*Yt,Bt+=p*Ce,Ot+=p*Jt,Nt+=p*qt,se+=p*Fe,Rt+=p*te,p=q[8],xt+=p*Gt,Lt+=p*kt,_t+=p*De,Et+=p*Wt,Vt+=p*Kt,wt+=p*Se,At+=p*Qt,Ut+=p*Xt,bt+=p*xe,Pt+=p*Zt,Bt+=p*Yt,Ot+=p*Ce,Nt+=p*Jt,se+=p*qt,Rt+=p*Fe,Tt+=p*te,p=q[9],Lt+=p*Gt,_t+=p*kt,Et+=p*De,Vt+=p*Wt,wt+=p*Kt,At+=p*Se,Ut+=p*Qt,bt+=p*Xt,Pt+=p*xe,Bt+=p*Zt,Ot+=p*Yt,Nt+=p*Ce,se+=p*Jt,Rt+=p*qt,Tt+=p*Fe,We+=p*te,p=q[10],_t+=p*Gt,Et+=p*kt,Vt+=p*De,wt+=p*Wt,At+=p*Kt,Ut+=p*Se,bt+=p*Qt,Pt+=p*Xt,Bt+=p*xe,Ot+=p*Zt,Nt+=p*Yt,se+=p*Ce,Rt+=p*Jt,Tt+=p*qt,We+=p*Fe,ue+=p*te,p=q[11],Et+=p*Gt,Vt+=p*kt,wt+=p*De,At+=p*Wt,Ut+=p*Kt,bt+=p*Se,Pt+=p*Qt,Bt+=p*Xt,Ot+=p*xe,Nt+=p*Zt,se+=p*Yt,Rt+=p*Ce,Tt+=p*Jt,We+=p*qt,ue+=p*Fe,ge+=p*te,p=q[12],Vt+=p*Gt,wt+=p*kt,At+=p*De,Ut+=p*Wt,bt+=p*Kt,Pt+=p*Se,Bt+=p*Qt,Ot+=p*Xt,Nt+=p*xe,se+=p*Zt,Rt+=p*Yt,Tt+=p*Ce,We+=p*Jt,ue+=p*qt,ge+=p*Fe,Ye+=p*te,p=q[13],wt+=p*Gt,At+=p*kt,Ut+=p*De,bt+=p*Wt,Pt+=p*Kt,Bt+=p*Se,Ot+=p*Qt,Nt+=p*Xt,se+=p*xe,Rt+=p*Zt,Tt+=p*Yt,We+=p*Ce,ue+=p*Jt,ge+=p*qt,Ye+=p*Fe,we+=p*te,p=q[14],At+=p*Gt,Ut+=p*kt,bt+=p*De,Pt+=p*Wt,Bt+=p*Kt,Ot+=p*Se,Nt+=p*Qt,se+=p*Xt,Rt+=p*xe,Tt+=p*Zt,We+=p*Yt,ue+=p*Ce,ge+=p*Jt,Ye+=p*qt,we+=p*Fe,Ee+=p*te,p=q[15],Ut+=p*Gt,bt+=p*kt,Pt+=p*De,Bt+=p*Wt,Ot+=p*Kt,Nt+=p*Se,se+=p*Qt,Rt+=p*Xt,Tt+=p*xe,We+=p*Zt,ue+=p*Yt,ge+=p*Ce,Ye+=p*Jt,we+=p*qt,Ee+=p*Fe,Mr+=p*te,et+=38*bt,ot+=38*Pt,at+=38*Bt,Mt+=38*Ot,Ct+=38*Nt,It+=38*se,Ae+=38*Rt,$t+=38*Tt,xt+=38*We,Lt+=38*ue,_t+=38*ge,Et+=38*Ye,Vt+=38*we,wt+=38*Ee,At+=38*Mr,F=1,p=et+F+65535,F=Math.floor(p/65536),et=p-F*65536,p=ot+F+65535,F=Math.floor(p/65536),ot=p-F*65536,p=at+F+65535,F=Math.floor(p/65536),at=p-F*65536,p=Mt+F+65535,F=Math.floor(p/65536),Mt=p-F*65536,p=Ct+F+65535,F=Math.floor(p/65536),Ct=p-F*65536,p=It+F+65535,F=Math.floor(p/65536),It=p-F*65536,p=Ae+F+65535,F=Math.floor(p/65536),Ae=p-F*65536,p=$t+F+65535,F=Math.floor(p/65536),$t=p-F*65536,p=xt+F+65535,F=Math.floor(p/65536),xt=p-F*65536,p=Lt+F+65535,F=Math.floor(p/65536),Lt=p-F*65536,p=_t+F+65535,F=Math.floor(p/65536),_t=p-F*65536,p=Et+F+65535,F=Math.floor(p/65536),Et=p-F*65536,p=Vt+F+65535,F=Math.floor(p/65536),Vt=p-F*65536,p=wt+F+65535,F=Math.floor(p/65536),wt=p-F*65536,p=At+F+65535,F=Math.floor(p/65536),At=p-F*65536,p=Ut+F+65535,F=Math.floor(p/65536),Ut=p-F*65536,et+=F-1+37*(F-1),F=1,p=et+F+65535,F=Math.floor(p/65536),et=p-F*65536,p=ot+F+65535,F=Math.floor(p/65536),ot=p-F*65536,p=at+F+65535,F=Math.floor(p/65536),at=p-F*65536,p=Mt+F+65535,F=Math.floor(p/65536),Mt=p-F*65536,p=Ct+F+65535,F=Math.floor(p/65536),Ct=p-F*65536,p=It+F+65535,F=Math.floor(p/65536),It=p-F*65536,p=Ae+F+65535,F=Math.floor(p/65536),Ae=p-F*65536,p=$t+F+65535,F=Math.floor(p/65536),$t=p-F*65536,p=xt+F+65535,F=Math.floor(p/65536),xt=p-F*65536,p=Lt+F+65535,F=Math.floor(p/65536),Lt=p-F*65536,p=_t+F+65535,F=Math.floor(p/65536),_t=p-F*65536,p=Et+F+65535,F=Math.floor(p/65536),Et=p-F*65536,p=Vt+F+65535,F=Math.floor(p/65536),Vt=p-F*65536,p=wt+F+65535,F=Math.floor(p/65536),wt=p-F*65536,p=At+F+65535,F=Math.floor(p/65536),At=p-F*65536,p=Ut+F+65535,F=Math.floor(p/65536),Ut=p-F*65536,et+=F-1+37*(F-1),L[0]=et,L[1]=ot,L[2]=at,L[3]=Mt,L[4]=Ct,L[5]=It,L[6]=Ae,L[7]=$t,L[8]=xt,L[9]=Lt,L[10]=_t,L[11]=Et,L[12]=Vt,L[13]=wt,L[14]=At,L[15]=Ut}function R(L,q){v(L,q,q)}function st(L,q){const z=s();let p;for(p=0;p<16;p++)z[p]=q[p];for(p=253;p>=0;p--)R(z,z),p!==2&&p!==4&&v(z,z,q);for(p=0;p<16;p++)L[p]=z[p]}function dt(L,q){const z=s();let p;for(p=0;p<16;p++)z[p]=q[p];for(p=250;p>=0;p--)R(z,z),p!==1&&v(z,z,q);for(p=0;p<16;p++)L[p]=z[p]}function pt(L,q){const z=s(),p=s(),F=s(),et=s(),ot=s(),at=s(),Mt=s(),Ct=s(),It=s();k(z,L[1],L[0]),k(It,q[1],q[0]),v(z,z,It),$(p,L[0],L[1]),$(It,q[0],q[1]),v(p,p,It),v(F,L[3],q[3]),v(F,F,l),v(et,L[2],q[2]),$(et,et,et),k(ot,p,z),k(at,et,F),$(Mt,et,F),$(Ct,p,z),v(L[0],ot,at),v(L[1],Ct,Mt),v(L[2],Mt,at),v(L[3],ot,Ct)}function yt(L,q,z){for(let p=0;p<4;p++)G(L[p],q[p],z)}function f(L,q){const z=s(),p=s(),F=s();st(F,q[2]),v(z,q[0],F),v(p,q[1],F),V(L,p),L[31]^=W(z)<<7}function y(L,q,z){S(L[0],u),S(L[1],h),S(L[2],h),S(L[3],u);for(let p=255;p>=0;--p){const F=z[p/8|0]>>(p&7)&1;yt(L,q,F),pt(q,L),pt(L,L),yt(L,q,F)}}function b(L,q){const z=[s(),s(),s(),s()];S(z[0],w),S(z[1],_),S(z[2],h),v(z[3],w,_),y(L,z,q)}function P(L){if(L.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const q=(0,e.hash)(L);q[0]&=248,q[31]&=127,q[31]|=64;const z=new Uint8Array(32),p=[s(),s(),s(),s()];b(p,q),f(z,p);const F=new Uint8Array(64);return F.set(L),F.set(z,32),{publicKey:z,secretKey:F}}r.generateKeyPairFromSeed=P;function C(L){const q=(0,t.randomBytes)(32,L),z=P(q);return(0,i.wipe)(q),z}r.generateKeyPair=C;function O(L){if(L.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}r.extractPublicKeyFromSecretKey=O;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function D(L,q){let z,p,F,et;for(p=63;p>=32;--p){for(z=0,F=p-32,et=p-12;F<et;++F)q[F]+=z-16*q[p]*B[F-(p-32)],z=Math.floor((q[F]+128)/256),q[F]-=z*256;q[F]+=z,q[p]=0}for(z=0,F=0;F<32;F++)q[F]+=z-(q[31]>>4)*B[F],z=q[F]>>8,q[F]&=255;for(F=0;F<32;F++)q[F]-=z*B[F];for(p=0;p<32;p++)q[p+1]+=q[p]>>8,L[p]=q[p]&255}function g(L){const q=new Float64Array(64);for(let z=0;z<64;z++)q[z]=L[z];for(let z=0;z<64;z++)L[z]=0;D(L,q)}function T(L,q){const z=new Float64Array(64),p=[s(),s(),s(),s()],F=(0,e.hash)(L.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const et=new Uint8Array(64);et.set(F.subarray(32),32);const ot=new e.SHA512;ot.update(et.subarray(32)),ot.update(q);const at=ot.digest();ot.clean(),g(at),b(p,at),f(et,p),ot.reset(),ot.update(et.subarray(0,32)),ot.update(L.subarray(32)),ot.update(q);const Mt=ot.digest();g(Mt);for(let Ct=0;Ct<32;Ct++)z[Ct]=at[Ct];for(let Ct=0;Ct<32;Ct++)for(let It=0;It<32;It++)z[Ct+It]+=Mt[Ct]*F[It];return D(et.subarray(32),z),et}r.sign=T;function rt(L,q){const z=s(),p=s(),F=s(),et=s(),ot=s(),at=s(),Mt=s();return S(L[2],h),U(L[1],q),R(F,L[1]),v(et,F,d),k(F,F,L[2]),$(et,L[2],et),R(ot,et),R(at,ot),v(Mt,at,ot),v(z,Mt,F),v(z,z,et),dt(z,z),v(z,z,F),v(z,z,et),v(z,z,et),v(L[0],z,et),R(p,L[0]),v(p,p,et),H(p,F)&&v(L[0],L[0],I),R(p,L[0]),v(p,p,et),H(p,F)?-1:(W(L[0])===q[31]>>7&&k(L[0],u,L[0]),v(L[3],L[0],L[1]),0)}function lt(L,q,z){const p=new Uint8Array(32),F=[s(),s(),s(),s()],et=[s(),s(),s(),s()];if(z.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(rt(et,L))return!1;const ot=new e.SHA512;ot.update(z.subarray(0,32)),ot.update(L),ot.update(q);const at=ot.digest();return g(at),y(F,et,at),b(et,z.subarray(32)),pt(F,et),f(p,F),!Z(z,p)}r.verify=lt;function E(L){let q=[s(),s(),s(),s()];if(rt(q,L))throw new Error("Ed25519: invalid public key");let z=s(),p=s(),F=q[1];$(z,h,F),k(p,h,F),st(p,p),v(z,z,p);let et=new Uint8Array(32);return V(et,z),et}r.convertPublicKeyToX25519=E;function tt(L){const q=(0,e.hash)(L.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const z=new Uint8Array(q.subarray(0,32));return(0,i.wipe)(q),z}r.convertSecretKeyToX25519=tt})(cf);const GE="EdDSA",WE="JWT",pu=".",Ou="base64url",p1="utf8",g1="utf8",YE=":",JE="did",QE="key",Qp="base58btc",XE="z",ZE="K36",t5=32;function m1(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function ru(r,t){t||(t=r.reduce((s,a)=>s+a.length,0));const e=m1(t);let i=0;for(const s of r)e.set(s,i),i+=s.length;return e}function e5(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),i=0;i<e.length;i++)e[i]=255;for(var s=0;s<r.length;s++){var a=r.charAt(s),u=a.charCodeAt(0);if(e[u]!==255)throw new TypeError(a+" is ambiguous");e[u]=s}var h=r.length,d=r.charAt(0),l=Math.log(h)/Math.log(256),w=Math.log(256)/Math.log(h);function _(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var G=0,V=0,Z=0,H=M.length;Z!==H&&M[Z]===0;)Z++,G++;for(var W=(H-Z)*w+1>>>0,U=new Uint8Array(W);Z!==H;){for(var $=M[Z],k=0,v=W-1;($!==0||k<V)&&v!==-1;v--,k++)$+=256*U[v]>>>0,U[v]=$%h>>>0,$=$/h>>>0;if($!==0)throw new Error("Non-zero carry");V=k,Z++}for(var R=W-V;R!==W&&U[R]===0;)R++;for(var st=d.repeat(G);R<W;++R)st+=r.charAt(U[R]);return st}function I(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var G=0;if(M[G]!==" "){for(var V=0,Z=0;M[G]===d;)V++,G++;for(var H=(M.length-G)*l+1>>>0,W=new Uint8Array(H);M[G];){var U=e[M.charCodeAt(G)];if(U===255)return;for(var $=0,k=H-1;(U!==0||$<Z)&&k!==-1;k--,$++)U+=h*W[k]>>>0,W[k]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");Z=$,G++}if(M[G]!==" "){for(var v=H-Z;v!==H&&W[v]===0;)v++;for(var R=new Uint8Array(V+(H-v)),st=V;v!==H;)R[st++]=W[v++];return R}}}function S(M){var G=I(M);if(G)return G;throw new Error(`Non-${t} character`)}return{encode:_,decodeUnsafe:I,decode:S}}var r5=e5,i5=r5;const n5=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},s5=r=>new TextEncoder().encode(r),o5=r=>new TextDecoder().decode(r);class a5{constructor(t,e,i){this.name=t,this.prefix=e,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class c5{constructor(t,e,i){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return v1(this,t)}}class u5{constructor(t){this.decoders=t}or(t){return v1(this,t)}decode(t){const e=t[0],i=this.decoders[e];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const v1=(r,t)=>new u5({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}});class h5{constructor(t,e,i,s){this.name=t,this.prefix=e,this.baseEncode=i,this.baseDecode=s,this.encoder=new a5(t,e,i),this.decoder=new c5(t,e,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Nu=({name:r,prefix:t,encode:e,decode:i})=>new h5(r,t,e,i),Oa=({prefix:r,name:t,alphabet:e})=>{const{encode:i,decode:s}=i5(e,t);return Nu({prefix:r,name:t,encode:i,decode:a=>n5(s(a))})},l5=(r,t,e,i)=>{const s={};for(let w=0;w<t.length;++w)s[t[w]]=w;let a=r.length;for(;r[a-1]==="=";)--a;const u=new Uint8Array(a*e/8|0);let h=0,d=0,l=0;for(let w=0;w<a;++w){const _=s[r[w]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<e|_,h+=e,h>=8&&(h-=8,u[l++]=255&d>>h)}if(h>=e||255&d<<8-h)throw new SyntaxError("Unexpected end of data");return u},f5=(r,t,e)=>{const i=t[t.length-1]==="=",s=(1<<e)-1;let a="",u=0,h=0;for(let d=0;d<r.length;++d)for(h=h<<8|r[d],u+=8;u>e;)u-=e,a+=t[s&h>>u];if(u&&(a+=t[s&h<<e-u]),i)for(;a.length*e&7;)a+="=";return a},Er=({name:r,prefix:t,bitsPerChar:e,alphabet:i})=>Nu({prefix:t,name:r,encode(s){return f5(s,i,e)},decode(s){return l5(s,i,e,r)}}),d5=Nu({prefix:"\0",name:"identity",encode:r=>o5(r),decode:r=>s5(r)}),p5=Object.freeze(Object.defineProperty({__proto__:null,identity:d5},Symbol.toStringTag,{value:"Module"})),g5=Er({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),m5=Object.freeze(Object.defineProperty({__proto__:null,base2:g5},Symbol.toStringTag,{value:"Module"})),v5=Er({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),y5=Object.freeze(Object.defineProperty({__proto__:null,base8:v5},Symbol.toStringTag,{value:"Module"})),w5=Oa({prefix:"9",name:"base10",alphabet:"0123456789"}),b5=Object.freeze(Object.defineProperty({__proto__:null,base10:w5},Symbol.toStringTag,{value:"Module"})),_5=Er({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),E5=Er({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),A5=Object.freeze(Object.defineProperty({__proto__:null,base16:_5,base16upper:E5},Symbol.toStringTag,{value:"Module"})),S5=Er({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),I5=Er({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D5=Er({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),x5=Er({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),M5=Er({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),P5=Er({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),C5=Er({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),O5=Er({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),N5=Er({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),T5=Object.freeze(Object.defineProperty({__proto__:null,base32:S5,base32hex:M5,base32hexpad:C5,base32hexpadupper:O5,base32hexupper:P5,base32pad:D5,base32padupper:x5,base32upper:I5,base32z:N5},Symbol.toStringTag,{value:"Module"})),R5=Oa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),F5=Oa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),U5=Object.freeze(Object.defineProperty({__proto__:null,base36:R5,base36upper:F5},Symbol.toStringTag,{value:"Module"})),L5=Oa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),B5=Oa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),q5=Object.freeze(Object.defineProperty({__proto__:null,base58btc:L5,base58flickr:B5},Symbol.toStringTag,{value:"Module"})),j5=Er({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$5=Er({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),k5=Er({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),z5=Er({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),H5=Object.freeze(Object.defineProperty({__proto__:null,base64:j5,base64pad:$5,base64url:k5,base64urlpad:z5},Symbol.toStringTag,{value:"Module"})),y1=Array.from(""),K5=y1.reduce((r,t,e)=>(r[e]=t,r),[]),V5=y1.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function G5(r){return r.reduce((t,e)=>(t+=K5[e],t),"")}function W5(r){const t=[];for(const e of r){const i=V5[e.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(i)}return new Uint8Array(t)}const Y5=Nu({prefix:"",name:"base256emoji",encode:G5,decode:W5}),J5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Y5},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Xp={...p5,...m5,...y5,...b5,...A5,...T5,...U5,...q5,...H5,...J5};function w1(r,t,e,i){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:i}}}const Zp=w1("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),il=w1("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);const t=m1(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),b1={utf8:Zp,"utf-8":Zp,hex:Xp.base16,latin1:il,ascii:il,binary:il,...Xp};function yr(r,t="utf8"){const e=b1[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):e.encoder.encode(r).substring(1)}function vr(r,t="utf8"){const e=b1[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):e.decoder.decode(`${e.prefix}${r}`)}function t0(r){return Ls(yr(vr(r,Ou),p1))}function gu(r){return yr(vr(qn(r),p1),Ou)}function _1(r){const t=vr(ZE,Qp),e=XE+yr(ru([t,r]),Qp);return[JE,QE,e].join(YE)}function Q5(r){return yr(r,Ou)}function X5(r){return vr(r,Ou)}function Z5(r){return vr([gu(r.header),gu(r.payload)].join(pu),g1)}function tA(r){return[gu(r.header),gu(r.payload),Q5(r.signature)].join(pu)}function ql(r){const t=r.split(pu),e=t0(t[0]),i=t0(t[1]),s=X5(t[2]),a=vr(t.slice(0,2).join(pu),g1);return{header:e,payload:i,signature:s,data:a}}function e0(r=os.randomBytes(t5)){return cf.generateKeyPairFromSeed(r)}async function eA(r,t,e,i,s=mt.fromMiliseconds(Date.now())){const a={alg:GE,typ:WE},u=_1(i.publicKey),h=s+e,d={iss:u,sub:r,aud:t,iat:s,exp:h},l=Z5({header:a,payload:d}),w=cf.sign(i.secretKey,l);return tA({header:a,payload:d,signature:w})}var uf={},Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});var Dr=ae,jl=oi,rA=20;function iA(r,t,e){for(var i=1634760805,s=857760878,a=2036477234,u=1797285236,h=e[3]<<24|e[2]<<16|e[1]<<8|e[0],d=e[7]<<24|e[6]<<16|e[5]<<8|e[4],l=e[11]<<24|e[10]<<16|e[9]<<8|e[8],w=e[15]<<24|e[14]<<16|e[13]<<8|e[12],_=e[19]<<24|e[18]<<16|e[17]<<8|e[16],I=e[23]<<24|e[22]<<16|e[21]<<8|e[20],S=e[27]<<24|e[26]<<16|e[25]<<8|e[24],M=e[31]<<24|e[30]<<16|e[29]<<8|e[28],G=t[3]<<24|t[2]<<16|t[1]<<8|t[0],V=t[7]<<24|t[6]<<16|t[5]<<8|t[4],Z=t[11]<<24|t[10]<<16|t[9]<<8|t[8],H=t[15]<<24|t[14]<<16|t[13]<<8|t[12],W=i,U=s,$=a,k=u,v=h,R=d,st=l,dt=w,pt=_,yt=I,f=S,y=M,b=G,P=V,C=Z,O=H,B=0;B<rA;B+=2)W=W+v|0,b^=W,b=b>>>16|b<<16,pt=pt+b|0,v^=pt,v=v>>>20|v<<12,U=U+R|0,P^=U,P=P>>>16|P<<16,yt=yt+P|0,R^=yt,R=R>>>20|R<<12,$=$+st|0,C^=$,C=C>>>16|C<<16,f=f+C|0,st^=f,st=st>>>20|st<<12,k=k+dt|0,O^=k,O=O>>>16|O<<16,y=y+O|0,dt^=y,dt=dt>>>20|dt<<12,$=$+st|0,C^=$,C=C>>>24|C<<8,f=f+C|0,st^=f,st=st>>>25|st<<7,k=k+dt|0,O^=k,O=O>>>24|O<<8,y=y+O|0,dt^=y,dt=dt>>>25|dt<<7,U=U+R|0,P^=U,P=P>>>24|P<<8,yt=yt+P|0,R^=yt,R=R>>>25|R<<7,W=W+v|0,b^=W,b=b>>>24|b<<8,pt=pt+b|0,v^=pt,v=v>>>25|v<<7,W=W+R|0,O^=W,O=O>>>16|O<<16,f=f+O|0,R^=f,R=R>>>20|R<<12,U=U+st|0,b^=U,b=b>>>16|b<<16,y=y+b|0,st^=y,st=st>>>20|st<<12,$=$+dt|0,P^=$,P=P>>>16|P<<16,pt=pt+P|0,dt^=pt,dt=dt>>>20|dt<<12,k=k+v|0,C^=k,C=C>>>16|C<<16,yt=yt+C|0,v^=yt,v=v>>>20|v<<12,$=$+dt|0,P^=$,P=P>>>24|P<<8,pt=pt+P|0,dt^=pt,dt=dt>>>25|dt<<7,k=k+v|0,C^=k,C=C>>>24|C<<8,yt=yt+C|0,v^=yt,v=v>>>25|v<<7,U=U+st|0,b^=U,b=b>>>24|b<<8,y=y+b|0,st^=y,st=st>>>25|st<<7,W=W+R|0,O^=W,O=O>>>24|O<<8,f=f+O|0,R^=f,R=R>>>25|R<<7;Dr.writeUint32LE(W+i|0,r,0),Dr.writeUint32LE(U+s|0,r,4),Dr.writeUint32LE($+a|0,r,8),Dr.writeUint32LE(k+u|0,r,12),Dr.writeUint32LE(v+h|0,r,16),Dr.writeUint32LE(R+d|0,r,20),Dr.writeUint32LE(st+l|0,r,24),Dr.writeUint32LE(dt+w|0,r,28),Dr.writeUint32LE(pt+_|0,r,32),Dr.writeUint32LE(yt+I|0,r,36),Dr.writeUint32LE(f+S|0,r,40),Dr.writeUint32LE(y+M|0,r,44),Dr.writeUint32LE(b+G|0,r,48),Dr.writeUint32LE(P+V|0,r,52),Dr.writeUint32LE(C+Z|0,r,56),Dr.writeUint32LE(O+H|0,r,60)}function E1(r,t,e,i,s){if(s===void 0&&(s=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<e.length)throw new Error("ChaCha: destination is shorter than source");var a,u;if(s===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),u=a.length-t.length,a.set(t,u)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");a=t,u=s}for(var h=new Uint8Array(64),d=0;d<e.length;d+=64){iA(h,a,r);for(var l=d;l<d+64&&l<e.length;l++)i[l]=e[l]^h[l-d];sA(a,0,u)}return jl.wipe(h),s===0&&jl.wipe(a),i}Tu.streamXOR=E1;function nA(r,t,e,i){return i===void 0&&(i=0),jl.wipe(e),E1(r,t,e,e,i)}Tu.stream=nA;function sA(r,t,e){for(var i=1;e--;)i=i+(r[t]&255)|0,r[t]=i&255,i>>>=8,t++;if(i>0)throw new Error("ChaCha: counter overflow")}var A1={},as={};Object.defineProperty(as,"__esModule",{value:!0});function oA(r,t,e){return~(r-1)&t|r-1&e}as.select=oA;function aA(r,t){return(r|0)-(t|0)-1>>>31&1}as.lessOrEqual=aA;function S1(r,t){if(r.length!==t.length)return 0;for(var e=0,i=0;i<r.length;i++)e|=r[i]^t[i];return 1&e-1>>>8}as.compare=S1;function cA(r,t){return r.length===0||t.length===0?!1:S1(r,t)!==0}as.equal=cA;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=as,e=oi;r.DIGEST_LENGTH=16;var i=function(){function u(h){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var d=h[0]|h[1]<<8;this._r[0]=d&8191;var l=h[2]|h[3]<<8;this._r[1]=(d>>>13|l<<3)&8191;var w=h[4]|h[5]<<8;this._r[2]=(l>>>10|w<<6)&7939;var _=h[6]|h[7]<<8;this._r[3]=(w>>>7|_<<9)&8191;var I=h[8]|h[9]<<8;this._r[4]=(_>>>4|I<<12)&255,this._r[5]=I>>>1&8190;var S=h[10]|h[11]<<8;this._r[6]=(I>>>14|S<<2)&8191;var M=h[12]|h[13]<<8;this._r[7]=(S>>>11|M<<5)&8065;var G=h[14]|h[15]<<8;this._r[8]=(M>>>8|G<<8)&8191,this._r[9]=G>>>5&127,this._pad[0]=h[16]|h[17]<<8,this._pad[1]=h[18]|h[19]<<8,this._pad[2]=h[20]|h[21]<<8,this._pad[3]=h[22]|h[23]<<8,this._pad[4]=h[24]|h[25]<<8,this._pad[5]=h[26]|h[27]<<8,this._pad[6]=h[28]|h[29]<<8,this._pad[7]=h[30]|h[31]<<8}return u.prototype._blocks=function(h,d,l){for(var w=this._fin?0:2048,_=this._h[0],I=this._h[1],S=this._h[2],M=this._h[3],G=this._h[4],V=this._h[5],Z=this._h[6],H=this._h[7],W=this._h[8],U=this._h[9],$=this._r[0],k=this._r[1],v=this._r[2],R=this._r[3],st=this._r[4],dt=this._r[5],pt=this._r[6],yt=this._r[7],f=this._r[8],y=this._r[9];l>=16;){var b=h[d+0]|h[d+1]<<8;_+=b&8191;var P=h[d+2]|h[d+3]<<8;I+=(b>>>13|P<<3)&8191;var C=h[d+4]|h[d+5]<<8;S+=(P>>>10|C<<6)&8191;var O=h[d+6]|h[d+7]<<8;M+=(C>>>7|O<<9)&8191;var B=h[d+8]|h[d+9]<<8;G+=(O>>>4|B<<12)&8191,V+=B>>>1&8191;var D=h[d+10]|h[d+11]<<8;Z+=(B>>>14|D<<2)&8191;var g=h[d+12]|h[d+13]<<8;H+=(D>>>11|g<<5)&8191;var T=h[d+14]|h[d+15]<<8;W+=(g>>>8|T<<8)&8191,U+=T>>>5|w;var rt=0,lt=rt;lt+=_*$,lt+=I*(5*y),lt+=S*(5*f),lt+=M*(5*yt),lt+=G*(5*pt),rt=lt>>>13,lt&=8191,lt+=V*(5*dt),lt+=Z*(5*st),lt+=H*(5*R),lt+=W*(5*v),lt+=U*(5*k),rt+=lt>>>13,lt&=8191;var E=rt;E+=_*k,E+=I*$,E+=S*(5*y),E+=M*(5*f),E+=G*(5*yt),rt=E>>>13,E&=8191,E+=V*(5*pt),E+=Z*(5*dt),E+=H*(5*st),E+=W*(5*R),E+=U*(5*v),rt+=E>>>13,E&=8191;var tt=rt;tt+=_*v,tt+=I*k,tt+=S*$,tt+=M*(5*y),tt+=G*(5*f),rt=tt>>>13,tt&=8191,tt+=V*(5*yt),tt+=Z*(5*pt),tt+=H*(5*dt),tt+=W*(5*st),tt+=U*(5*R),rt+=tt>>>13,tt&=8191;var L=rt;L+=_*R,L+=I*v,L+=S*k,L+=M*$,L+=G*(5*y),rt=L>>>13,L&=8191,L+=V*(5*f),L+=Z*(5*yt),L+=H*(5*pt),L+=W*(5*dt),L+=U*(5*st),rt+=L>>>13,L&=8191;var q=rt;q+=_*st,q+=I*R,q+=S*v,q+=M*k,q+=G*$,rt=q>>>13,q&=8191,q+=V*(5*y),q+=Z*(5*f),q+=H*(5*yt),q+=W*(5*pt),q+=U*(5*dt),rt+=q>>>13,q&=8191;var z=rt;z+=_*dt,z+=I*st,z+=S*R,z+=M*v,z+=G*k,rt=z>>>13,z&=8191,z+=V*$,z+=Z*(5*y),z+=H*(5*f),z+=W*(5*yt),z+=U*(5*pt),rt+=z>>>13,z&=8191;var p=rt;p+=_*pt,p+=I*dt,p+=S*st,p+=M*R,p+=G*v,rt=p>>>13,p&=8191,p+=V*k,p+=Z*$,p+=H*(5*y),p+=W*(5*f),p+=U*(5*yt),rt+=p>>>13,p&=8191;var F=rt;F+=_*yt,F+=I*pt,F+=S*dt,F+=M*st,F+=G*R,rt=F>>>13,F&=8191,F+=V*v,F+=Z*k,F+=H*$,F+=W*(5*y),F+=U*(5*f),rt+=F>>>13,F&=8191;var et=rt;et+=_*f,et+=I*yt,et+=S*pt,et+=M*dt,et+=G*st,rt=et>>>13,et&=8191,et+=V*R,et+=Z*v,et+=H*k,et+=W*$,et+=U*(5*y),rt+=et>>>13,et&=8191;var ot=rt;ot+=_*y,ot+=I*f,ot+=S*yt,ot+=M*pt,ot+=G*dt,rt=ot>>>13,ot&=8191,ot+=V*st,ot+=Z*R,ot+=H*v,ot+=W*k,ot+=U*$,rt+=ot>>>13,ot&=8191,rt=(rt<<2)+rt|0,rt=rt+lt|0,lt=rt&8191,rt=rt>>>13,E+=rt,_=lt,I=E,S=tt,M=L,G=q,V=z,Z=p,H=F,W=et,U=ot,d+=16,l-=16}this._h[0]=_,this._h[1]=I,this._h[2]=S,this._h[3]=M,this._h[4]=G,this._h[5]=V,this._h[6]=Z,this._h[7]=H,this._h[8]=W,this._h[9]=U},u.prototype.finish=function(h,d){d===void 0&&(d=0);var l=new Uint16Array(10),w,_,I,S;if(this._leftover){for(S=this._leftover,this._buffer[S++]=1;S<16;S++)this._buffer[S]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(w=this._h[1]>>>13,this._h[1]&=8191,S=2;S<10;S++)this._h[S]+=w,w=this._h[S]>>>13,this._h[S]&=8191;for(this._h[0]+=w*5,w=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=w,w=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=w,l[0]=this._h[0]+5,w=l[0]>>>13,l[0]&=8191,S=1;S<10;S++)l[S]=this._h[S]+w,w=l[S]>>>13,l[S]&=8191;for(l[9]-=8192,_=(w^1)-1,S=0;S<10;S++)l[S]&=_;for(_=~_,S=0;S<10;S++)this._h[S]=this._h[S]&_|l[S];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,I=this._h[0]+this._pad[0],this._h[0]=I&65535,S=1;S<8;S++)I=(this._h[S]+this._pad[S]|0)+(I>>>16)|0,this._h[S]=I&65535;return h[d+0]=this._h[0]>>>0,h[d+1]=this._h[0]>>>8,h[d+2]=this._h[1]>>>0,h[d+3]=this._h[1]>>>8,h[d+4]=this._h[2]>>>0,h[d+5]=this._h[2]>>>8,h[d+6]=this._h[3]>>>0,h[d+7]=this._h[3]>>>8,h[d+8]=this._h[4]>>>0,h[d+9]=this._h[4]>>>8,h[d+10]=this._h[5]>>>0,h[d+11]=this._h[5]>>>8,h[d+12]=this._h[6]>>>0,h[d+13]=this._h[6]>>>8,h[d+14]=this._h[7]>>>0,h[d+15]=this._h[7]>>>8,this._finished=!0,this},u.prototype.update=function(h){var d=0,l=h.length,w;if(this._leftover){w=16-this._leftover,w>l&&(w=l);for(var _=0;_<w;_++)this._buffer[this._leftover+_]=h[d+_];if(l-=w,d+=w,this._leftover+=w,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(w=l-l%16,this._blocks(h,d,w),d+=w,l-=w),l){for(var _=0;_<l;_++)this._buffer[this._leftover+_]=h[d+_];this._leftover+=l}return this},u.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var h=new Uint8Array(16);return this.finish(h),h},u.prototype.clean=function(){return e.wipe(this._buffer),e.wipe(this._r),e.wipe(this._h),e.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},u}();r.Poly1305=i;function s(u,h){var d=new i(u);d.update(h);var l=d.digest();return d.clean(),l}r.oneTimeAuth=s;function a(u,h){return u.length!==r.DIGEST_LENGTH||h.length!==r.DIGEST_LENGTH?!1:t.equal(u,h)}r.equal=a})(A1);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=Tu,e=A1,i=oi,s=ae,a=as;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var u=new Uint8Array(16),h=function(){function d(l){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,l.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return d.prototype.seal=function(l,w,_,I){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var S=new Uint8Array(16);S.set(l,S.length-l.length);var M=new Uint8Array(32);t.stream(this._key,S,M,4);var G=w.length+this.tagLength,V;if(I){if(I.length!==G)throw new Error("ChaCha20Poly1305: incorrect destination length");V=I}else V=new Uint8Array(G);return t.streamXOR(this._key,S,w,V,4),this._authenticate(V.subarray(V.length-this.tagLength,V.length),M,V.subarray(0,V.length-this.tagLength),_),i.wipe(S),V},d.prototype.open=function(l,w,_,I){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(w.length<this.tagLength)return null;var S=new Uint8Array(16);S.set(l,S.length-l.length);var M=new Uint8Array(32);t.stream(this._key,S,M,4);var G=new Uint8Array(this.tagLength);if(this._authenticate(G,M,w.subarray(0,w.length-this.tagLength),_),!a.equal(G,w.subarray(w.length-this.tagLength,w.length)))return null;var V=w.length-this.tagLength,Z;if(I){if(I.length!==V)throw new Error("ChaCha20Poly1305: incorrect destination length");Z=I}else Z=new Uint8Array(V);return t.streamXOR(this._key,S,w.subarray(0,w.length-this.tagLength),Z,4),i.wipe(S),Z},d.prototype.clean=function(){return i.wipe(this._key),this},d.prototype._authenticate=function(l,w,_,I){var S=new e.Poly1305(w);I&&(S.update(I),I.length%16>0&&S.update(u.subarray(I.length%16))),S.update(_),_.length%16>0&&S.update(u.subarray(_.length%16));var M=new Uint8Array(8);I&&s.writeUint64LE(I.length,M),S.update(M),s.writeUint64LE(_.length,M),S.update(M);for(var G=S.digest(),V=0;V<G.length;V++)l[V]=G[V];S.clean(),i.wipe(G),i.wipe(M)},d}();r.ChaCha20Poly1305=h})(uf);var I1={},Na={},hf={};Object.defineProperty(hf,"__esModule",{value:!0});function uA(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}hf.isSerializableHash=uA;Object.defineProperty(Na,"__esModule",{value:!0});var Zi=hf,hA=as,lA=oi,D1=function(){function r(t,e){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);e.length>this.blockSize?this._inner.update(e).finish(i).clean():i.set(e);for(var s=0;s<i.length;s++)i[s]^=54;this._inner.update(i);for(var s=0;s<i.length;s++)i[s]^=106;this._outer.update(i),Zi.isSerializableHash(this._inner)&&Zi.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),lA.wipe(i)}return r.prototype.reset=function(){if(!Zi.isSerializableHash(this._inner)||!Zi.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Zi.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zi.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(t){return this._inner.update(t),this},r.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},r.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},r.prototype.saveState=function(){if(!Zi.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(t){if(!Zi.isSerializableHash(this._inner)||!Zi.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(t){if(!Zi.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},r}();Na.HMAC=D1;function fA(r,t,e){var i=new D1(r,t);i.update(e);var s=i.digest();return i.clean(),s}Na.hmac=fA;Na.equal=hA.equal;Object.defineProperty(I1,"__esModule",{value:!0});var r0=Na,i0=oi,dA=function(){function r(t,e,i,s){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=s;var a=r0.hmac(this._hash,i,e);this._hmac=new r0.HMAC(t,a),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(t){for(var e=new Uint8Array(t),i=0;i<e.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),e[i]=this._buffer[this._bufpos++];return e},r.prototype.clean=function(){this._hmac.clean(),i0.wipe(this._buffer),i0.wipe(this._counter),this._bufpos=0},r}(),pA=I1.HKDF=dA,Ta={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=ae,e=oi;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var i=function(){function h(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return h.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},h.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},h.prototype.clean=function(){e.wipe(this._buffer),e.wipe(this._temp),this.reset()},h.prototype.update=function(d,l){if(l===void 0&&(l=d.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=d[w++],l--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(w=a(this._temp,this._state,d,w,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=d[w++],l--;return this},h.prototype.finish=function(d){if(!this._finished){var l=this._bytesHashed,w=this._bufferLength,_=l/536870912|0,I=l<<3,S=l%64<56?64:128;this._buffer[w]=128;for(var M=w+1;M<S-8;M++)this._buffer[M]=0;t.writeUint32BE(_,this._buffer,S-8),t.writeUint32BE(I,this._buffer,S-4),a(this._temp,this._state,this._buffer,0,S),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)t.writeUint32BE(this._state[M],d,M*4);return this},h.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},h.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},h.prototype.restoreState=function(d){return this._state.set(d.state),this._bufferLength=d.bufferLength,d.buffer&&this._buffer.set(d.buffer),this._bytesHashed=d.bytesHashed,this._finished=!1,this},h.prototype.cleanSavedState=function(d){e.wipe(d.state),d.buffer&&e.wipe(d.buffer),d.bufferLength=0,d.bytesHashed=0},h}();r.SHA256=i;var s=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(h,d,l,w,_){for(;_>=64;){for(var I=d[0],S=d[1],M=d[2],G=d[3],V=d[4],Z=d[5],H=d[6],W=d[7],U=0;U<16;U++){var $=w+U*4;h[U]=t.readUint32BE(l,$)}for(var U=16;U<64;U++){var k=h[U-2],v=(k>>>17|k<<15)^(k>>>19|k<<13)^k>>>10;k=h[U-15];var R=(k>>>7|k<<25)^(k>>>18|k<<14)^k>>>3;h[U]=(v+h[U-7]|0)+(R+h[U-16]|0)}for(var U=0;U<64;U++){var v=(((V>>>6|V<<26)^(V>>>11|V<<21)^(V>>>25|V<<7))+(V&Z^~V&H)|0)+(W+(s[U]+h[U]|0)|0)|0,R=((I>>>2|I<<30)^(I>>>13|I<<19)^(I>>>22|I<<10))+(I&S^I&M^S&M)|0;W=H,H=Z,Z=V,V=G+v|0,G=M,M=S,S=I,I=v+R|0}d[0]+=I,d[1]+=S,d[2]+=M,d[3]+=G,d[4]+=V,d[5]+=Z,d[6]+=H,d[7]+=W,w+=64,_-=64}return w}function u(h){var d=new i;d.update(h);var l=d.digest();return d.clean(),l}r.hash=u})(Ta);var lf={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const t=os,e=oi;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function i(U){const $=new Float64Array(16);if(U)for(let k=0;k<U.length;k++)$[k]=U[k];return $}const s=new Uint8Array(32);s[0]=9;const a=i([56129,1]);function u(U){let $=1;for(let k=0;k<16;k++){let v=U[k]+$+65535;$=Math.floor(v/65536),U[k]=v-$*65536}U[0]+=$-1+37*($-1)}function h(U,$,k){const v=~(k-1);for(let R=0;R<16;R++){const st=v&(U[R]^$[R]);U[R]^=st,$[R]^=st}}function d(U,$){const k=i(),v=i();for(let R=0;R<16;R++)v[R]=$[R];u(v),u(v),u(v);for(let R=0;R<2;R++){k[0]=v[0]-65517;for(let dt=1;dt<15;dt++)k[dt]=v[dt]-65535-(k[dt-1]>>16&1),k[dt-1]&=65535;k[15]=v[15]-32767-(k[14]>>16&1);const st=k[15]>>16&1;k[14]&=65535,h(v,k,1-st)}for(let R=0;R<16;R++)U[2*R]=v[R]&255,U[2*R+1]=v[R]>>8}function l(U,$){for(let k=0;k<16;k++)U[k]=$[2*k]+($[2*k+1]<<8);U[15]&=32767}function w(U,$,k){for(let v=0;v<16;v++)U[v]=$[v]+k[v]}function _(U,$,k){for(let v=0;v<16;v++)U[v]=$[v]-k[v]}function I(U,$,k){let v,R,st=0,dt=0,pt=0,yt=0,f=0,y=0,b=0,P=0,C=0,O=0,B=0,D=0,g=0,T=0,rt=0,lt=0,E=0,tt=0,L=0,q=0,z=0,p=0,F=0,et=0,ot=0,at=0,Mt=0,Ct=0,It=0,Ae=0,$t=0,xt=k[0],Lt=k[1],_t=k[2],Et=k[3],Vt=k[4],wt=k[5],At=k[6],Ut=k[7],bt=k[8],Pt=k[9],Bt=k[10],Ot=k[11],Nt=k[12],se=k[13],Rt=k[14],Tt=k[15];v=$[0],st+=v*xt,dt+=v*Lt,pt+=v*_t,yt+=v*Et,f+=v*Vt,y+=v*wt,b+=v*At,P+=v*Ut,C+=v*bt,O+=v*Pt,B+=v*Bt,D+=v*Ot,g+=v*Nt,T+=v*se,rt+=v*Rt,lt+=v*Tt,v=$[1],dt+=v*xt,pt+=v*Lt,yt+=v*_t,f+=v*Et,y+=v*Vt,b+=v*wt,P+=v*At,C+=v*Ut,O+=v*bt,B+=v*Pt,D+=v*Bt,g+=v*Ot,T+=v*Nt,rt+=v*se,lt+=v*Rt,E+=v*Tt,v=$[2],pt+=v*xt,yt+=v*Lt,f+=v*_t,y+=v*Et,b+=v*Vt,P+=v*wt,C+=v*At,O+=v*Ut,B+=v*bt,D+=v*Pt,g+=v*Bt,T+=v*Ot,rt+=v*Nt,lt+=v*se,E+=v*Rt,tt+=v*Tt,v=$[3],yt+=v*xt,f+=v*Lt,y+=v*_t,b+=v*Et,P+=v*Vt,C+=v*wt,O+=v*At,B+=v*Ut,D+=v*bt,g+=v*Pt,T+=v*Bt,rt+=v*Ot,lt+=v*Nt,E+=v*se,tt+=v*Rt,L+=v*Tt,v=$[4],f+=v*xt,y+=v*Lt,b+=v*_t,P+=v*Et,C+=v*Vt,O+=v*wt,B+=v*At,D+=v*Ut,g+=v*bt,T+=v*Pt,rt+=v*Bt,lt+=v*Ot,E+=v*Nt,tt+=v*se,L+=v*Rt,q+=v*Tt,v=$[5],y+=v*xt,b+=v*Lt,P+=v*_t,C+=v*Et,O+=v*Vt,B+=v*wt,D+=v*At,g+=v*Ut,T+=v*bt,rt+=v*Pt,lt+=v*Bt,E+=v*Ot,tt+=v*Nt,L+=v*se,q+=v*Rt,z+=v*Tt,v=$[6],b+=v*xt,P+=v*Lt,C+=v*_t,O+=v*Et,B+=v*Vt,D+=v*wt,g+=v*At,T+=v*Ut,rt+=v*bt,lt+=v*Pt,E+=v*Bt,tt+=v*Ot,L+=v*Nt,q+=v*se,z+=v*Rt,p+=v*Tt,v=$[7],P+=v*xt,C+=v*Lt,O+=v*_t,B+=v*Et,D+=v*Vt,g+=v*wt,T+=v*At,rt+=v*Ut,lt+=v*bt,E+=v*Pt,tt+=v*Bt,L+=v*Ot,q+=v*Nt,z+=v*se,p+=v*Rt,F+=v*Tt,v=$[8],C+=v*xt,O+=v*Lt,B+=v*_t,D+=v*Et,g+=v*Vt,T+=v*wt,rt+=v*At,lt+=v*Ut,E+=v*bt,tt+=v*Pt,L+=v*Bt,q+=v*Ot,z+=v*Nt,p+=v*se,F+=v*Rt,et+=v*Tt,v=$[9],O+=v*xt,B+=v*Lt,D+=v*_t,g+=v*Et,T+=v*Vt,rt+=v*wt,lt+=v*At,E+=v*Ut,tt+=v*bt,L+=v*Pt,q+=v*Bt,z+=v*Ot,p+=v*Nt,F+=v*se,et+=v*Rt,ot+=v*Tt,v=$[10],B+=v*xt,D+=v*Lt,g+=v*_t,T+=v*Et,rt+=v*Vt,lt+=v*wt,E+=v*At,tt+=v*Ut,L+=v*bt,q+=v*Pt,z+=v*Bt,p+=v*Ot,F+=v*Nt,et+=v*se,ot+=v*Rt,at+=v*Tt,v=$[11],D+=v*xt,g+=v*Lt,T+=v*_t,rt+=v*Et,lt+=v*Vt,E+=v*wt,tt+=v*At,L+=v*Ut,q+=v*bt,z+=v*Pt,p+=v*Bt,F+=v*Ot,et+=v*Nt,ot+=v*se,at+=v*Rt,Mt+=v*Tt,v=$[12],g+=v*xt,T+=v*Lt,rt+=v*_t,lt+=v*Et,E+=v*Vt,tt+=v*wt,L+=v*At,q+=v*Ut,z+=v*bt,p+=v*Pt,F+=v*Bt,et+=v*Ot,ot+=v*Nt,at+=v*se,Mt+=v*Rt,Ct+=v*Tt,v=$[13],T+=v*xt,rt+=v*Lt,lt+=v*_t,E+=v*Et,tt+=v*Vt,L+=v*wt,q+=v*At,z+=v*Ut,p+=v*bt,F+=v*Pt,et+=v*Bt,ot+=v*Ot,at+=v*Nt,Mt+=v*se,Ct+=v*Rt,It+=v*Tt,v=$[14],rt+=v*xt,lt+=v*Lt,E+=v*_t,tt+=v*Et,L+=v*Vt,q+=v*wt,z+=v*At,p+=v*Ut,F+=v*bt,et+=v*Pt,ot+=v*Bt,at+=v*Ot,Mt+=v*Nt,Ct+=v*se,It+=v*Rt,Ae+=v*Tt,v=$[15],lt+=v*xt,E+=v*Lt,tt+=v*_t,L+=v*Et,q+=v*Vt,z+=v*wt,p+=v*At,F+=v*Ut,et+=v*bt,ot+=v*Pt,at+=v*Bt,Mt+=v*Ot,Ct+=v*Nt,It+=v*se,Ae+=v*Rt,$t+=v*Tt,st+=38*E,dt+=38*tt,pt+=38*L,yt+=38*q,f+=38*z,y+=38*p,b+=38*F,P+=38*et,C+=38*ot,O+=38*at,B+=38*Mt,D+=38*Ct,g+=38*It,T+=38*Ae,rt+=38*$t,R=1,v=st+R+65535,R=Math.floor(v/65536),st=v-R*65536,v=dt+R+65535,R=Math.floor(v/65536),dt=v-R*65536,v=pt+R+65535,R=Math.floor(v/65536),pt=v-R*65536,v=yt+R+65535,R=Math.floor(v/65536),yt=v-R*65536,v=f+R+65535,R=Math.floor(v/65536),f=v-R*65536,v=y+R+65535,R=Math.floor(v/65536),y=v-R*65536,v=b+R+65535,R=Math.floor(v/65536),b=v-R*65536,v=P+R+65535,R=Math.floor(v/65536),P=v-R*65536,v=C+R+65535,R=Math.floor(v/65536),C=v-R*65536,v=O+R+65535,R=Math.floor(v/65536),O=v-R*65536,v=B+R+65535,R=Math.floor(v/65536),B=v-R*65536,v=D+R+65535,R=Math.floor(v/65536),D=v-R*65536,v=g+R+65535,R=Math.floor(v/65536),g=v-R*65536,v=T+R+65535,R=Math.floor(v/65536),T=v-R*65536,v=rt+R+65535,R=Math.floor(v/65536),rt=v-R*65536,v=lt+R+65535,R=Math.floor(v/65536),lt=v-R*65536,st+=R-1+37*(R-1),R=1,v=st+R+65535,R=Math.floor(v/65536),st=v-R*65536,v=dt+R+65535,R=Math.floor(v/65536),dt=v-R*65536,v=pt+R+65535,R=Math.floor(v/65536),pt=v-R*65536,v=yt+R+65535,R=Math.floor(v/65536),yt=v-R*65536,v=f+R+65535,R=Math.floor(v/65536),f=v-R*65536,v=y+R+65535,R=Math.floor(v/65536),y=v-R*65536,v=b+R+65535,R=Math.floor(v/65536),b=v-R*65536,v=P+R+65535,R=Math.floor(v/65536),P=v-R*65536,v=C+R+65535,R=Math.floor(v/65536),C=v-R*65536,v=O+R+65535,R=Math.floor(v/65536),O=v-R*65536,v=B+R+65535,R=Math.floor(v/65536),B=v-R*65536,v=D+R+65535,R=Math.floor(v/65536),D=v-R*65536,v=g+R+65535,R=Math.floor(v/65536),g=v-R*65536,v=T+R+65535,R=Math.floor(v/65536),T=v-R*65536,v=rt+R+65535,R=Math.floor(v/65536),rt=v-R*65536,v=lt+R+65535,R=Math.floor(v/65536),lt=v-R*65536,st+=R-1+37*(R-1),U[0]=st,U[1]=dt,U[2]=pt,U[3]=yt,U[4]=f,U[5]=y,U[6]=b,U[7]=P,U[8]=C,U[9]=O,U[10]=B,U[11]=D,U[12]=g,U[13]=T,U[14]=rt,U[15]=lt}function S(U,$){I(U,$,$)}function M(U,$){const k=i();for(let v=0;v<16;v++)k[v]=$[v];for(let v=253;v>=0;v--)S(k,k),v!==2&&v!==4&&I(k,k,$);for(let v=0;v<16;v++)U[v]=k[v]}function G(U,$){const k=new Uint8Array(32),v=new Float64Array(80),R=i(),st=i(),dt=i(),pt=i(),yt=i(),f=i();for(let C=0;C<31;C++)k[C]=U[C];k[31]=U[31]&127|64,k[0]&=248,l(v,$);for(let C=0;C<16;C++)st[C]=v[C];R[0]=pt[0]=1;for(let C=254;C>=0;--C){const O=k[C>>>3]>>>(C&7)&1;h(R,st,O),h(dt,pt,O),w(yt,R,dt),_(R,R,dt),w(dt,st,pt),_(st,st,pt),S(pt,yt),S(f,R),I(R,dt,R),I(dt,st,yt),w(yt,R,dt),_(R,R,dt),S(st,R),_(dt,pt,f),I(R,dt,a),w(R,R,pt),I(dt,dt,R),I(R,pt,f),I(pt,st,v),S(st,yt),h(R,st,O),h(dt,pt,O)}for(let C=0;C<16;C++)v[C+16]=R[C],v[C+32]=dt[C],v[C+48]=st[C],v[C+64]=pt[C];const y=v.subarray(32),b=v.subarray(16);M(y,y),I(b,b,y);const P=new Uint8Array(32);return d(P,b),P}r.scalarMult=G;function V(U){return G(U,s)}r.scalarMultBase=V;function Z(U){if(U.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const $=new Uint8Array(U);return{publicKey:V($),secretKey:$}}r.generateKeyPairFromSeed=Z;function H(U){const $=(0,t.randomBytes)(32,U),k=Z($);return(0,e.wipe)($),k}r.generateKeyPair=H;function W(U,$,k=!1){if(U.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if($.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const v=G(U,$);if(k){let R=0;for(let st=0;st<v.length;st++)R|=v[st];if(R===0)throw new Error("X25519: invalid shared key")}return v}r.sharedKey=W})(lf);var ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.getLocalStorage=ke.getLocalStorageOrThrow=ke.getCrypto=ke.getCryptoOrThrow=x1=ke.getLocation=ke.getLocationOrThrow=ff=ke.getNavigator=ke.getNavigatorOrThrow=Ru=ke.getDocument=ke.getDocumentOrThrow=ke.getFromWindowOrThrow=ke.getFromWindow=void 0;function ks(r){let t;return typeof window<"u"&&typeof window[r]<"u"&&(t=window[r]),t}ke.getFromWindow=ks;function So(r){const t=ks(r);if(!t)throw new Error(`${r} is not defined in Window`);return t}ke.getFromWindowOrThrow=So;function gA(){return So("document")}ke.getDocumentOrThrow=gA;function mA(){return ks("document")}var Ru=ke.getDocument=mA;function vA(){return So("navigator")}ke.getNavigatorOrThrow=vA;function yA(){return ks("navigator")}var ff=ke.getNavigator=yA;function wA(){return So("location")}ke.getLocationOrThrow=wA;function bA(){return ks("location")}var x1=ke.getLocation=bA;function _A(){return So("crypto")}ke.getCryptoOrThrow=_A;function EA(){return ks("crypto")}ke.getCrypto=EA;function AA(){return So("localStorage")}ke.getLocalStorageOrThrow=AA;function SA(){return ks("localStorage")}ke.getLocalStorage=SA;var df={};Object.defineProperty(df,"__esModule",{value:!0});var M1=df.getWindowMetadata=void 0;const n0=ke;function IA(){let r,t;try{r=n0.getDocumentOrThrow(),t=n0.getLocationOrThrow()}catch{return null}function e(){const _=r.getElementsByTagName("link"),I=[];for(let S=0;S<_.length;S++){const M=_[S],G=M.getAttribute("rel");if(G&&G.toLowerCase().indexOf("icon")>-1){const V=M.getAttribute("href");if(V)if(V.toLowerCase().indexOf("https:")===-1&&V.toLowerCase().indexOf("http:")===-1&&V.indexOf("//")!==0){let Z=t.protocol+"//"+t.host;if(V.indexOf("/")===0)Z+=V;else{const H=t.pathname.split("/");H.pop();const W=H.join("/");Z+=W+"/"+V}I.push(Z)}else if(V.indexOf("//")===0){const Z=t.protocol+V;I.push(Z)}else I.push(V)}}return I}function i(..._){const I=r.getElementsByTagName("meta");for(let S=0;S<I.length;S++){const M=I[S],G=["itemprop","property","name"].map(V=>M.getAttribute(V)).filter(V=>V?_.includes(V):!1);if(G.length&&G){const V=M.getAttribute("content");if(V)return V}}return""}function s(){let _=i("name","og:site_name","og:title","twitter:title");return _||(_=r.title),_}function a(){return i("description","og:description","twitter:description","keywords")}const u=s(),h=a(),d=t.origin,l=e();return{description:h,url:d,icons:l,name:u}}M1=df.getWindowMetadata=IA;var Ea={},DA=r=>encodeURIComponent(r).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),P1="%[a-f0-9]{2}",s0=new RegExp("("+P1+")|([^%]+?)","gi"),o0=new RegExp("("+P1+")+","gi");function $l(r,t){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;t=t||1;var e=r.slice(0,t),i=r.slice(t);return Array.prototype.concat.call([],$l(e),$l(i))}function xA(r){try{return decodeURIComponent(r)}catch{for(var t=r.match(s0)||[],e=1;e<t.length;e++)r=$l(t,e).join(""),t=r.match(s0)||[];return r}}function MA(r){for(var t={"%FE%FF":"","%FF%FE":""},e=o0.exec(r);e;){try{t[e[0]]=decodeURIComponent(e[0])}catch{var i=xA(e[0]);i!==e[0]&&(t[e[0]]=i)}e=o0.exec(r)}t["%C2"]="";for(var s=Object.keys(t),a=0;a<s.length;a++){var u=s[a];r=r.replace(new RegExp(u,"g"),t[u])}return r}var PA=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return MA(r)}},CA=(r,t)=>{if(!(typeof r=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[r];const e=r.indexOf(t);return e===-1?[r]:[r.slice(0,e),r.slice(e+t.length)]},OA=function(r,t){for(var e={},i=Object.keys(r),s=Array.isArray(t),a=0;a<i.length;a++){var u=i[a],h=r[u];(s?t.indexOf(u)!==-1:t(u,h,r))&&(e[u]=h)}return e};(function(r){const t=DA,e=PA,i=CA,s=OA,a=H=>H==null,u=Symbol("encodeFragmentIdentifier");function h(H){switch(H.arrayFormat){case"index":return W=>(U,$)=>{const k=U.length;return $===void 0||H.skipNull&&$===null||H.skipEmptyString&&$===""?U:$===null?[...U,[w(W,H),"[",k,"]"].join("")]:[...U,[w(W,H),"[",w(k,H),"]=",w($,H)].join("")]};case"bracket":return W=>(U,$)=>$===void 0||H.skipNull&&$===null||H.skipEmptyString&&$===""?U:$===null?[...U,[w(W,H),"[]"].join("")]:[...U,[w(W,H),"[]=",w($,H)].join("")];case"colon-list-separator":return W=>(U,$)=>$===void 0||H.skipNull&&$===null||H.skipEmptyString&&$===""?U:$===null?[...U,[w(W,H),":list="].join("")]:[...U,[w(W,H),":list=",w($,H)].join("")];case"comma":case"separator":case"bracket-separator":{const W=H.arrayFormat==="bracket-separator"?"[]=":"=";return U=>($,k)=>k===void 0||H.skipNull&&k===null||H.skipEmptyString&&k===""?$:(k=k===null?"":k,$.length===0?[[w(U,H),W,w(k,H)].join("")]:[[$,w(k,H)].join(H.arrayFormatSeparator)])}default:return W=>(U,$)=>$===void 0||H.skipNull&&$===null||H.skipEmptyString&&$===""?U:$===null?[...U,w(W,H)]:[...U,[w(W,H),"=",w($,H)].join("")]}}function d(H){let W;switch(H.arrayFormat){case"index":return(U,$,k)=>{if(W=/\[(\d*)\]$/.exec(U),U=U.replace(/\[\d*\]$/,""),!W){k[U]=$;return}k[U]===void 0&&(k[U]={}),k[U][W[1]]=$};case"bracket":return(U,$,k)=>{if(W=/(\[\])$/.exec(U),U=U.replace(/\[\]$/,""),!W){k[U]=$;return}if(k[U]===void 0){k[U]=[$];return}k[U]=[].concat(k[U],$)};case"colon-list-separator":return(U,$,k)=>{if(W=/(:list)$/.exec(U),U=U.replace(/:list$/,""),!W){k[U]=$;return}if(k[U]===void 0){k[U]=[$];return}k[U]=[].concat(k[U],$)};case"comma":case"separator":return(U,$,k)=>{const v=typeof $=="string"&&$.includes(H.arrayFormatSeparator),R=typeof $=="string"&&!v&&_($,H).includes(H.arrayFormatSeparator);$=R?_($,H):$;const st=v||R?$.split(H.arrayFormatSeparator).map(dt=>_(dt,H)):$===null?$:_($,H);k[U]=st};case"bracket-separator":return(U,$,k)=>{const v=/(\[\])$/.test(U);if(U=U.replace(/\[\]$/,""),!v){k[U]=$&&_($,H);return}const R=$===null?[]:$.split(H.arrayFormatSeparator).map(st=>_(st,H));if(k[U]===void 0){k[U]=R;return}k[U]=[].concat(k[U],R)};default:return(U,$,k)=>{if(k[U]===void 0){k[U]=$;return}k[U]=[].concat(k[U],$)}}}function l(H){if(typeof H!="string"||H.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(H,W){return W.encode?W.strict?t(H):encodeURIComponent(H):H}function _(H,W){return W.decode?e(H):H}function I(H){return Array.isArray(H)?H.sort():typeof H=="object"?I(Object.keys(H)).sort((W,U)=>Number(W)-Number(U)).map(W=>H[W]):H}function S(H){const W=H.indexOf("#");return W!==-1&&(H=H.slice(0,W)),H}function M(H){let W="";const U=H.indexOf("#");return U!==-1&&(W=H.slice(U)),W}function G(H){H=S(H);const W=H.indexOf("?");return W===-1?"":H.slice(W+1)}function V(H,W){return W.parseNumbers&&!Number.isNaN(Number(H))&&typeof H=="string"&&H.trim()!==""?H=Number(H):W.parseBooleans&&H!==null&&(H.toLowerCase()==="true"||H.toLowerCase()==="false")&&(H=H.toLowerCase()==="true"),H}function Z(H,W){W=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},W),l(W.arrayFormatSeparator);const U=d(W),$=Object.create(null);if(typeof H!="string"||(H=H.trim().replace(/^[?#&]/,""),!H))return $;for(const k of H.split("&")){if(k==="")continue;let[v,R]=i(W.decode?k.replace(/\+/g," "):k,"=");R=R===void 0?null:["comma","separator","bracket-separator"].includes(W.arrayFormat)?R:_(R,W),U(_(v,W),R,$)}for(const k of Object.keys($)){const v=$[k];if(typeof v=="object"&&v!==null)for(const R of Object.keys(v))v[R]=V(v[R],W);else $[k]=V(v,W)}return W.sort===!1?$:(W.sort===!0?Object.keys($).sort():Object.keys($).sort(W.sort)).reduce((k,v)=>{const R=$[v];return R&&typeof R=="object"&&!Array.isArray(R)?k[v]=I(R):k[v]=R,k},Object.create(null))}r.extract=G,r.parse=Z,r.stringify=(H,W)=>{if(!H)return"";W=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},W),l(W.arrayFormatSeparator);const U=R=>W.skipNull&&a(H[R])||W.skipEmptyString&&H[R]==="",$=h(W),k={};for(const R of Object.keys(H))U(R)||(k[R]=H[R]);const v=Object.keys(k);return W.sort!==!1&&v.sort(W.sort),v.map(R=>{const st=H[R];return st===void 0?"":st===null?w(R,W):Array.isArray(st)?st.length===0&&W.arrayFormat==="bracket-separator"?w(R,W)+"[]":st.reduce($(R),[]).join("&"):w(R,W)+"="+w(st,W)}).filter(R=>R.length>0).join("&")},r.parseUrl=(H,W)=>{W=Object.assign({decode:!0},W);const[U,$]=i(H,"#");return Object.assign({url:U.split("?")[0]||"",query:Z(G(H),W)},W&&W.parseFragmentIdentifier&&$?{fragmentIdentifier:_($,W)}:{})},r.stringifyUrl=(H,W)=>{W=Object.assign({encode:!0,strict:!0,[u]:!0},W);const U=S(H.url).split("?")[0]||"",$=r.extract(H.url),k=r.parse($,{sort:!1}),v=Object.assign(k,H.query);let R=r.stringify(v,W);R&&(R=`?${R}`);let st=M(H.url);return H.fragmentIdentifier&&(st=`#${W[u]?w(H.fragmentIdentifier,W):H.fragmentIdentifier}`),`${U}${R}${st}`},r.pick=(H,W,U)=>{U=Object.assign({parseFragmentIdentifier:!0,[u]:!1},U);const{url:$,query:k,fragmentIdentifier:v}=r.parseUrl(H,U);return r.stringifyUrl({url:$,query:s(k,W),fragmentIdentifier:v},U)},r.exclude=(H,W,U)=>{const $=Array.isArray(W)?k=>!W.includes(k):(k,v)=>!W(k,v);return r.pick(H,$,U)}})(Ea);const NA={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},TA="PARSE_ERROR",RA="INVALID_REQUEST",FA="METHOD_NOT_FOUND",UA="INVALID_PARAMS",C1="INTERNAL_ERROR",pf="SERVER_ERROR",LA=[-32700,-32600,-32601,-32602,-32603],da={[TA]:{code:-32700,message:"Parse error"},[RA]:{code:-32600,message:"Invalid Request"},[FA]:{code:-32601,message:"Method not found"},[UA]:{code:-32602,message:"Invalid params"},[C1]:{code:-32603,message:"Internal error"},[pf]:{code:-32e3,message:"Server error"}},O1=pf;function BA(r){return LA.includes(r)}function a0(r){return Object.keys(da).includes(r)?da[r]:da[O1]}function qA(r){const t=Object.values(da).find(e=>e.code===r);return t||da[O1]}function N1(r,t,e){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${e} RPC url at ${t}`):r}var T1={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kl=function(r,t){return kl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])},kl(r,t)};function jA(r,t){kl(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var zl=function(){return zl=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++){e=arguments[i];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},zl.apply(this,arguments)};function $A(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(r);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(r,i[s])&&(e[i[s]]=r[i[s]]);return e}function kA(r,t,e,i){var s=arguments.length,a=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,i);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a}function zA(r,t){return function(e,i){t(e,i,r)}}function HA(r,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,t)}function KA(r,t,e,i){function s(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function h(w){try{l(i.next(w))}catch(_){u(_)}}function d(w){try{l(i.throw(w))}catch(_){u(_)}}function l(w){w.done?a(w.value):s(w.value).then(h,d)}l((i=i.apply(r,t||[])).next())})}function VA(r,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,s,a,u;return u={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(l){return function(w){return d([l,w])}}function d(l){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,s&&(a=l[0]&2?s.return:l[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,l[1])).done)return a;switch(s=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,s=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=t.call(r,e)}catch(w){l=[6,w],s=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function GA(r,t,e,i){i===void 0&&(i=e),r[i]=t[e]}function WA(r,t){for(var e in r)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=r[e])}function Hl(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],i=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function R1(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var i=e.call(r),s,a=[],u;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(h){u={error:h}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(u)throw u.error}}return a}function YA(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(R1(arguments[t]));return r}function JA(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var i=Array(r),s=0,t=0;t<e;t++)for(var a=arguments[t],u=0,h=a.length;u<h;u++,s++)i[s]=a[u];return i}function Aa(r){return this instanceof Aa?(this.v=r,this):new Aa(r)}function QA(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(r,t||[]),s,a=[];return s={},u("next"),u("throw"),u("return"),s[Symbol.asyncIterator]=function(){return this},s;function u(I){i[I]&&(s[I]=function(S){return new Promise(function(M,G){a.push([I,S,M,G])>1||h(I,S)})})}function h(I,S){try{d(i[I](S))}catch(M){_(a[0][3],M)}}function d(I){I.value instanceof Aa?Promise.resolve(I.value.v).then(l,w):_(a[0][2],I)}function l(I){h("next",I)}function w(I){h("throw",I)}function _(I,S){I(S),a.shift(),a.length&&h(a[0][0],a[0][1])}}function XA(r){var t,e;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,a){t[s]=r[s]?function(u){return(e=!e)?{value:Aa(r[s](u)),done:s==="return"}:a?a(u):u}:a}}function ZA(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r[Symbol.asyncIterator],e;return t?t.call(r):(r=typeof Hl=="function"?Hl(r):r[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(a){e[a]=r[a]&&function(u){return new Promise(function(h,d){u=r[a](u),s(h,d,u.done,u.value)})}}function s(a,u,h,d){Promise.resolve(d).then(function(l){a({value:l,done:h})},u)}}function t8(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r}function e8(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)Object.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}function r8(r){return r&&r.__esModule?r:{default:r}}function i8(r,t){if(!t.has(r))throw new TypeError("attempted to get private field on non-instance");return t.get(r)}function n8(r,t,e){if(!t.has(r))throw new TypeError("attempted to set private field on non-instance");return t.set(r,e),e}const s8=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return zl},__asyncDelegator:XA,__asyncGenerator:QA,__asyncValues:ZA,__await:Aa,__awaiter:KA,__classPrivateFieldGet:i8,__classPrivateFieldSet:n8,__createBinding:GA,__decorate:kA,__exportStar:WA,__extends:jA,__generator:VA,__importDefault:r8,__importStar:e8,__makeTemplateObject:t8,__metadata:HA,__param:zA,__read:R1,__rest:$A,__spread:YA,__spreadArrays:JA,__values:Hl},Symbol.toStringTag,{value:"Module"})),o8=Xg(s8);var Cn={},c0;function a8(){if(c0)return Cn;c0=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.isBrowserCryptoAvailable=Cn.getSubtleCrypto=Cn.getBrowerCrypto=void 0;function r(){return(an===null||an===void 0?void 0:an.crypto)||(an===null||an===void 0?void 0:an.msCrypto)||{}}Cn.getBrowerCrypto=r;function t(){const i=r();return i.subtle||i.webkitSubtle}Cn.getSubtleCrypto=t;function e(){return!!r()&&!!t()}return Cn.isBrowserCryptoAvailable=e,Cn}var On={},u0;function c8(){if(u0)return On;u0=1,Object.defineProperty(On,"__esModule",{value:!0}),On.isBrowser=On.isNode=On.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}On.isReactNative=r;function t(){return typeof hn<"u"&&typeof hn.versions<"u"&&typeof hn.versions.node<"u"}On.isNode=t;function e(){return!r()&&!t()}return On.isBrowser=e,On}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const t=o8;t.__exportStar(a8(),r),t.__exportStar(c8(),r)})(T1);function Zn(r=3){const t=Date.now()*Math.pow(10,r),e=Math.floor(Math.random()*Math.pow(10,r));return t+e}function Rs(r=6){return BigInt(Zn(r))}function ns(r,t,e){return{id:e||Zn(),jsonrpc:"2.0",method:r,params:t}}function Fu(r,t){return{id:r,jsonrpc:"2.0",result:t}}function Uu(r,t,e){return{id:r,jsonrpc:"2.0",error:u8(t)}}function u8(r,t){return typeof r>"u"?a0(C1):(typeof r=="string"&&(r=Object.assign(Object.assign({},a0(pf)),{message:r})),BA(r.code)&&(r=qA(r.code)),r)}class h8{}let l8=class extends h8{constructor(){super()}},f8=class extends l8{constructor(t){super()}};const d8="^https?:",p8="^wss?:";function g8(r){const t=r.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function F1(r,t){const e=g8(r);return typeof e>"u"?!1:new RegExp(t).test(e)}function h0(r){return F1(r,d8)}function l0(r){return F1(r,p8)}function m8(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function U1(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function gf(r){return U1(r)&&"method"in r}function Lu(r){return U1(r)&&(rn(r)||Ii(r))}function rn(r){return"result"in r}function Ii(r){return"error"in r}var mu={exports:{}};mu.exports;(function(r,t){var e=200,i="__lodash_hash_undefined__",s=1,a=2,u=9007199254740991,h="[object Arguments]",d="[object Array]",l="[object AsyncFunction]",w="[object Boolean]",_="[object Date]",I="[object Error]",S="[object Function]",M="[object GeneratorFunction]",G="[object Map]",V="[object Number]",Z="[object Null]",H="[object Object]",W="[object Promise]",U="[object Proxy]",$="[object RegExp]",k="[object Set]",v="[object String]",R="[object Symbol]",st="[object Undefined]",dt="[object WeakMap]",pt="[object ArrayBuffer]",yt="[object DataView]",f="[object Float32Array]",y="[object Float64Array]",b="[object Int8Array]",P="[object Int16Array]",C="[object Int32Array]",O="[object Uint8Array]",B="[object Uint8ClampedArray]",D="[object Uint16Array]",g="[object Uint32Array]",T=/[\\^$.*+?()[\]{}|]/g,rt=/^\[object .+?Constructor\]$/,lt=/^(?:0|[1-9]\d*)$/,E={};E[f]=E[y]=E[b]=E[P]=E[C]=E[O]=E[B]=E[D]=E[g]=!0,E[h]=E[d]=E[pt]=E[w]=E[yt]=E[_]=E[I]=E[S]=E[G]=E[V]=E[H]=E[$]=E[k]=E[v]=E[dt]=!1;var tt=typeof an=="object"&&an&&an.Object===Object&&an,L=typeof self=="object"&&self&&self.Object===Object&&self,q=tt||L||Function("return this")(),z=t&&!t.nodeType&&t,p=z&&!0&&r&&!r.nodeType&&r,F=p&&p.exports===z,et=F&&tt.process,ot=function(){try{return et&&et.binding&&et.binding("util")}catch{}}(),at=ot&&ot.isTypedArray;function Mt(j,J){for(var ht=-1,St=j==null?0:j.length,Be=0,re=[];++ht<St;){var He=j[ht];J(He,ht,j)&&(re[Be++]=He)}return re}function Ct(j,J){for(var ht=-1,St=J.length,Be=j.length;++ht<St;)j[Be+ht]=J[ht];return j}function It(j,J){for(var ht=-1,St=j==null?0:j.length;++ht<St;)if(J(j[ht],ht,j))return!0;return!1}function Ae(j,J){for(var ht=-1,St=Array(j);++ht<j;)St[ht]=J(ht);return St}function $t(j){return function(J){return j(J)}}function xt(j,J){return j.has(J)}function Lt(j,J){return j==null?void 0:j[J]}function _t(j){var J=-1,ht=Array(j.size);return j.forEach(function(St,Be){ht[++J]=[Be,St]}),ht}function Et(j,J){return function(ht){return j(J(ht))}}function Vt(j){var J=-1,ht=Array(j.size);return j.forEach(function(St){ht[++J]=St}),ht}var wt=Array.prototype,At=Function.prototype,Ut=Object.prototype,bt=q["__core-js_shared__"],Pt=At.toString,Bt=Ut.hasOwnProperty,Ot=function(){var j=/[^.]+$/.exec(bt&&bt.keys&&bt.keys.IE_PROTO||"");return j?"Symbol(src)_1."+j:""}(),Nt=Ut.toString,se=RegExp("^"+Pt.call(Bt).replace(T,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rt=F?q.Buffer:void 0,Tt=q.Symbol,We=q.Uint8Array,ue=Ut.propertyIsEnumerable,ge=wt.splice,Ye=Tt?Tt.toStringTag:void 0,we=Object.getOwnPropertySymbols,Ee=Rt?Rt.isBuffer:void 0,Mr=Et(Object.keys,Object),Gt=Qr(q,"DataView"),kt=Qr(q,"Map"),De=Qr(q,"Promise"),Wt=Qr(q,"Set"),Kt=Qr(q,"WeakMap"),Se=Qr(Object,"create"),Qt=bn(Gt),Xt=bn(kt),xe=bn(De),Zt=bn(Wt),Yt=bn(Kt),Ce=Tt?Tt.prototype:void 0,Jt=Ce?Ce.valueOf:void 0;function qt(j){var J=-1,ht=j==null?0:j.length;for(this.clear();++J<ht;){var St=j[J];this.set(St[0],St[1])}}function Fe(){this.__data__=Se?Se(null):{},this.size=0}function te(j){var J=this.has(j)&&delete this.__data__[j];return this.size-=J?1:0,J}function Oe(j){var J=this.__data__;if(Se){var ht=J[j];return ht===i?void 0:ht}return Bt.call(J,j)?J[j]:void 0}function Pi(j){var J=this.__data__;return Se?J[j]!==void 0:Bt.call(J,j)}function Ne(j,J){var ht=this.__data__;return this.size+=this.has(j)?0:1,ht[j]=Se&&J===void 0?i:J,this}qt.prototype.clear=Fe,qt.prototype.delete=te,qt.prototype.get=Oe,qt.prototype.has=Pi,qt.prototype.set=Ne;function fe(j){var J=-1,ht=j==null?0:j.length;for(this.clear();++J<ht;){var St=j[J];this.set(St[0],St[1])}}function ai(){this.__data__=[],this.size=0}function ci(j){var J=this.__data__,ht=gs(J,j);if(ht<0)return!1;var St=J.length-1;return ht==St?J.pop():ge.call(J,ht,1),--this.size,!0}function ui(j){var J=this.__data__,ht=gs(J,j);return ht<0?void 0:J[ht][1]}function hi(j){return gs(this.__data__,j)>-1}function li(j,J){var ht=this.__data__,St=gs(ht,j);return St<0?(++this.size,ht.push([j,J])):ht[St][1]=J,this}fe.prototype.clear=ai,fe.prototype.delete=ci,fe.prototype.get=ui,fe.prototype.has=hi,fe.prototype.set=li;function lr(j){var J=-1,ht=j==null?0:j.length;for(this.clear();++J<ht;){var St=j[J];this.set(St[0],St[1])}}function Ki(){this.size=0,this.__data__={hash:new qt,map:new(kt||fe),string:new qt}}function cs(j){var J=kn(this,j).delete(j);return this.size-=J?1:0,J}function Vi(j){return kn(this,j).get(j)}function us(j){return kn(this,j).has(j)}function hs(j,J){var ht=kn(this,j),St=ht.size;return ht.set(j,J),this.size+=ht.size==St?0:1,this}lr.prototype.clear=Ki,lr.prototype.delete=cs,lr.prototype.get=Vi,lr.prototype.has=us,lr.prototype.set=hs;function Gi(j){var J=-1,ht=j==null?0:j.length;for(this.__data__=new lr;++J<ht;)this.add(j[J])}function jn(j){return this.__data__.set(j,i),this}function $n(j){return this.__data__.has(j)}Gi.prototype.add=Gi.prototype.push=jn,Gi.prototype.has=$n;function Pr(j){var J=this.__data__=new fe(j);this.size=J.size}function ls(){this.__data__=new fe,this.size=0}function fs(j){var J=this.__data__,ht=J.delete(j);return this.size=J.size,ht}function ds(j){return this.__data__.get(j)}function ps(j){return this.__data__.has(j)}function ja(j,J){var ht=this.__data__;if(ht instanceof fe){var St=ht.__data__;if(!kt||St.length<e-1)return St.push([j,J]),this.size=++ht.size,this;ht=this.__data__=new lr(St)}return ht.set(j,J),this.size=ht.size,this}Pr.prototype.clear=ls,Pr.prototype.delete=fs,Pr.prototype.get=ds,Pr.prototype.has=ps,Pr.prototype.set=ja;function $a(j,J){var ht=Ys(j),St=!ht&&Za(j),Be=!ht&&!St&&Fo(j),re=!ht&&!St&&!Be&&rc(j),He=ht||St||Be||re,sr=He?Ae(j.length,String):[],be=sr.length;for(var qe in j)Bt.call(j,qe)&&!(He&&(qe=="length"||Be&&(qe=="offset"||qe=="parent")||re&&(qe=="buffer"||qe=="byteLength"||qe=="byteOffset")||Wa(qe,be)))&&sr.push(qe);return sr}function gs(j,J){for(var ht=j.length;ht--;)if(Xa(j[ht][0],J))return ht;return-1}function To(j,J,ht){var St=J(j);return Ys(j)?St:Ct(St,ht(j))}function ms(j){return j==null?j===void 0?st:Z:Ye&&Ye in Object(j)?Va(j):zu(j)}function Ro(j){return ys(j)&&ms(j)==h}function vs(j,J,ht,St,Be){return j===J?!0:j==null||J==null||!ys(j)&&!ys(J)?j!==j&&J!==J:ka(j,J,ht,St,vs,Be)}function ka(j,J,ht,St,Be,re){var He=Ys(j),sr=Ys(J),be=He?d:Wi(j),qe=sr?d:Wi(J);be=be==h?H:be,qe=qe==h?H:qe;var tr=be==H,qr=qe==H,or=be==qe;if(or&&Fo(j)){if(!Fo(J))return!1;He=!0,tr=!1}if(or&&!tr)return re||(re=new Pr),He||rc(j)?Gs(j,J,ht,St,Be,re):ku(j,J,be,ht,St,Be,re);if(!(ht&s)){var Ke=tr&&Bt.call(j,"__wrapped__"),Cr=qr&&Bt.call(J,"__wrapped__");if(Ke||Cr){var Ci=Ke?j.value():j,fi=Cr?J.value():J;return re||(re=new Pr),Be(Ci,fi,ht,St,re)}}return or?(re||(re=new Pr),Ka(j,J,ht,St,Be,re)):!1}function $u(j){if(!ec(j)||Ja(j))return!1;var J=Js(j)?se:rt;return J.test(bn(j))}function za(j){return ys(j)&&tc(j.length)&&!!E[ms(j)]}function Ha(j){if(!Qa(j))return Mr(j);var J=[];for(var ht in Object(j))Bt.call(j,ht)&&ht!="constructor"&&J.push(ht);return J}function Gs(j,J,ht,St,Be,re){var He=ht&s,sr=j.length,be=J.length;if(sr!=be&&!(He&&be>sr))return!1;var qe=re.get(j);if(qe&&re.get(J))return qe==J;var tr=-1,qr=!0,or=ht&a?new Gi:void 0;for(re.set(j,J),re.set(J,j);++tr<sr;){var Ke=j[tr],Cr=J[tr];if(St)var Ci=He?St(Cr,Ke,tr,J,j,re):St(Ke,Cr,tr,j,J,re);if(Ci!==void 0){if(Ci)continue;qr=!1;break}if(or){if(!It(J,function(fi,Yi){if(!xt(or,Yi)&&(Ke===fi||Be(Ke,fi,ht,St,re)))return or.push(Yi)})){qr=!1;break}}else if(!(Ke===Cr||Be(Ke,Cr,ht,St,re))){qr=!1;break}}return re.delete(j),re.delete(J),qr}function ku(j,J,ht,St,Be,re,He){switch(ht){case yt:if(j.byteLength!=J.byteLength||j.byteOffset!=J.byteOffset)return!1;j=j.buffer,J=J.buffer;case pt:return!(j.byteLength!=J.byteLength||!re(new We(j),new We(J)));case w:case _:case V:return Xa(+j,+J);case I:return j.name==J.name&&j.message==J.message;case $:case v:return j==J+"";case G:var sr=_t;case k:var be=St&s;if(sr||(sr=Vt),j.size!=J.size&&!be)return!1;var qe=He.get(j);if(qe)return qe==J;St|=a,He.set(j,J);var tr=Gs(sr(j),sr(J),St,Be,re,He);return He.delete(j),tr;case R:if(Jt)return Jt.call(j)==Jt.call(J)}return!1}function Ka(j,J,ht,St,Be,re){var He=ht&s,sr=Ws(j),be=sr.length,qe=Ws(J),tr=qe.length;if(be!=tr&&!He)return!1;for(var qr=be;qr--;){var or=sr[qr];if(!(He?or in J:Bt.call(J,or)))return!1}var Ke=re.get(j);if(Ke&&re.get(J))return Ke==J;var Cr=!0;re.set(j,J),re.set(J,j);for(var Ci=He;++qr<be;){or=sr[qr];var fi=j[or],Yi=J[or];if(St)var Uo=He?St(Yi,fi,or,J,j,re):St(fi,Yi,or,j,J,re);if(!(Uo===void 0?fi===Yi||Be(fi,Yi,ht,St,re):Uo)){Cr=!1;break}Ci||(Ci=or=="constructor")}if(Cr&&!Ci){var ws=j.constructor,fr=J.constructor;ws!=fr&&"constructor"in j&&"constructor"in J&&!(typeof ws=="function"&&ws instanceof ws&&typeof fr=="function"&&fr instanceof fr)&&(Cr=!1)}return re.delete(j),re.delete(J),Cr}function Ws(j){return To(j,Vu,Ga)}function kn(j,J){var ht=j.__data__;return Ya(J)?ht[typeof J=="string"?"string":"hash"]:ht.map}function Qr(j,J){var ht=Lt(j,J);return $u(ht)?ht:void 0}function Va(j){var J=Bt.call(j,Ye),ht=j[Ye];try{j[Ye]=void 0;var St=!0}catch{}var Be=Nt.call(j);return St&&(J?j[Ye]=ht:delete j[Ye]),Be}var Ga=we?function(j){return j==null?[]:(j=Object(j),Mt(we(j),function(J){return ue.call(j,J)}))}:Le,Wi=ms;(Gt&&Wi(new Gt(new ArrayBuffer(1)))!=yt||kt&&Wi(new kt)!=G||De&&Wi(De.resolve())!=W||Wt&&Wi(new Wt)!=k||Kt&&Wi(new Kt)!=dt)&&(Wi=function(j){var J=ms(j),ht=J==H?j.constructor:void 0,St=ht?bn(ht):"";if(St)switch(St){case Qt:return yt;case Xt:return G;case xe:return W;case Zt:return k;case Yt:return dt}return J});function Wa(j,J){return J=J??u,!!J&&(typeof j=="number"||lt.test(j))&&j>-1&&j%1==0&&j<J}function Ya(j){var J=typeof j;return J=="string"||J=="number"||J=="symbol"||J=="boolean"?j!=="__proto__":j===null}function Ja(j){return!!Ot&&Ot in j}function Qa(j){var J=j&&j.constructor,ht=typeof J=="function"&&J.prototype||Ut;return j===ht}function zu(j){return Nt.call(j)}function bn(j){if(j!=null){try{return Pt.call(j)}catch{}try{return j+""}catch{}}return""}function Xa(j,J){return j===J||j!==j&&J!==J}var Za=Ro(function(){return arguments}())?Ro:function(j){return ys(j)&&Bt.call(j,"callee")&&!ue.call(j,"callee")},Ys=Array.isArray;function Hu(j){return j!=null&&tc(j.length)&&!Js(j)}var Fo=Ee||Ue;function Ku(j,J){return vs(j,J)}function Js(j){if(!ec(j))return!1;var J=ms(j);return J==S||J==M||J==l||J==U}function tc(j){return typeof j=="number"&&j>-1&&j%1==0&&j<=u}function ec(j){var J=typeof j;return j!=null&&(J=="object"||J=="function")}function ys(j){return j!=null&&typeof j=="object"}var rc=at?$t(at):za;function Vu(j){return Hu(j)?$a(j):Ha(j)}function Le(){return[]}function Ue(){return!1}r.exports=Ku})(mu,mu.exports);var v8=mu.exports;const y8=Zg(v8);var w8={};const b8=":";function pa(r){const[t,e]=r.split(b8);return{namespace:t,reference:e}}function f0(r,t=[]){const e=[];return Object.keys(r).forEach(i=>{if(t.length&&!t.includes(i))return;const s=r[i];e.push(...s.accounts)}),e}function L1(r,t){return r.includes(":")?[r]:t.chains||[]}var _8=Object.defineProperty,d0=Object.getOwnPropertySymbols,E8=Object.prototype.hasOwnProperty,A8=Object.prototype.propertyIsEnumerable,p0=(r,t,e)=>t in r?_8(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,g0=(r,t)=>{for(var e in t||(t={}))E8.call(t,e)&&p0(r,e,t[e]);if(d0)for(var e of d0(t))A8.call(t,e)&&p0(r,e,t[e]);return r};const S8="ReactNative",ii={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},I8="js";function vu(){return typeof hn<"u"&&typeof hn.versions<"u"&&typeof hn.versions.node<"u"}function Io(){return!Ru()&&!!ff()&&navigator.product===S8}function Ra(){return!vu()&&!!ff()&&!!Ru()}function Fa(){return Io()?ii.reactNative:vu()?ii.node:Ra()?ii.browser:ii.unknown}function D8(){var r;try{return Io()&&typeof oe<"u"&&typeof(oe==null?void 0:oe.Application)<"u"?(r=oe.Application)==null?void 0:r.applicationId:void 0}catch{return}}function x8(r,t){let e=Ea.parse(r);return e=g0(g0({},e),t),r=Ea.stringify(e),r}function B1(){return M1()||{name:"",description:"",url:"",icons:[""]}}function M8(){if(Fa()===ii.reactNative&&typeof oe<"u"&&typeof(oe==null?void 0:oe.Platform)<"u"){const{OS:e,Version:i}=oe.Platform;return[e,i].join("-")}const r=U3();if(r===null)return"unknown";const t=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[t,r.name,r.version].join("-"):[t,r.version].join("-")}function P8(){var r;const t=Fa();return t===ii.browser?[t,((r=x1())==null?void 0:r.host)||"unknown"].join(":"):t}function q1(r,t,e){const i=M8(),s=P8();return[[r,t].join("-"),[I8,e].join("-"),i,s].join("/")}function C8({protocol:r,version:t,relayUrl:e,sdkVersion:i,auth:s,projectId:a,useOnCloseEvent:u,bundleId:h}){const d=e.split("?"),l=q1(r,t,i),w={auth:s,ua:l,projectId:a,useOnCloseEvent:u||void 0,origin:h||void 0},_=x8(d[1]||"",w);return d[0]+"?"+_}function Fs(r,t){return r.filter(e=>t.includes(e)).length===r.length}function j1(r){return Object.fromEntries(r.entries())}function $1(r){return new Map(Object.entries(r))}function Ns(r=mt.FIVE_MINUTES,t){const e=mt.toMiliseconds(r||mt.FIVE_MINUTES);let i,s,a;return{resolve:u=>{a&&i&&(clearTimeout(a),i(u))},reject:u=>{a&&s&&(clearTimeout(a),s(u))},done:()=>new Promise((u,h)=>{a=setTimeout(()=>{h(new Error(t))},e),i=u,s=h})}}function wo(r,t,e){return new Promise(async(i,s)=>{const a=setTimeout(()=>s(new Error(e)),t);try{const u=await r;i(u)}catch(u){s(u)}clearTimeout(a)})}function k1(r,t){if(typeof t=="string"&&t.startsWith(`${r}:`))return t;if(r.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(r.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${r}`)}function O8(r){return k1("topic",r)}function N8(r){return k1("id",r)}function z1(r){const[t,e]=r.split(":"),i={id:void 0,topic:void 0};if(t==="topic"&&typeof e=="string")i.topic=e;else if(t==="id"&&Number.isInteger(Number(e)))i.id=Number(e);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${e}`);return i}function hr(r,t){return mt.fromMiliseconds(Date.now()+mt.toMiliseconds(r))}function ts(r){return Date.now()>=mt.toMiliseconds(r)}function pe(r,t){return`${r}${t?`:${t}`:""}`}function iu(r=[],t=[]){return[...new Set([...r,...t])]}async function T8({id:r,topic:t,wcDeepLink:e}){var i;try{if(!e)return;const s=typeof e=="string"?JSON.parse(e):e,a=s==null?void 0:s.href;if(typeof a!="string")return;const u=R8(a,r,t),h=Fa();if(h===ii.browser){if(!((i=Ru())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}u.startsWith("https://")||u.startsWith("http://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,U8()?"_blank":"_self","noreferrer noopener")}else h===ii.reactNative&&typeof(oe==null?void 0:oe.Linking)<"u"&&await oe.Linking.openURL(u)}catch(s){console.error(s)}}function R8(r,t,e){const i=`requestId=${t}&sessionTopic=${e}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const a=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${a}${L8(i,!0)}`}else s=`${s}/wc?${i}`;return s}async function F8(r,t){let e="";try{if(Ra()&&(e=localStorage.getItem(t),e))return e;e=await r.getItem(t)}catch(i){console.error(i)}return e}function m0(r,t){if(!r.includes(t))return null;const e=r.split(/([&,?,=])/),i=e.indexOf(t);return e[i+2]}function v0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const t=Math.random()*16|0;return(r==="x"?t:t&3|8).toString(16)})}function mf(){return typeof hn<"u"&&w8.IS_VITEST==="true"}function U8(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function L8(r,t=!1){const e=xi.from(r).toString("base64");return t?e.replace(/[=]/g,""):e}function H1(r){return xi.from(r,"base64").toString("utf-8")}var K1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof oe<"u"?oe:typeof self<"u"?self:{};function B8(r){var t=r.default;if(typeof t=="function"){var e=function(){return t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),e}var V1={exports:{}};/**
* [js-sha3]{@link https://github.com/emn178/js-sha3}
*
* @version 0.8.0
* @author Chen, Yi-Cyuan [emn178@gmail.com]
* @copyright Chen, Yi-Cyuan 2015-2018
* @license MIT
*/(function(r){(function(){var t="input is invalid type",e="finalize already called",i=typeof window=="object",s=i?window:{};s.JS_SHA3_NO_WINDOW&&(i=!1);var a=!i&&typeof self=="object",u=!s.JS_SHA3_NO_NODE_JS&&typeof hn=="object"&&hn.versions&&hn.versions.node;u?s=K1:a&&(s=self);var h=!s.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,d=!s.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),w=[31,7936,2031616,520093696],_=[4,1024,262144,67108864],I=[1,256,65536,16777216],S=[6,1536,393216,100663296],M=[0,8,16,24],G=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],V=[224,256,384,512],Z=[128,256],H=["hex","buffer","arrayBuffer","array","digest"],W={128:168,256:136};(s.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(E){return Object.prototype.toString.call(E)==="[object Array]"}),d&&(s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(E){return typeof E=="object"&&E.buffer&&E.buffer.constructor===ArrayBuffer});for(var U=function(E,tt,L){return function(q){return new T(E,tt,E).update(q)[L]()}},$=function(E,tt,L){return function(q,z){return new T(E,tt,z).update(q)[L]()}},k=function(E,tt,L){return function(q,z,p,F){return y["cshake"+E].update(q,z,p,F)[L]()}},v=function(E,tt,L){return function(q,z,p,F){return y["kmac"+E].update(q,z,p,F)[L]()}},R=function(E,tt,L,q){for(var z=0;z<H.length;++z){var p=H[z];E[p]=tt(L,q,p)}return E},st=function(E,tt){var L=U(E,tt,"hex");return L.create=function(){return new T(E,tt,E)},L.update=function(q){return L.create().update(q)},R(L,U,E,tt)},dt=function(E,tt){var L=$(E,tt,"hex");return L.create=function(q){return new T(E,tt,q)},L.update=function(q,z){return L.create(z).update(q)},R(L,$,E,tt)},pt=function(E,tt){var L=W[E],q=k(E,tt,"hex");return q.create=function(z,p,F){return!p&&!F?y["shake"+E].create(z):new T(E,tt,z).bytepad([p,F],L)},q.update=function(z,p,F,et){return q.create(p,F,et).update(z)},R(q,k,E,tt)},yt=function(E,tt){var L=W[E],q=v(E,tt,"hex");return q.create=function(z,p,F){return new rt(E,tt,p).bytepad(["KMAC",F],L).bytepad([z],L)},q.update=function(z,p,F,et){return q.create(z,F,et).update(p)},R(q,v,E,tt)},f=[{name:"keccak",padding:I,bits:V,createMethod:st},{name:"sha3",padding:S,bits:V,createMethod:st},{name:"shake",padding:w,bits:Z,createMethod:dt},{name:"cshake",padding:_,bits:Z,createMethod:pt},{name:"kmac",padding:_,bits:Z,createMethod:yt}],y={},b=[],P=0;P<f.length;++P)for(var C=f[P],O=C.bits,B=0;B<O.length;++B){var D=C.name+"_"+O[B];if(b.push(D),y[D]=C.createMethod(O[B],C.padding),C.name!=="sha3"){var g=C.name+O[B];b.push(g),y[g]=y[D]}}function T(E,tt,L){this.blocks=[],this.s=[],this.padding=tt,this.outputBits=L,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(E<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=L>>5,this.extraBytes=(L&31)>>3;for(var q=0;q<50;++q)this.s[q]=0}T.prototype.update=function(E){if(this.finalized)throw new Error(e);var tt,L=typeof E;if(L!=="string"){if(L==="object"){if(E===null)throw new Error(t);if(d&&E.constructor===ArrayBuffer)E=new Uint8Array(E);else if(!Array.isArray(E)&&(!d||!ArrayBuffer.isView(E)))throw new Error(t)}else throw new Error(t);tt=!0}for(var q=this.blocks,z=this.byteCount,p=E.length,F=this.blockCount,et=0,ot=this.s,at,Mt;et<p;){if(this.reset)for(this.reset=!1,q[0]=this.block,at=1;at<F+1;++at)q[at]=0;if(tt)for(at=this.start;et<p&&at<z;++et)q[at>>2]|=E[et]<<M[at++&3];else for(at=this.start;et<p&&at<z;++et)Mt=E.charCodeAt(et),Mt<128?q[at>>2]|=Mt<<M[at++&3]:Mt<2048?(q[at>>2]|=(192|Mt>>6)<<M[at++&3],q[at>>2]|=(128|Mt&63)<<M[at++&3]):Mt<55296||Mt>=57344?(q[at>>2]|=(224|Mt>>12)<<M[at++&3],q[at>>2]|=(128|Mt>>6&63)<<M[at++&3],q[at>>2]|=(128|Mt&63)<<M[at++&3]):(Mt=65536+((Mt&1023)<<10|E.charCodeAt(++et)&1023),q[at>>2]|=(240|Mt>>18)<<M[at++&3],q[at>>2]|=(128|Mt>>12&63)<<M[at++&3],q[at>>2]|=(128|Mt>>6&63)<<M[at++&3],q[at>>2]|=(128|Mt&63)<<M[at++&3]);if(this.lastByteIndex=at,at>=z){for(this.start=at-z,this.block=q[F],at=0;at<F;++at)ot[at]^=q[at];lt(ot),this.reset=!0}else this.start=at}return this},T.prototype.encode=function(E,tt){var L=E&255,q=1,z=[L];for(E=E>>8,L=E&255;L>0;)z.unshift(L),E=E>>8,L=E&255,++q;return tt?z.push(q):z.unshift(q),this.update(z),z.length},T.prototype.encodeString=function(E){var tt,L=typeof E;if(L!=="string"){if(L==="object"){if(E===null)throw new Error(t);if(d&&E.constructor===ArrayBuffer)E=new Uint8Array(E);else if(!Array.isArray(E)&&(!d||!ArrayBuffer.isView(E)))throw new Error(t)}else throw new Error(t);tt=!0}var q=0,z=E.length;if(tt)q=z;else for(var p=0;p<E.length;++p){var F=E.charCodeAt(p);F<128?q+=1:F<2048?q+=2:F<55296||F>=57344?q+=3:(F=65536+((F&1023)<<10|E.charCodeAt(++p)&1023),q+=4)}return q+=this.encode(q*8),this.update(E),q},T.prototype.bytepad=function(E,tt){for(var L=this.encode(tt),q=0;q<E.length;++q)L+=this.encodeString(E[q]);var z=tt-L%tt,p=[];return p.length=z,this.update(p),this},T.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var E=this.blocks,tt=this.lastByteIndex,L=this.blockCount,q=this.s;if(E[tt>>2]|=this.padding[tt&3],this.lastByteIndex===this.byteCount)for(E[0]=E[L],tt=1;tt<L+1;++tt)E[tt]=0;for(E[L-1]|=2147483648,tt=0;tt<L;++tt)q[tt]^=E[tt];lt(q)}},T.prototype.toString=T.prototype.hex=function(){this.finalize();for(var E=this.blockCount,tt=this.s,L=this.outputBlocks,q=this.extraBytes,z=0,p=0,F="",et;p<L;){for(z=0;z<E&&p<L;++z,++p)et=tt[z],F+=l[et>>4&15]+l[et&15]+l[et>>12&15]+l[et>>8&15]+l[et>>20&15]+l[et>>16&15]+l[et>>28&15]+l[et>>24&15];p%E===0&&(lt(tt),z=0)}return q&&(et=tt[z],F+=l[et>>4&15]+l[et&15],q>1&&(F+=l[et>>12&15]+l[et>>8&15]),q>2&&(F+=l[et>>20&15]+l[et>>16&15])),F},T.prototype.arrayBuffer=function(){this.finalize();var E=this.blockCount,tt=this.s,L=this.outputBlocks,q=this.extraBytes,z=0,p=0,F=this.outputBits>>3,et;q?et=new ArrayBuffer(L+1<<2):et=new ArrayBuffer(F);for(var ot=new Uint32Array(et);p<L;){for(z=0;z<E&&p<L;++z,++p)ot[p]=tt[z];p%E===0&&lt(tt)}return q&&(ot[z]=tt[z],et=et.slice(0,F)),et},T.prototype.buffer=T.prototype.arrayBuffer,T.prototype.digest=T.prototype.array=function(){this.finalize();for(var E=this.blockCount,tt=this.s,L=this.outputBlocks,q=this.extraBytes,z=0,p=0,F=[],et,ot;p<L;){for(z=0;z<E&&p<L;++z,++p)et=p<<2,ot=tt[z],F[et]=ot&255,F[et+1]=ot>>8&255,F[et+2]=ot>>16&255,F[et+3]=ot>>24&255;p%E===0&&lt(tt)}return q&&(et=p<<2,ot=tt[z],F[et]=ot&255,q>1&&(F[et+1]=ot>>8&255),q>2&&(F[et+2]=ot>>16&255)),F};function rt(E,tt,L){T.call(this,E,tt,L)}rt.prototype=new T,rt.prototype.finalize=function(){return this.encode(this.outputBits,!0),T.prototype.finalize.call(this)};var lt=function(E){var tt,L,q,z,p,F,et,ot,at,Mt,Ct,It,Ae,$t,xt,Lt,_t,Et,Vt,wt,At,Ut,bt,Pt,Bt,Ot,Nt,se,Rt,Tt,We,ue,ge,Ye,we,Ee,Mr,Gt,kt,De,Wt,Kt,Se,Qt,Xt,xe,Zt,Yt,Ce,Jt,qt,Fe,te,Oe,Pi,Ne,fe,ai,ci,ui,hi,li,lr;for(q=0;q<48;q+=2)z=E[0]^E[10]^E[20]^E[30]^E[40],p=E[1]^E[11]^E[21]^E[31]^E[41],F=E[2]^E[12]^E[22]^E[32]^E[42],et=E[3]^E[13]^E[23]^E[33]^E[43],ot=E[4]^E[14]^E[24]^E[34]^E[44],at=E[5]^E[15]^E[25]^E[35]^E[45],Mt=E[6]^E[16]^E[26]^E[36]^E[46],Ct=E[7]^E[17]^E[27]^E[37]^E[47],It=E[8]^E[18]^E[28]^E[38]^E[48],Ae=E[9]^E[19]^E[29]^E[39]^E[49],tt=It^(F<<1|et>>>31),L=Ae^(et<<1|F>>>31),E[0]^=tt,E[1]^=L,E[10]^=tt,E[11]^=L,E[20]^=tt,E[21]^=L,E[30]^=tt,E[31]^=L,E[40]^=tt,E[41]^=L,tt=z^(ot<<1|at>>>31),L=p^(at<<1|ot>>>31),E[2]^=tt,E[3]^=L,E[12]^=tt,E[13]^=L,E[22]^=tt,E[23]^=L,E[32]^=tt,E[33]^=L,E[42]^=tt,E[43]^=L,tt=F^(Mt<<1|Ct>>>31),L=et^(Ct<<1|Mt>>>31),E[4]^=tt,E[5]^=L,E[14]^=tt,E[15]^=L,E[24]^=tt,E[25]^=L,E[34]^=tt,E[35]^=L,E[44]^=tt,E[45]^=L,tt=ot^(It<<1|Ae>>>31),L=at^(Ae<<1|It>>>31),E[6]^=tt,E[7]^=L,E[16]^=tt,E[17]^=L,E[26]^=tt,E[27]^=L,E[36]^=tt,E[37]^=L,E[46]^=tt,E[47]^=L,tt=Mt^(z<<1|p>>>31),L=Ct^(p<<1|z>>>31),E[8]^=tt,E[9]^=L,E[18]^=tt,E[19]^=L,E[28]^=tt,E[29]^=L,E[38]^=tt,E[39]^=L,E[48]^=tt,E[49]^=L,$t=E[0],xt=E[1],xe=E[11]<<4|E[10]>>>28,Zt=E[10]<<4|E[11]>>>28,se=E[20]<<3|E[21]>>>29,Rt=E[21]<<3|E[20]>>>29,ui=E[31]<<9|E[30]>>>23,hi=E[30]<<9|E[31]>>>23,Kt=E[40]<<18|E[41]>>>14,Se=E[41]<<18|E[40]>>>14,Ye=E[2]<<1|E[3]>>>31,we=E[3]<<1|E[2]>>>31,Lt=E[13]<<12|E[12]>>>20,_t=E[12]<<12|E[13]>>>20,Yt=E[22]<<10|E[23]>>>22,Ce=E[23]<<10|E[22]>>>22,Tt=E[33]<<13|E[32]>>>19,We=E[32]<<13|E[33]>>>19,li=E[42]<<2|E[43]>>>30,lr=E[43]<<2|E[42]>>>30,Oe=E[5]<<30|E[4]>>>2,Pi=E[4]<<30|E[5]>>>2,Ee=E[14]<<6|E[15]>>>26,Mr=E[15]<<6|E[14]>>>26,Et=E[25]<<11|E[24]>>>21,Vt=E[24]<<11|E[25]>>>21,Jt=E[34]<<15|E[35]>>>17,qt=E[35]<<15|E[34]>>>17,ue=E[45]<<29|E[44]>>>3,ge=E[44]<<29|E[45]>>>3,Pt=E[6]<<28|E[7]>>>4,Bt=E[7]<<28|E[6]>>>4,Ne=E[17]<<23|E[16]>>>9,fe=E[16]<<23|E[17]>>>9,Gt=E[26]<<25|E[27]>>>7,kt=E[27]<<25|E[26]>>>7,wt=E[36]<<21|E[37]>>>11,At=E[37]<<21|E[36]>>>11,Fe=E[47]<<24|E[46]>>>8,te=E[46]<<24|E[47]>>>8,Qt=E[8]<<27|E[9]>>>5,Xt=E[9]<<27|E[8]>>>5,Ot=E[18]<<20|E[19]>>>12,Nt=E[19]<<20|E[18]>>>12,ai=E[29]<<7|E[28]>>>25,ci=E[28]<<7|E[29]>>>25,De=E[38]<<8|E[39]>>>24,Wt=E[39]<<8|E[38]>>>24,Ut=E[48]<<14|E[49]>>>18,bt=E[49]<<14|E[48]>>>18,E[0]=$t^~Lt&Et,E[1]=xt^~_t&Vt,E[10]=Pt^~Ot&se,E[11]=Bt^~Nt&Rt,E[20]=Ye^~Ee&Gt,E[21]=we^~Mr&kt,E[30]=Qt^~xe&Yt,E[31]=Xt^~Zt&Ce,E[40]=Oe^~Ne&ai,E[41]=Pi^~fe&ci,E[2]=Lt^~Et&wt,E[3]=_t^~Vt&At,E[12]=Ot^~se&Tt,E[13]=Nt^~Rt&We,E[22]=Ee^~Gt&De,E[23]=Mr^~kt&Wt,E[32]=xe^~Yt&Jt,E[33]=Zt^~Ce&qt,E[42]=Ne^~ai&ui,E[43]=fe^~ci&hi,E[4]=Et^~wt&Ut,E[5]=Vt^~At&bt,E[14]=se^~Tt&ue,E[15]=Rt^~We&ge,E[24]=Gt^~De&Kt,E[25]=kt^~Wt&Se,E[34]=Yt^~Jt&Fe,E[35]=Ce^~qt&te,E[44]=ai^~ui&li,E[45]=ci^~hi&lr,E[6]=wt^~Ut&$t,E[7]=At^~bt&xt,E[16]=Tt^~ue&Pt,E[17]=We^~ge&Bt,E[26]=De^~Kt&Ye,E[27]=Wt^~Se&we,E[36]=Jt^~Fe&Qt,E[37]=qt^~te&Xt,E[46]=ui^~li&Oe,E[47]=hi^~lr&Pi,E[8]=Ut^~$t&Lt,E[9]=bt^~xt&_t,E[18]=ue^~Pt&Ot,E[19]=ge^~Bt&Nt,E[28]=Kt^~Ye&Ee,E[29]=Se^~we&Mr,E[38]=Fe^~Qt&xe,E[39]=te^~Xt&Zt,E[48]=li^~Oe&Ne,E[49]=lr^~Pi&fe,E[0]^=G[q],E[1]^=G[q+1]};if(h)r.exports=y;else for(P=0;P<b.length;++P)s[b[P]]=y[b[P]]})()})(V1);var q8=V1.exports;const j8="logger/5.7.0";let y0=!1,w0=!1;const nu={debug:1,default:2,info:2,warning:3,error:4,off:5};let b0=nu.default,nl=null;function $8(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test".normalize(t)!=="test")throw new Error("bad normalize")}catch{r.push(t)}}),r.length)throw new Error("missing "+r.join(", "));if("".normalize("NFD")!=="e")throw new Error("broken implementation")}catch(r){return r.message}return null}const _0=$8();var Kl;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(Kl||(Kl={}));var qi;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(qi||(qi={}));const E0="0123456789abcdef";let _r=class ur{constructor(t){Object.defineProperty(this,"version",{enumerable:!0,value:t,writable:!1})}_log(t,e){const i=t.toLowerCase();nu[i]==null&&this.throwArgumentError("invalid log level name","logLevel",t),!(b0>nu[i])&&console.log.apply(console,e)}debug(...t){this._log(ur.levels.DEBUG,t)}info(...t){this._log(ur.levels.INFO,t)}warn(...t){this._log(ur.levels.WARNING,t)}makeError(t,e,i){if(w0)return this.makeError("censored error",e,{});e||(e=ur.errors.UNKNOWN_ERROR),i||(i={});const s=[];Object.keys(i).forEach(d=>{const l=i[d];try{if(l instanceof Uint8Array){let w="";for(let _=0;_<l.length;_++)w+=E0[l[_]>>4],w+=E0[l[_]&15];s.push(d+"=Uint8Array(0x"+w+")")}else s.push(d+"="+JSON.stringify(l))}catch{s.push(d+"="+JSON.stringify(i[d].toString()))}}),s.push(`code=${e}`),s.push(`version=${this.version}`);const a=t;let u="";switch(e){case qi.NUMERIC_FAULT:{u="NUMERIC_FAULT";const d=t;switch(d){case"overflow":case"underflow":case"division-by-zero":u+="-"+d;break;case"negative-power":case"negative-width":u+="-unsupported";break;case"unbound-bitwise-result":u+="-unbound-result";break}break}case qi.CALL_EXCEPTION:case qi.INSUFFICIENT_FUNDS:case qi.MISSING_NEW:case qi.NONCE_EXPIRED:case qi.REPLACEMENT_UNDERPRICED:case qi.TRANSACTION_REPLACED:case qi.UNPREDICTABLE_GAS_LIMIT:u=e;break}u&&(t+=" [ See: https://links.ethers.org/v5-errors-"+u+" ]"),s.length&&(t+=" ("+s.join(", ")+")");const h=new Error(t);return h.reason=a,h.code=e,Object.keys(i).forEach(function(d){h[d]=i[d]}),h}throwError(t,e,i){throw this.makeError(t,e,i)}throwArgumentError(t,e,i){return this.throwError(t,ur.errors.INVALID_ARGUMENT,{argument:e,value:i})}assert(t,e,i,s){t||this.throwError(e,i,s)}assertArgument(t,e,i,s){t||this.throwArgumentError(e,i,s)}checkNormalize(t){_0&&this.throwError("platform missing String.prototype.normalize",ur.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:_0})}checkSafeUint53(t,e){typeof t=="number"&&(e==null&&(e="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(e,ur.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(e,ur.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,e,i){i?i=": "+i:i="",t<e&&this.throwError("missing argument"+i,ur.errors.MISSING_ARGUMENT,{count:t,expectedCount:e}),t>e&&this.throwError("too many arguments"+i,ur.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:e})}checkNew(t,e){(t===Object||t==null)&&this.throwError("missing new",ur.errors.MISSING_NEW,{name:e.name})}checkAbstract(t,e){t===e?this.throwError("cannot instantiate abstract class "+JSON.stringify(e.name)+" directly; use a sub-class",ur.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):(t===Object||t==null)&&this.throwError("missing new",ur.errors.MISSING_NEW,{name:e.name})}static globalLogger(){return nl||(nl=new ur(j8)),nl}static setCensorship(t,e){if(!t&&e&&this.globalLogger().throwError("cannot permanently disable censorship",ur.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),y0){if(!t)return;this.globalLogger().throwError("error censorship permanent",ur.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}w0=!!t,y0=!!e}static setLogLevel(t){const e=nu[t.toLowerCase()];if(e==null){ur.globalLogger().warn("invalid log level - "+t);return}b0=e}static from(t){return new ur(t)}};_r.errors=qi,_r.levels=Kl;const k8="bytes/5.7.0",ir=new _r(k8);function G1(r){return!!r.toHexString}function bo(r){return r.slice||(r.slice=function(){const t=Array.prototype.slice.call(arguments);return bo(new Uint8Array(Array.prototype.slice.apply(r,t)))}),r}function z8(r){return ni(r)&&!(r.length%2)||Do(r)}function A0(r){return typeof r=="number"&&r==r&&r%1===0}function Do(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!A0(r.length)||r.length<0)return!1;for(let t=0;t<r.length;t++){const e=r[t];if(!A0(e)||e<0||e>=256)return!1}return!0}function Ze(r,t){if(t||(t={}),typeof r=="number"){ir.checkSafeUint53(r,"invalid arrayify value");const e=[];for(;r;)e.unshift(r&255),r=parseInt(String(r/256));return e.length===0&&e.push(0),bo(new Uint8Array(e))}if(t.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),G1(r)&&(r=r.toHexString()),ni(r)){let e=r.substring(2);e.length%2&&(t.hexPad==="left"?e="0"+e:t.hexPad==="right"?e+="0":ir.throwArgumentError("hex data is odd-length","value",r));const i=[];for(let s=0;s<e.length;s+=2)i.push(parseInt(e.substring(s,s+2),16));return bo(new Uint8Array(i))}return Do(r)?bo(new Uint8Array(r)):ir.throwArgumentError("invalid arrayify value","value",r)}function H8(r){const t=r.map(s=>Ze(s)),e=t.reduce((s,a)=>s+a.length,0),i=new Uint8Array(e);return t.reduce((s,a)=>(i.set(a,s),s+a.length),0),bo(i)}function K8(r,t){r=Ze(r),r.length>t&&ir.throwArgumentError("value out of range","value",arguments[0]);const e=new Uint8Array(t);return e.set(r,t-r.length),bo(e)}function ni(r,t){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||t&&r.length!==2+2*t)}const sl="0123456789abcdef";function Gr(r,t){if(t||(t={}),typeof r=="number"){ir.checkSafeUint53(r,"invalid hexlify value");let e="";for(;r;)e=sl[r&15]+e,r=Math.floor(r/16);return e.length?(e.length%2&&(e="0"+e),"0x"+e):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(t.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),G1(r))return r.toHexString();if(ni(r))return r.length%2&&(t.hexPad==="left"?r="0x0"+r.substring(2):t.hexPad==="right"?r+="0":ir.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(Do(r)){let e="0x";for(let i=0;i<r.length;i++){let s=r[i];e+=sl[(s&240)>>4]+sl[s&15]}return e}return ir.throwArgumentError("invalid hexlify value","value",r)}function V8(r){if(typeof r!="string")r=Gr(r);else if(!ni(r)||r.length%2)return null;return(r.length-2)/2}function S0(r,t,e){return typeof r!="string"?r=Gr(r):(!ni(r)||r.length%2)&&ir.throwArgumentError("invalid hexData","value",r),t=2+2*t,e!=null?"0x"+r.substring(t,2+2*e):"0x"+r.substring(t)}function fn(r,t){for(typeof r!="string"?r=Gr(r):ni(r)||ir.throwArgumentError("invalid hex string","value",r),r.length>2*t+2&&ir.throwArgumentError("value out of range","value",arguments[1]);r.length<2*t+2;)r="0x0"+r.substring(2);return r}function W1(r){const t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(z8(r)){let e=Ze(r);e.length===64?(t.v=27+(e[32]>>7),e[32]&=127,t.r=Gr(e.slice(0,32)),t.s=Gr(e.slice(32,64))):e.length===65?(t.r=Gr(e.slice(0,32)),t.s=Gr(e.slice(32,64)),t.v=e[64]):ir.throwArgumentError("invalid signature string","signature",r),t.v<27&&(t.v===0||t.v===1?t.v+=27:ir.throwArgumentError("signature invalid v byte","signature",r)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(e[32]|=128),t._vs=Gr(e.slice(32,64))}else{if(t.r=r.r,t.s=r.s,t.v=r.v,t.recoveryParam=r.recoveryParam,t._vs=r._vs,t._vs!=null){const s=K8(Ze(t._vs),32);t._vs=Gr(s);const a=s[0]>=128?1:0;t.recoveryParam==null?t.recoveryParam=a:t.recoveryParam!==a&&ir.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),s[0]&=127;const u=Gr(s);t.s==null?t.s=u:t.s!==u&&ir.throwArgumentError("signature v mismatch _vs","signature",r)}if(t.recoveryParam==null)t.v==null?ir.throwArgumentError("signature missing v and recoveryParam","signature",r):t.v===0||t.v===1?t.recoveryParam=t.v:t.recoveryParam=1-t.v%2;else if(t.v==null)t.v=27+t.recoveryParam;else{const s=t.v===0||t.v===1?t.v:1-t.v%2;t.recoveryParam!==s&&ir.throwArgumentError("signature recoveryParam mismatch v","signature",r)}t.r==null||!ni(t.r)?ir.throwArgumentError("signature missing or invalid r","signature",r):t.r=fn(t.r,32),t.s==null||!ni(t.s)?ir.throwArgumentError("signature missing or invalid s","signature",r):t.s=fn(t.s,32);const e=Ze(t.s);e[0]>=128&&ir.throwArgumentError("signature s out of range","signature",r),t.recoveryParam&&(e[0]|=128);const i=Gr(e);t._vs&&(ni(t._vs)||ir.throwArgumentError("signature invalid _vs","signature",r),t._vs=fn(t._vs,32)),t._vs==null?t._vs=i:t._vs!==i&&ir.throwArgumentError("signature _vs mismatch v and s","signature",r)}return t.yParityAndS=t._vs,t.compact=t.r+t.yParityAndS.substring(2),t}function vf(r){return"0x"+q8.keccak_256(Ze(r))}var Y1={exports:{}},G8={},W8=Object.freeze({__proto__:null,default:G8}),Y8=B8(W8);(function(r){(function(t,e){function i(f,y){if(!f)throw new Error(y||"Assertion failed")}function s(f,y){f.super_=y;var b=function(){};b.prototype=y.prototype,f.prototype=new b,f.prototype.constructor=f}function a(f,y,b){if(a.isBN(f))return f;this.negative=0,this.words=null,this.length=0,this.red=null,f!==null&&((y==="le"||y==="be")&&(b=y,y=10),this._init(f||0,y||10,b||"be"))}typeof t=="object"?t.exports=a:e.BN=a,a.BN=a,a.wordSize=26;var u;try{typeof window<"u"&&typeof window.Buffer<"u"?u=window.Buffer:u=Y8.Buffer}catch{}a.isBN=function(f){return f instanceof a?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===a.wordSize&&Array.isArray(f.words)},a.max=function(f,y){return f.cmp(y)>0?f:y},a.min=function(f,y){return f.cmp(y)<0?f:y},a.prototype._init=function(f,y,b){if(typeof f=="number")return this._initNumber(f,y,b);if(typeof f=="object")return this._initArray(f,y,b);y==="hex"&&(y=16),i(y===(y|0)&&y>=2&&y<=36),f=f.toString().replace(/\s+/g,"");var P=0;f[0]==="-"&&(P++,this.negative=1),P<f.length&&(y===16?this._parseHex(f,P,b):(this._parseBase(f,y,P),b==="le"&&this._initArray(this.toArray(),y,b)))},a.prototype._initNumber=function(f,y,b){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(i(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),b==="le"&&this._initArray(this.toArray(),y,b)},a.prototype._initArray=function(f,y,b){if(i(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var C,O,B=0;if(b==="be")for(P=f.length-1,C=0;P>=0;P-=3)O=f[P]|f[P-1]<<8|f[P-2]<<16,this.words[C]|=O<<B&67108863,this.words[C+1]=O>>>26-B&67108863,B+=24,B>=26&&(B-=26,C++);else if(b==="le")for(P=0,C=0;P<f.length;P+=3)O=f[P]|f[P+1]<<8|f[P+2]<<16,this.words[C]|=O<<B&67108863,this.words[C+1]=O>>>26-B&67108863,B+=24,B>=26&&(B-=26,C++);return this._strip()};function h(f,y){var b=f.charCodeAt(y);if(b>=48&&b<=57)return b-48;if(b>=65&&b<=70)return b-55;if(b>=97&&b<=102)return b-87;i(!1,"Invalid character in "+f)}function d(f,y,b){var P=h(f,b);return b-1>=y&&(P|=h(f,b-1)<<4),P}a.prototype._parseHex=function(f,y,b){this.length=Math.ceil((f.length-y)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var C=0,O=0,B;if(b==="be")for(P=f.length-1;P>=y;P-=2)B=d(f,y,P)<<C,this.words[O]|=B&67108863,C>=18?(C-=18,O+=1,this.words[O]|=B>>>26):C+=8;else{var D=f.length-y;for(P=D%2===0?y+1:y;P<f.length;P+=2)B=d(f,y,P)<<C,this.words[O]|=B&67108863,C>=18?(C-=18,O+=1,this.words[O]|=B>>>26):C+=8}this._strip()};function l(f,y,b,P){for(var C=0,O=0,B=Math.min(f.length,b),D=y;D<B;D++){var g=f.charCodeAt(D)-48;C*=P,g>=49?O=g-49+10:g>=17?O=g-17+10:O=g,i(g>=0&&O<P,"Invalid character"),C+=O}return C}a.prototype._parseBase=function(f,y,b){this.words=[0],this.length=1;for(var P=0,C=1;C<=67108863;C*=y)P++;P--,C=C/y|0;for(var O=f.length-b,B=O%P,D=Math.min(O,O-B)+b,g=0,T=b;T<D;T+=P)g=l(f,T,T+P,y),this.imuln(C),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g);if(B!==0){var rt=1;for(g=l(f,T,f.length,y),T=0;T<B;T++)rt*=y;this.imuln(rt),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g)}this._strip()},a.prototype.copy=function(f){f.words=new Array(this.length);for(var y=0;y<this.length;y++)f.words[y]=this.words[y];f.length=this.length,f.negative=this.negative,f.red=this.red};function w(f,y){f.words=y.words,f.length=y.length,f.negative=y.negative,f.red=y.red}if(a.prototype._move=function(f){w(f,this)},a.prototype.clone=function(){var f=new a(null);return this.copy(f),f},a.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=_}catch{a.prototype.inspect=_}else a.prototype.inspect=_;function _(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var I=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],S=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],M=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(f,y){f=f||10,y=y|0||1;var b;if(f===16||f==="hex"){b="";for(var P=0,C=0,O=0;O<this.length;O++){var B=this.words[O],D=((B<<P|C)&16777215).toString(16);C=B>>>24-P&16777215,P+=2,P>=26&&(P-=26,O--),C!==0||O!==this.length-1?b=I[6-D.length]+D+b:b=D+b}for(C!==0&&(b=C.toString(16)+b);b.length%y!==0;)b="0"+b;return this.negative!==0&&(b="-"+b),b}if(f===(f|0)&&f>=2&&f<=36){var g=S[f],T=M[f];b="";var rt=this.clone();for(rt.negative=0;!rt.isZero();){var lt=rt.modrn(T).toString(f);rt=rt.idivn(T),rt.isZero()?b=lt+b:b=I[g-lt.length]+lt+b}for(this.isZero()&&(b="0"+b);b.length%y!==0;)b="0"+b;return this.negative!==0&&(b="-"+b),b}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},a.prototype.toJSON=function(){return this.toString(16,2)},u&&(a.prototype.toBuffer=function(f,y){return this.toArrayLike(u,f,y)}),a.prototype.toArray=function(f,y){return this.toArrayLike(Array,f,y)};var G=function(f,y){return f.allocUnsafe?f.allocUnsafe(y):new f(y)};a.prototype.toArrayLike=function(f,y,b){this._strip();var P=this.byteLength(),C=b||Math.max(1,P);i(P<=C,"byte array longer than desired length"),i(C>0,"Requested array length <= 0");var O=G(f,C),B=y==="le"?"LE":"BE";return this["_toArrayLike"+B](O,P),O},a.prototype._toArrayLikeLE=function(f,y){for(var b=0,P=0,C=0,O=0;C<this.length;C++){var B=this.words[C]<<O|P;f[b++]=B&255,b<f.length&&(f[b++]=B>>8&255),b<f.length&&(f[b++]=B>>16&255),O===6?(b<f.length&&(f[b++]=B>>24&255),P=0,O=0):(P=B>>>24,O+=2)}if(b<f.length)for(f[b++]=P;b<f.length;)f[b++]=0},a.prototype._toArrayLikeBE=function(f,y){for(var b=f.length-1,P=0,C=0,O=0;C<this.length;C++){var B=this.words[C]<<O|P;f[b--]=B&255,b>=0&&(f[b--]=B>>8&255),b>=0&&(f[b--]=B>>16&255),O===6?(b>=0&&(f[b--]=B>>24&255),P=0,O=0):(P=B>>>24,O+=2)}if(b>=0)for(f[b--]=P;b>=0;)f[b--]=0},Math.clz32?a.prototype._countBits=function(f){return 32-Math.clz32(f)}:a.prototype._countBits=function(f){var y=f,b=0;return y>=4096&&(b+=13,y>>>=13),y>=64&&(b+=7,y>>>=7),y>=8&&(b+=4,y>>>=4),y>=2&&(b+=2,y>>>=2),b+y},a.prototype._zeroBits=function(f){if(f===0)return 26;var y=f,b=0;return y&8191||(b+=13,y>>>=13),y&127||(b+=7,y>>>=7),y&15||(b+=4,y>>>=4),y&3||(b+=2,y>>>=2),y&1||b++,b},a.prototype.bitLength=function(){var f=this.words[this.length-1],y=this._countBits(f);return(this.length-1)*26+y};function V(f){for(var y=new Array(f.bitLength()),b=0;b<y.length;b++){var P=b/26|0,C=b%26;y[b]=f.words[P]>>>C&1}return y}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,y=0;y<this.length;y++){var b=this._zeroBits(this.words[y]);if(f+=b,b!==26)break}return f},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},a.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var y=0;y<f.length;y++)this.words[y]=this.words[y]|f.words[y];return this._strip()},a.prototype.ior=function(f){return i((this.negative|f.negative)===0),this.iuor(f)},a.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},a.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},a.prototype.iuand=function(f){var y;this.length>f.length?y=f:y=this;for(var b=0;b<y.length;b++)this.words[b]=this.words[b]&f.words[b];return this.length=y.length,this._strip()},a.prototype.iand=function(f){return i((this.negative|f.negative)===0),this.iuand(f)},a.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},a.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},a.prototype.iuxor=function(f){var y,b;this.length>f.length?(y=this,b=f):(y=f,b=this);for(var P=0;P<b.length;P++)this.words[P]=y.words[P]^b.words[P];if(this!==y)for(;P<y.length;P++)this.words[P]=y.words[P];return this.length=y.length,this._strip()},a.prototype.ixor=function(f){return i((this.negative|f.negative)===0),this.iuxor(f)},a.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},a.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},a.prototype.inotn=function(f){i(typeof f=="number"&&f>=0);var y=Math.ceil(f/26)|0,b=f%26;this._expand(y),b>0&&y--;for(var P=0;P<y;P++)this.words[P]=~this.words[P]&67108863;return b>0&&(this.words[P]=~this.words[P]&67108863>>26-b),this._strip()},a.prototype.notn=function(f){return this.clone().inotn(f)},a.prototype.setn=function(f,y){i(typeof f=="number"&&f>=0);var b=f/26|0,P=f%26;return this._expand(b+1),y?this.words[b]=this.words[b]|1<<P:this.words[b]=this.words[b]&~(1<<P),this._strip()},a.prototype.iadd=function(f){var y;if(this.negative!==0&&f.negative===0)return this.negative=0,y=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,y=this.isub(f),f.negative=1,y._normSign();var b,P;this.length>f.length?(b=this,P=f):(b=f,P=this);for(var C=0,O=0;O<P.length;O++)y=(b.words[O]|0)+(P.words[O]|0)+C,this.words[O]=y&67108863,C=y>>>26;for(;C!==0&&O<b.length;O++)y=(b.words[O]|0)+C,this.words[O]=y&67108863,C=y>>>26;if(this.length=b.length,C!==0)this.words[this.length]=C,this.length++;else if(b!==this)for(;O<b.length;O++)this.words[O]=b.words[O];return this},a.prototype.add=function(f){var y;return f.negative!==0&&this.negative===0?(f.negative=0,y=this.sub(f),f.negative^=1,y):f.negative===0&&this.negative!==0?(this.negative=0,y=f.sub(this),this.negative=1,y):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},a.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var y=this.iadd(f);return f.negative=1,y._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var b=this.cmp(f);if(b===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,C;b>0?(P=this,C=f):(P=f,C=this);for(var O=0,B=0;B<C.length;B++)y=(P.words[B]|0)-(C.words[B]|0)+O,O=y>>26,this.words[B]=y&67108863;for(;O!==0&&B<P.length;B++)y=(P.words[B]|0)+O,O=y>>26,this.words[B]=y&67108863;if(O===0&&B<P.length&&P!==this)for(;B<P.length;B++)this.words[B]=P.words[B];return this.length=Math.max(this.length,B),P!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(f){return this.clone().isub(f)};function Z(f,y,b){b.negative=y.negative^f.negative;var P=f.length+y.length|0;b.length=P,P=P-1|0;var C=f.words[0]|0,O=y.words[0]|0,B=C*O,D=B&67108863,g=B/67108864|0;b.words[0]=D;for(var T=1;T<P;T++){for(var rt=g>>>26,lt=g&67108863,E=Math.min(T,y.length-1),tt=Math.max(0,T-f.length+1);tt<=E;tt++){var L=T-tt|0;C=f.words[L]|0,O=y.words[tt]|0,B=C*O+lt,rt+=B/67108864|0,lt=B&67108863}b.words[T]=lt|0,g=rt|0}return g!==0?b.words[T]=g|0:b.length--,b._strip()}var H=function(f,y,b){var P=f.words,C=y.words,O=b.words,B=0,D,g,T,rt=P[0]|0,lt=rt&8191,E=rt>>>13,tt=P[1]|0,L=tt&8191,q=tt>>>13,z=P[2]|0,p=z&8191,F=z>>>13,et=P[3]|0,ot=et&8191,at=et>>>13,Mt=P[4]|0,Ct=Mt&8191,It=Mt>>>13,Ae=P[5]|0,$t=Ae&8191,xt=Ae>>>13,Lt=P[6]|0,_t=Lt&8191,Et=Lt>>>13,Vt=P[7]|0,wt=Vt&8191,At=Vt>>>13,Ut=P[8]|0,bt=Ut&8191,Pt=Ut>>>13,Bt=P[9]|0,Ot=Bt&8191,Nt=Bt>>>13,se=C[0]|0,Rt=se&8191,Tt=se>>>13,We=C[1]|0,ue=We&8191,ge=We>>>13,Ye=C[2]|0,we=Ye&8191,Ee=Ye>>>13,Mr=C[3]|0,Gt=Mr&8191,kt=Mr>>>13,De=C[4]|0,Wt=De&8191,Kt=De>>>13,Se=C[5]|0,Qt=Se&8191,Xt=Se>>>13,xe=C[6]|0,Zt=xe&8191,Yt=xe>>>13,Ce=C[7]|0,Jt=Ce&8191,qt=Ce>>>13,Fe=C[8]|0,te=Fe&8191,Oe=Fe>>>13,Pi=C[9]|0,Ne=Pi&8191,fe=Pi>>>13;b.negative=f.negative^y.negative,b.length=19,D=Math.imul(lt,Rt),g=Math.imul(lt,Tt),g=g+Math.imul(E,Rt)|0,T=Math.imul(E,Tt);var ai=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(ai>>>26)|0,ai&=67108863,D=Math.imul(L,Rt),g=Math.imul(L,Tt),g=g+Math.imul(q,Rt)|0,T=Math.imul(q,Tt),D=D+Math.imul(lt,ue)|0,g=g+Math.imul(lt,ge)|0,g=g+Math.imul(E,ue)|0,T=T+Math.imul(E,ge)|0;var ci=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(ci>>>26)|0,ci&=67108863,D=Math.imul(p,Rt),g=Math.imul(p,Tt),g=g+Math.imul(F,Rt)|0,T=Math.imul(F,Tt),D=D+Math.imul(L,ue)|0,g=g+Math.imul(L,ge)|0,g=g+Math.imul(q,ue)|0,T=T+Math.imul(q,ge)|0,D=D+Math.imul(lt,we)|0,g=g+Math.imul(lt,Ee)|0,g=g+Math.imul(E,we)|0,T=T+Math.imul(E,Ee)|0;var ui=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(ui>>>26)|0,ui&=67108863,D=Math.imul(ot,Rt),g=Math.imul(ot,Tt),g=g+Math.imul(at,Rt)|0,T=Math.imul(at,Tt),D=D+Math.imul(p,ue)|0,g=g+Math.imul(p,ge)|0,g=g+Math.imul(F,ue)|0,T=T+Math.imul(F,ge)|0,D=D+Math.imul(L,we)|0,g=g+Math.imul(L,Ee)|0,g=g+Math.imul(q,we)|0,T=T+Math.imul(q,Ee)|0,D=D+Math.imul(lt,Gt)|0,g=g+Math.imul(lt,kt)|0,g=g+Math.imul(E,Gt)|0,T=T+Math.imul(E,kt)|0;var hi=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(hi>>>26)|0,hi&=67108863,D=Math.imul(Ct,Rt),g=Math.imul(Ct,Tt),g=g+Math.imul(It,Rt)|0,T=Math.imul(It,Tt),D=D+Math.imul(ot,ue)|0,g=g+Math.imul(ot,ge)|0,g=g+Math.imul(at,ue)|0,T=T+Math.imul(at,ge)|0,D=D+Math.imul(p,we)|0,g=g+Math.imul(p,Ee)|0,g=g+Math.imul(F,we)|0,T=T+Math.imul(F,Ee)|0,D=D+Math.imul(L,Gt)|0,g=g+Math.imul(L,kt)|0,g=g+Math.imul(q,Gt)|0,T=T+Math.imul(q,kt)|0,D=D+Math.imul(lt,Wt)|0,g=g+Math.imul(lt,Kt)|0,g=g+Math.imul(E,Wt)|0,T=T+Math.imul(E,Kt)|0;var li=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(li>>>26)|0,li&=67108863,D=Math.imul($t,Rt),g=Math.imul($t,Tt),g=g+Math.imul(xt,Rt)|0,T=Math.imul(xt,Tt),D=D+Math.imul(Ct,ue)|0,g=g+Math.imul(Ct,ge)|0,g=g+Math.imul(It,ue)|0,T=T+Math.imul(It,ge)|0,D=D+Math.imul(ot,we)|0,g=g+Math.imul(ot,Ee)|0,g=g+Math.imul(at,we)|0,T=T+Math.imul(at,Ee)|0,D=D+Math.imul(p,Gt)|0,g=g+Math.imul(p,kt)|0,g=g+Math.imul(F,Gt)|0,T=T+Math.imul(F,kt)|0,D=D+Math.imul(L,Wt)|0,g=g+Math.imul(L,Kt)|0,g=g+Math.imul(q,Wt)|0,T=T+Math.imul(q,Kt)|0,D=D+Math.imul(lt,Qt)|0,g=g+Math.imul(lt,Xt)|0,g=g+Math.imul(E,Qt)|0,T=T+Math.imul(E,Xt)|0;var lr=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(lr>>>26)|0,lr&=67108863,D=Math.imul(_t,Rt),g=Math.imul(_t,Tt),g=g+Math.imul(Et,Rt)|0,T=Math.imul(Et,Tt),D=D+Math.imul($t,ue)|0,g=g+Math.imul($t,ge)|0,g=g+Math.imul(xt,ue)|0,T=T+Math.imul(xt,ge)|0,D=D+Math.imul(Ct,we)|0,g=g+Math.imul(Ct,Ee)|0,g=g+Math.imul(It,we)|0,T=T+Math.imul(It,Ee)|0,D=D+Math.imul(ot,Gt)|0,g=g+Math.imul(ot,kt)|0,g=g+Math.imul(at,Gt)|0,T=T+Math.imul(at,kt)|0,D=D+Math.imul(p,Wt)|0,g=g+Math.imul(p,Kt)|0,g=g+Math.imul(F,Wt)|0,T=T+Math.imul(F,Kt)|0,D=D+Math.imul(L,Qt)|0,g=g+Math.imul(L,Xt)|0,g=g+Math.imul(q,Qt)|0,T=T+Math.imul(q,Xt)|0,D=D+Math.imul(lt,Zt)|0,g=g+Math.imul(lt,Yt)|0,g=g+Math.imul(E,Zt)|0,T=T+Math.imul(E,Yt)|0;var Ki=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(Ki>>>26)|0,Ki&=67108863,D=Math.imul(wt,Rt),g=Math.imul(wt,Tt),g=g+Math.imul(At,Rt)|0,T=Math.imul(At,Tt),D=D+Math.imul(_t,ue)|0,g=g+Math.imul(_t,ge)|0,g=g+Math.imul(Et,ue)|0,T=T+Math.imul(Et,ge)|0,D=D+Math.imul($t,we)|0,g=g+Math.imul($t,Ee)|0,g=g+Math.imul(xt,we)|0,T=T+Math.imul(xt,Ee)|0,D=D+Math.imul(Ct,Gt)|0,g=g+Math.imul(Ct,kt)|0,g=g+Math.imul(It,Gt)|0,T=T+Math.imul(It,kt)|0,D=D+Math.imul(ot,Wt)|0,g=g+Math.imul(ot,Kt)|0,g=g+Math.imul(at,Wt)|0,T=T+Math.imul(at,Kt)|0,D=D+Math.imul(p,Qt)|0,g=g+Math.imul(p,Xt)|0,g=g+Math.imul(F,Qt)|0,T=T+Math.imul(F,Xt)|0,D=D+Math.imul(L,Zt)|0,g=g+Math.imul(L,Yt)|0,g=g+Math.imul(q,Zt)|0,T=T+Math.imul(q,Yt)|0,D=D+Math.imul(lt,Jt)|0,g=g+Math.imul(lt,qt)|0,g=g+Math.imul(E,Jt)|0,T=T+Math.imul(E,qt)|0;var cs=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(cs>>>26)|0,cs&=67108863,D=Math.imul(bt,Rt),g=Math.imul(bt,Tt),g=g+Math.imul(Pt,Rt)|0,T=Math.imul(Pt,Tt),D=D+Math.imul(wt,ue)|0,g=g+Math.imul(wt,ge)|0,g=g+Math.imul(At,ue)|0,T=T+Math.imul(At,ge)|0,D=D+Math.imul(_t,we)|0,g=g+Math.imul(_t,Ee)|0,g=g+Math.imul(Et,we)|0,T=T+Math.imul(Et,Ee)|0,D=D+Math.imul($t,Gt)|0,g=g+Math.imul($t,kt)|0,g=g+Math.imul(xt,Gt)|0,T=T+Math.imul(xt,kt)|0,D=D+Math.imul(Ct,Wt)|0,g=g+Math.imul(Ct,Kt)|0,g=g+Math.imul(It,Wt)|0,T=T+Math.imul(It,Kt)|0,D=D+Math.imul(ot,Qt)|0,g=g+Math.imul(ot,Xt)|0,g=g+Math.imul(at,Qt)|0,T=T+Math.imul(at,Xt)|0,D=D+Math.imul(p,Zt)|0,g=g+Math.imul(p,Yt)|0,g=g+Math.imul(F,Zt)|0,T=T+Math.imul(F,Yt)|0,D=D+Math.imul(L,Jt)|0,g=g+Math.imul(L,qt)|0,g=g+Math.imul(q,Jt)|0,T=T+Math.imul(q,qt)|0,D=D+Math.imul(lt,te)|0,g=g+Math.imul(lt,Oe)|0,g=g+Math.imul(E,te)|0,T=T+Math.imul(E,Oe)|0;var Vi=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,D=Math.imul(Ot,Rt),g=Math.imul(Ot,Tt),g=g+Math.imul(Nt,Rt)|0,T=Math.imul(Nt,Tt),D=D+Math.imul(bt,ue)|0,g=g+Math.imul(bt,ge)|0,g=g+Math.imul(Pt,ue)|0,T=T+Math.imul(Pt,ge)|0,D=D+Math.imul(wt,we)|0,g=g+Math.imul(wt,Ee)|0,g=g+Math.imul(At,we)|0,T=T+Math.imul(At,Ee)|0,D=D+Math.imul(_t,Gt)|0,g=g+Math.imul(_t,kt)|0,g=g+Math.imul(Et,Gt)|0,T=T+Math.imul(Et,kt)|0,D=D+Math.imul($t,Wt)|0,g=g+Math.imul($t,Kt)|0,g=g+Math.imul(xt,Wt)|0,T=T+Math.imul(xt,Kt)|0,D=D+Math.imul(Ct,Qt)|0,g=g+Math.imul(Ct,Xt)|0,g=g+Math.imul(It,Qt)|0,T=T+Math.imul(It,Xt)|0,D=D+Math.imul(ot,Zt)|0,g=g+Math.imul(ot,Yt)|0,g=g+Math.imul(at,Zt)|0,T=T+Math.imul(at,Yt)|0,D=D+Math.imul(p,Jt)|0,g=g+Math.imul(p,qt)|0,g=g+Math.imul(F,Jt)|0,T=T+Math.imul(F,qt)|0,D=D+Math.imul(L,te)|0,g=g+Math.imul(L,Oe)|0,g=g+Math.imul(q,te)|0,T=T+Math.imul(q,Oe)|0,D=D+Math.imul(lt,Ne)|0,g=g+Math.imul(lt,fe)|0,g=g+Math.imul(E,Ne)|0,T=T+Math.imul(E,fe)|0;var us=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(us>>>26)|0,us&=67108863,D=Math.imul(Ot,ue),g=Math.imul(Ot,ge),g=g+Math.imul(Nt,ue)|0,T=Math.imul(Nt,ge),D=D+Math.imul(bt,we)|0,g=g+Math.imul(bt,Ee)|0,g=g+Math.imul(Pt,we)|0,T=T+Math.imul(Pt,Ee)|0,D=D+Math.imul(wt,Gt)|0,g=g+Math.imul(wt,kt)|0,g=g+Math.imul(At,Gt)|0,T=T+Math.imul(At,kt)|0,D=D+Math.imul(_t,Wt)|0,g=g+Math.imul(_t,Kt)|0,g=g+Math.imul(Et,Wt)|0,T=T+Math.imul(Et,Kt)|0,D=D+Math.imul($t,Qt)|0,g=g+Math.imul($t,Xt)|0,g=g+Math.imul(xt,Qt)|0,T=T+Math.imul(xt,Xt)|0,D=D+Math.imul(Ct,Zt)|0,g=g+Math.imul(Ct,Yt)|0,g=g+Math.imul(It,Zt)|0,T=T+Math.imul(It,Yt)|0,D=D+Math.imul(ot,Jt)|0,g=g+Math.imul(ot,qt)|0,g=g+Math.imul(at,Jt)|0,T=T+Math.imul(at,qt)|0,D=D+Math.imul(p,te)|0,g=g+Math.imul(p,Oe)|0,g=g+Math.imul(F,te)|0,T=T+Math.imul(F,Oe)|0,D=D+Math.imul(L,Ne)|0,g=g+Math.imul(L,fe)|0,g=g+Math.imul(q,Ne)|0,T=T+Math.imul(q,fe)|0;var hs=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(hs>>>26)|0,hs&=67108863,D=Math.imul(Ot,we),g=Math.imul(Ot,Ee),g=g+Math.imul(Nt,we)|0,T=Math.imul(Nt,Ee),D=D+Math.imul(bt,Gt)|0,g=g+Math.imul(bt,kt)|0,g=g+Math.imul(Pt,Gt)|0,T=T+Math.imul(Pt,kt)|0,D=D+Math.imul(wt,Wt)|0,g=g+Math.imul(wt,Kt)|0,g=g+Math.imul(At,Wt)|0,T=T+Math.imul(At,Kt)|0,D=D+Math.imul(_t,Qt)|0,g=g+Math.imul(_t,Xt)|0,g=g+Math.imul(Et,Qt)|0,T=T+Math.imul(Et,Xt)|0,D=D+Math.imul($t,Zt)|0,g=g+Math.imul($t,Yt)|0,g=g+Math.imul(xt,Zt)|0,T=T+Math.imul(xt,Yt)|0,D=D+Math.imul(Ct,Jt)|0,g=g+Math.imul(Ct,qt)|0,g=g+Math.imul(It,Jt)|0,T=T+Math.imul(It,qt)|0,D=D+Math.imul(ot,te)|0,g=g+Math.imul(ot,Oe)|0,g=g+Math.imul(at,te)|0,T=T+Math.imul(at,Oe)|0,D=D+Math.imul(p,Ne)|0,g=g+Math.imul(p,fe)|0,g=g+Math.imul(F,Ne)|0,T=T+Math.imul(F,fe)|0;var Gi=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(Gi>>>26)|0,Gi&=67108863,D=Math.imul(Ot,Gt),g=Math.imul(Ot,kt),g=g+Math.imul(Nt,Gt)|0,T=Math.imul(Nt,kt),D=D+Math.imul(bt,Wt)|0,g=g+Math.imul(bt,Kt)|0,g=g+Math.imul(Pt,Wt)|0,T=T+Math.imul(Pt,Kt)|0,D=D+Math.imul(wt,Qt)|0,g=g+Math.imul(wt,Xt)|0,g=g+Math.imul(At,Qt)|0,T=T+Math.imul(At,Xt)|0,D=D+Math.imul(_t,Zt)|0,g=g+Math.imul(_t,Yt)|0,g=g+Math.imul(Et,Zt)|0,T=T+Math.imul(Et,Yt)|0,D=D+Math.imul($t,Jt)|0,g=g+Math.imul($t,qt)|0,g=g+Math.imul(xt,Jt)|0,T=T+Math.imul(xt,qt)|0,D=D+Math.imul(Ct,te)|0,g=g+Math.imul(Ct,Oe)|0,g=g+Math.imul(It,te)|0,T=T+Math.imul(It,Oe)|0,D=D+Math.imul(ot,Ne)|0,g=g+Math.imul(ot,fe)|0,g=g+Math.imul(at,Ne)|0,T=T+Math.imul(at,fe)|0;var jn=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(jn>>>26)|0,jn&=67108863,D=Math.imul(Ot,Wt),g=Math.imul(Ot,Kt),g=g+Math.imul(Nt,Wt)|0,T=Math.imul(Nt,Kt),D=D+Math.imul(bt,Qt)|0,g=g+Math.imul(bt,Xt)|0,g=g+Math.imul(Pt,Qt)|0,T=T+Math.imul(Pt,Xt)|0,D=D+Math.imul(wt,Zt)|0,g=g+Math.imul(wt,Yt)|0,g=g+Math.imul(At,Zt)|0,T=T+Math.imul(At,Yt)|0,D=D+Math.imul(_t,Jt)|0,g=g+Math.imul(_t,qt)|0,g=g+Math.imul(Et,Jt)|0,T=T+Math.imul(Et,qt)|0,D=D+Math.imul($t,te)|0,g=g+Math.imul($t,Oe)|0,g=g+Math.imul(xt,te)|0,T=T+Math.imul(xt,Oe)|0,D=D+Math.imul(Ct,Ne)|0,g=g+Math.imul(Ct,fe)|0,g=g+Math.imul(It,Ne)|0,T=T+Math.imul(It,fe)|0;var $n=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+($n>>>26)|0,$n&=67108863,D=Math.imul(Ot,Qt),g=Math.imul(Ot,Xt),g=g+Math.imul(Nt,Qt)|0,T=Math.imul(Nt,Xt),D=D+Math.imul(bt,Zt)|0,g=g+Math.imul(bt,Yt)|0,g=g+Math.imul(Pt,Zt)|0,T=T+Math.imul(Pt,Yt)|0,D=D+Math.imul(wt,Jt)|0,g=g+Math.imul(wt,qt)|0,g=g+Math.imul(At,Jt)|0,T=T+Math.imul(At,qt)|0,D=D+Math.imul(_t,te)|0,g=g+Math.imul(_t,Oe)|0,g=g+Math.imul(Et,te)|0,T=T+Math.imul(Et,Oe)|0,D=D+Math.imul($t,Ne)|0,g=g+Math.imul($t,fe)|0,g=g+Math.imul(xt,Ne)|0,T=T+Math.imul(xt,fe)|0;var Pr=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(Pr>>>26)|0,Pr&=67108863,D=Math.imul(Ot,Zt),g=Math.imul(Ot,Yt),g=g+Math.imul(Nt,Zt)|0,T=Math.imul(Nt,Yt),D=D+Math.imul(bt,Jt)|0,g=g+Math.imul(bt,qt)|0,g=g+Math.imul(Pt,Jt)|0,T=T+Math.imul(Pt,qt)|0,D=D+Math.imul(wt,te)|0,g=g+Math.imul(wt,Oe)|0,g=g+Math.imul(At,te)|0,T=T+Math.imul(At,Oe)|0,D=D+Math.imul(_t,Ne)|0,g=g+Math.imul(_t,fe)|0,g=g+Math.imul(Et,Ne)|0,T=T+Math.imul(Et,fe)|0;var ls=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(ls>>>26)|0,ls&=67108863,D=Math.imul(Ot,Jt),g=Math.imul(Ot,qt),g=g+Math.imul(Nt,Jt)|0,T=Math.imul(Nt,qt),D=D+Math.imul(bt,te)|0,g=g+Math.imul(bt,Oe)|0,g=g+Math.imul(Pt,te)|0,T=T+Math.imul(Pt,Oe)|0,D=D+Math.imul(wt,Ne)|0,g=g+Math.imul(wt,fe)|0,g=g+Math.imul(At,Ne)|0,T=T+Math.imul(At,fe)|0;var fs=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(fs>>>26)|0,fs&=67108863,D=Math.imul(Ot,te),g=Math.imul(Ot,Oe),g=g+Math.imul(Nt,te)|0,T=Math.imul(Nt,Oe),D=D+Math.imul(bt,Ne)|0,g=g+Math.imul(bt,fe)|0,g=g+Math.imul(Pt,Ne)|0,T=T+Math.imul(Pt,fe)|0;var ds=(B+D|0)+((g&8191)<<13)|0;B=(T+(g>>>13)|0)+(ds>>>26)|0,ds&=67108863,D=Math.imul(Ot,Ne),g=Math.imul(Ot,fe),g=g+Math.imul(Nt,Ne)|0,T=Math.imul(Nt,fe);var ps=(B+D|0)+((g&8191)<<13)|0;return B=(T+(g>>>13)|0)+(ps>>>26)|0,ps&=67108863,O[0]=ai,O[1]=ci,O[2]=ui,O[3]=hi,O[4]=li,O[5]=lr,O[6]=Ki,O[7]=cs,O[8]=Vi,O[9]=us,O[10]=hs,O[11]=Gi,O[12]=jn,O[13]=$n,O[14]=Pr,O[15]=ls,O[16]=fs,O[17]=ds,O[18]=ps,B!==0&&(O[19]=B,b.length++),b};Math.imul||(H=Z);function W(f,y,b){b.negative=y.negative^f.negative,b.length=f.length+y.length;for(var P=0,C=0,O=0;O<b.length-1;O++){var B=C;C=0;for(var D=P&67108863,g=Math.min(O,y.length-1),T=Math.max(0,O-f.length+1);T<=g;T++){var rt=O-T,lt=f.words[rt]|0,E=y.words[T]|0,tt=lt*E,L=tt&67108863;B=B+(tt/67108864|0)|0,L=L+D|0,D=L&67108863,B=B+(L>>>26)|0,C+=B>>>26,B&=67108863}b.words[O]=D,P=B,B=C}return P!==0?b.words[O]=P:b.length--,b._strip()}function U(f,y,b){return W(f,y,b)}a.prototype.mulTo=function(f,y){var b,P=this.length+f.length;return this.length===10&&f.length===10?b=H(this,f,y):P<63?b=Z(this,f,y):P<1024?b=W(this,f,y):b=U(this,f,y),b},a.prototype.mul=function(f){var y=new a(null);return y.words=new Array(this.length+f.length),this.mulTo(f,y)},a.prototype.mulf=function(f){var y=new a(null);return y.words=new Array(this.length+f.length),U(this,f,y)},a.prototype.imul=function(f){return this.clone().mulTo(f,this)},a.prototype.imuln=function(f){var y=f<0;y&&(f=-f),i(typeof f=="number"),i(f<67108864);for(var b=0,P=0;P<this.length;P++){var C=(this.words[P]|0)*f,O=(C&67108863)+(b&67108863);b>>=26,b+=C/67108864|0,b+=O>>>26,this.words[P]=O&67108863}return b!==0&&(this.words[P]=b,this.length++),y?this.ineg():this},a.prototype.muln=function(f){return this.clone().imuln(f)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(f){var y=V(f);if(y.length===0)return new a(1);for(var b=this,P=0;P<y.length&&y[P]===0;P++,b=b.sqr());if(++P<y.length)for(var C=b.sqr();P<y.length;P++,C=C.sqr())y[P]!==0&&(b=b.mul(C));return b},a.prototype.iushln=function(f){i(typeof f=="number"&&f>=0);var y=f%26,b=(f-y)/26,P=67108863>>>26-y<<26-y,C;if(y!==0){var O=0;for(C=0;C<this.length;C++){var B=this.words[C]&P,D=(this.words[C]|0)-B<<y;this.words[C]=D|O,O=B>>>26-y}O&&(this.words[C]=O,this.length++)}if(b!==0){for(C=this.length-1;C>=0;C--)this.words[C+b]=this.words[C];for(C=0;C<b;C++)this.words[C]=0;this.length+=b}return this._strip()},a.prototype.ishln=function(f){return i(this.negative===0),this.iushln(f)},a.prototype.iushrn=function(f,y,b){i(typeof f=="number"&&f>=0);var P;y?P=(y-y%26)/26:P=0;var C=f%26,O=Math.min((f-C)/26,this.length),B=67108863^67108863>>>C<<C,D=b;if(P-=O,P=Math.max(0,P),D){for(var g=0;g<O;g++)D.words[g]=this.words[g];D.length=O}if(O!==0)if(this.length>O)for(this.length-=O,g=0;g<this.length;g++)this.words[g]=this.words[g+O];else this.words[0]=0,this.length=1;var T=0;for(g=this.length-1;g>=0&&(T!==0||g>=P);g--){var rt=this.words[g]|0;this.words[g]=T<<26-C|rt>>>C,T=rt&B}return D&&T!==0&&(D.words[D.length++]=T),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(f,y,b){return i(this.negative===0),this.iushrn(f,y,b)},a.prototype.shln=function(f){return this.clone().ishln(f)},a.prototype.ushln=function(f){return this.clone().iushln(f)},a.prototype.shrn=function(f){return this.clone().ishrn(f)},a.prototype.ushrn=function(f){return this.clone().iushrn(f)},a.prototype.testn=function(f){i(typeof f=="number"&&f>=0);var y=f%26,b=(f-y)/26,P=1<<y;if(this.length<=b)return!1;var C=this.words[b];return!!(C&P)},a.prototype.imaskn=function(f){i(typeof f=="number"&&f>=0);var y=f%26,b=(f-y)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=b)return this;if(y!==0&&b++,this.length=Math.min(b,this.length),y!==0){var P=67108863^67108863>>>y<<y;this.words[this.length-1]&=P}return this._strip()},a.prototype.maskn=function(f){return this.clone().imaskn(f)},a.prototype.iaddn=function(f){return i(typeof f=="number"),i(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<=f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},a.prototype._iaddn=function(f){this.words[0]+=f;for(var y=0;y<this.length&&this.words[y]>=67108864;y++)this.words[y]-=67108864,y===this.length-1?this.words[y+1]=1:this.words[y+1]++;return this.length=Math.max(this.length,y+1),this},a.prototype.isubn=function(f){if(i(typeof f=="number"),i(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var y=0;y<this.length&&this.words[y]<0;y++)this.words[y]+=67108864,this.words[y+1]-=1;return this._strip()},a.prototype.addn=function(f){return this.clone().iaddn(f)},a.prototype.subn=function(f){return this.clone().isubn(f)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(f,y,b){var P=f.length+b,C;this._expand(P);var O,B=0;for(C=0;C<f.length;C++){O=(this.words[C+b]|0)+B;var D=(f.words[C]|0)*y;O-=D&67108863,B=(O>>26)-(D/67108864|0),this.words[C+b]=O&67108863}for(;C<this.length-b;C++)O=(this.words[C+b]|0)+B,B=O>>26,this.words[C+b]=O&67108863;if(B===0)return this._strip();for(i(B===-1),B=0,C=0;C<this.length;C++)O=-(this.words[C]|0)+B,B=O>>26,this.words[C]=O&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(f,y){var b=this.length-f.length,P=this.clone(),C=f,O=C.words[C.length-1]|0,B=this._countBits(O);b=26-B,b!==0&&(C=C.ushln(b),P.iushln(b),O=C.words[C.length-1]|0);var D=P.length-C.length,g;if(y!=="mod"){g=new a(null),g.length=D+1,g.words=new Array(g.length);for(var T=0;T<g.length;T++)g.words[T]=0}var rt=P.clone()._ishlnsubmul(C,1,D);rt.negative===0&&(P=rt,g&&(g.words[D]=1));for(var lt=D-1;lt>=0;lt--){var E=(P.words[C.length+lt]|0)*67108864+(P.words[C.length+lt-1]|0);for(E=Math.min(E/O|0,67108863),P._ishlnsubmul(C,E,lt);P.negative!==0;)E--,P.negative=0,P._ishlnsubmul(C,1,lt),P.isZero()||(P.negative^=1);g&&(g.words[lt]=E)}return g&&g._strip(),P._strip(),y!=="div"&&b!==0&&P.iushrn(b),{div:g||null,mod:P}},a.prototype.divmod=function(f,y,b){if(i(!f.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var P,C,O;return this.negative!==0&&f.negative===0?(O=this.neg().divmod(f,y),y!=="mod"&&(P=O.div.neg()),y!=="div"&&(C=O.mod.neg(),b&&C.negative!==0&&C.iadd(f)),{div:P,mod:C}):this.negative===0&&f.negative!==0?(O=this.divmod(f.neg(),y),y!=="mod"&&(P=O.div.neg()),{div:P,mod:O.mod}):this.negative&f.negative?(O=this.neg().divmod(f.neg(),y),y!=="div"&&(C=O.mod.neg(),b&&C.negative!==0&&C.isub(f)),{div:O.div,mod:C}):f.length>this.length||this.cmp(f)<0?{div:new a(0),mod:this}:f.length===1?y==="div"?{div:this.divn(f.words[0]),mod:null}:y==="mod"?{div:null,mod:new a(this.modrn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new a(this.modrn(f.words[0]))}:this._wordDiv(f,y)},a.prototype.div=function(f){return this.divmod(f,"div",!1).div},a.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},a.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},a.prototype.divRound=function(f){var y=this.divmod(f);if(y.mod.isZero())return y.div;var b=y.div.negative!==0?y.mod.isub(f):y.mod,P=f.ushrn(1),C=f.andln(1),O=b.cmp(P);return O<0||C===1&&O===0?y.div:y.div.negative!==0?y.div.isubn(1):y.div.iaddn(1)},a.prototype.modrn=function(f){var y=f<0;y&&(f=-f),i(f<=67108863);for(var b=(1<<26)%f,P=0,C=this.length-1;C>=0;C--)P=(b*P+(this.words[C]|0))%f;return y?-P:P},a.prototype.modn=function(f){return this.modrn(f)},a.prototype.idivn=function(f){var y=f<0;y&&(f=-f),i(f<=67108863);for(var b=0,P=this.length-1;P>=0;P--){var C=(this.words[P]|0)+b*67108864;this.words[P]=C/f|0,b=C%f}return this._strip(),y?this.ineg():this},a.prototype.divn=function(f){return this.clone().idivn(f)},a.prototype.egcd=function(f){i(f.negative===0),i(!f.isZero());var y=this,b=f.clone();y.negative!==0?y=y.umod(f):y=y.clone();for(var P=new a(1),C=new a(0),O=new a(0),B=new a(1),D=0;y.isEven()&&b.isEven();)y.iushrn(1),b.iushrn(1),++D;for(var g=b.clone(),T=y.clone();!y.isZero();){for(var rt=0,lt=1;!(y.words[0]&lt)&&rt<26;++rt,lt<<=1);if(rt>0)for(y.iushrn(rt);rt-- >0;)(P.isOdd()||C.isOdd())&&(P.iadd(g),C.isub(T)),P.iushrn(1),C.iushrn(1);for(var E=0,tt=1;!(b.words[0]&tt)&&E<26;++E,tt<<=1);if(E>0)for(b.iushrn(E);E-- >0;)(O.isOdd()||B.isOdd())&&(O.iadd(g),B.isub(T)),O.iushrn(1),B.iushrn(1);y.cmp(b)>=0?(y.isub(b),P.isub(O),C.isub(B)):(b.isub(y),O.isub(P),B.isub(C))}return{a:O,b:B,gcd:b.iushln(D)}},a.prototype._invmp=function(f){i(f.negative===0),i(!f.isZero());var y=this,b=f.clone();y.negative!==0?y=y.umod(f):y=y.clone();for(var P=new a(1),C=new a(0),O=b.clone();y.cmpn(1)>0&&b.cmpn(1)>0;){for(var B=0,D=1;!(y.words[0]&D)&&B<26;++B,D<<=1);if(B>0)for(y.iushrn(B);B-- >0;)P.isOdd()&&P.iadd(O),P.iushrn(1);for(var g=0,T=1;!(b.words[0]&T)&&g<26;++g,T<<=1);if(g>0)for(b.iushrn(g);g-- >0;)C.isOdd()&&C.iadd(O),C.iushrn(1);y.cmp(b)>=0?(y.isub(b),P.isub(C)):(b.isub(y),C.isub(P))}var rt;return y.cmpn(1)===0?rt=P:rt=C,rt.cmpn(0)<0&&rt.iadd(f),rt},a.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var y=this.clone(),b=f.clone();y.negative=0,b.negative=0;for(var P=0;y.isEven()&&b.isEven();P++)y.iushrn(1),b.iushrn(1);do{for(;y.isEven();)y.iushrn(1);for(;b.isEven();)b.iushrn(1);var C=y.cmp(b);if(C<0){var O=y;y=b,b=O}else if(C===0||b.cmpn(1)===0)break;y.isub(b)}while(!0);return b.iushln(P)},a.prototype.invm=function(f){return this.egcd(f).a.umod(f)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(f){return this.words[0]&f},a.prototype.bincn=function(f){i(typeof f=="number");var y=f%26,b=(f-y)/26,P=1<<y;if(this.length<=b)return this._expand(b+1),this.words[b]|=P,this;for(var C=P,O=b;C!==0&&O<this.length;O++){var B=this.words[O]|0;B+=C,C=B>>>26,B&=67108863,this.words[O]=B}return C!==0&&(this.words[O]=C,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(f){var y=f<0;if(this.negative!==0&&!y)return-1;if(this.negative===0&&y)return 1;this._strip();var b;if(this.length>1)b=1;else{y&&(f=-f),i(f<=67108863,"Number is too big");var P=this.words[0]|0;b=P===f?0:P<f?-1:1}return this.negative!==0?-b|0:b},a.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var y=this.ucmp(f);return this.negative!==0?-y|0:y},a.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var y=0,b=this.length-1;b>=0;b--){var P=this.words[b]|0,C=f.words[b]|0;if(P!==C){P<C?y=-1:P>C&&(y=1);break}}return y},a.prototype.gtn=function(f){return this.cmpn(f)===1},a.prototype.gt=function(f){return this.cmp(f)===1},a.prototype.gten=function(f){return this.cmpn(f)>=0},a.prototype.gte=function(f){return this.cmp(f)>=0},a.prototype.ltn=function(f){return this.cmpn(f)===-1},a.prototype.lt=function(f){return this.cmp(f)===-1},a.prototype.lten=function(f){return this.cmpn(f)<=0},a.prototype.lte=function(f){return this.cmp(f)<=0},a.prototype.eqn=function(f){return this.cmpn(f)===0},a.prototype.eq=function(f){return this.cmp(f)===0},a.red=function(f){return new pt(f)},a.prototype.toRed=function(f){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(f){return this.red=f,this},a.prototype.forceRed=function(f){return i(!this.red,"Already a number in reduction context"),this._forceRed(f)},a.prototype.redAdd=function(f){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},a.prototype.redIAdd=function(f){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},a.prototype.redSub=function(f){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},a.prototype.redISub=function(f){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},a.prototype.redShl=function(f){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},a.prototype.redMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},a.prototype.redIMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(f){return i(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var $={k256:null,p224:null,p192:null,p25519:null};function k(f,y){this.name=f,this.p=new a(y,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var f=new a(null);return f.words=new Array(Math.ceil(this.n/13)),f},k.prototype.ireduce=function(f){var y=f,b;do this.split(y,this.tmp),y=this.imulK(y),y=y.iadd(this.tmp),b=y.bitLength();while(b>this.n);var P=b<this.n?-1:y.ucmp(this.p);return P===0?(y.words[0]=0,y.length=1):P>0?y.isub(this.p):y.strip!==void 0?y.strip():y._strip(),y},k.prototype.split=function(f,y){f.iushrn(this.n,0,y)},k.prototype.imulK=function(f){return f.imul(this.k)};function v(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(v,k),v.prototype.split=function(f,y){for(var b=4194303,P=Math.min(f.length,9),C=0;C<P;C++)y.words[C]=f.words[C];if(y.length=P,f.length<=9){f.words[0]=0,f.length=1;return}var O=f.words[9];for(y.words[y.length++]=O&b,C=10;C<f.length;C++){var B=f.words[C]|0;f.words[C-10]=(B&b)<<4|O>>>22,O=B}O>>>=22,f.words[C-10]=O,O===0&&f.length>10?f.length-=10:f.length-=9},v.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var y=0,b=0;b<f.length;b++){var P=f.words[b]|0;y+=P*977,f.words[b]=y&67108863,y=P*64+(y/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function R(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(R,k);function st(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(st,k);function dt(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(dt,k),dt.prototype.imulK=function(f){for(var y=0,b=0;b<f.length;b++){var P=(f.words[b]|0)*19+y,C=P&67108863;P>>>=26,f.words[b]=C,y=P}return y!==0&&(f.words[f.length++]=y),f},a._prime=function(f){if($[f])return $[f];var y;if(f==="k256")y=new v;else if(f==="p224")y=new R;else if(f==="p192")y=new st;else if(f==="p25519")y=new dt;else throw new Error("Unknown prime "+f);return $[f]=y,y};function pt(f){if(typeof f=="string"){var y=a._prime(f);this.m=y.p,this.prime=y}else i(f.gtn(1),"modulus must be greater than 1"),this.m=f,this.prime=null}pt.prototype._verify1=function(f){i(f.negative===0,"red works only with positives"),i(f.red,"red works only with red numbers")},pt.prototype._verify2=function(f,y){i((f.negative|y.negative)===0,"red works only with positives"),i(f.red&&f.red===y.red,"red works only with red numbers")},pt.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):(w(f,f.umod(this.m)._forceRed(this)),f)},pt.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},pt.prototype.add=function(f,y){this._verify2(f,y);var b=f.add(y);return b.cmp(this.m)>=0&&b.isub(this.m),b._forceRed(this)},pt.prototype.iadd=function(f,y){this._verify2(f,y);var b=f.iadd(y);return b.cmp(this.m)>=0&&b.isub(this.m),b},pt.prototype.sub=function(f,y){this._verify2(f,y);var b=f.sub(y);return b.cmpn(0)<0&&b.iadd(this.m),b._forceRed(this)},pt.prototype.isub=function(f,y){this._verify2(f,y);var b=f.isub(y);return b.cmpn(0)<0&&b.iadd(this.m),b},pt.prototype.shl=function(f,y){return this._verify1(f),this.imod(f.ushln(y))},pt.prototype.imul=function(f,y){return this._verify2(f,y),this.imod(f.imul(y))},pt.prototype.mul=function(f,y){return this._verify2(f,y),this.imod(f.mul(y))},pt.prototype.isqr=function(f){return this.imul(f,f.clone())},pt.prototype.sqr=function(f){return this.mul(f,f)},pt.prototype.sqrt=function(f){if(f.isZero())return f.clone();var y=this.m.andln(3);if(i(y%2===1),y===3){var b=this.m.add(new a(1)).iushrn(2);return this.pow(f,b)}for(var P=this.m.subn(1),C=0;!P.isZero()&&P.andln(1)===0;)C++,P.iushrn(1);i(!P.isZero());var O=new a(1).toRed(this),B=O.redNeg(),D=this.m.subn(1).iushrn(1),g=this.m.bitLength();for(g=new a(2*g*g).toRed(this);this.pow(g,D).cmp(B)!==0;)g.redIAdd(B);for(var T=this.pow(g,P),rt=this.pow(f,P.addn(1).iushrn(1)),lt=this.pow(f,P),E=C;lt.cmp(O)!==0;){for(var tt=lt,L=0;tt.cmp(O)!==0;L++)tt=tt.redSqr();i(L<E);var q=this.pow(T,new a(1).iushln(E-L-1));rt=rt.redMul(q),T=q.redSqr(),lt=lt.redMul(T),E=L}return rt},pt.prototype.invm=function(f){var y=f._invmp(this.m);return y.negative!==0?(y.negative=0,this.imod(y).redNeg()):this.imod(y)},pt.prototype.pow=function(f,y){if(y.isZero())return new a(1).toRed(this);if(y.cmpn(1)===0)return f.clone();var b=4,P=new Array(1<<b);P[0]=new a(1).toRed(this),P[1]=f;for(var C=2;C<P.length;C++)P[C]=this.mul(P[C-1],f);var O=P[0],B=0,D=0,g=y.bitLength()%26;for(g===0&&(g=26),C=y.length-1;C>=0;C--){for(var T=y.words[C],rt=g-1;rt>=0;rt--){var lt=T>>rt&1;if(O!==P[0]&&(O=this.sqr(O)),lt===0&&B===0){D=0;continue}B<<=1,B|=lt,D++,!(D!==b&&(C!==0||rt!==0))&&(O=this.mul(O,P[B]),D=0,B=0)}g=26}return O},pt.prototype.convertTo=function(f){var y=f.umod(this.m);return y===f?y.clone():y},pt.prototype.convertFrom=function(f){var y=f.clone();return y.red=null,y},a.mont=function(f){return new yt(f)};function yt(f){pt.call(this,f),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(yt,pt),yt.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},yt.prototype.convertFrom=function(f){var y=this.imod(f.mul(this.rinv));return y.red=null,y},yt.prototype.imul=function(f,y){if(f.isZero()||y.isZero())return f.words[0]=0,f.length=1,f;var b=f.imul(y),P=b.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=b.isub(P).iushrn(this.shift),O=C;return C.cmp(this.m)>=0?O=C.isub(this.m):C.cmpn(0)<0&&(O=C.iadd(this.m)),O._forceRed(this)},yt.prototype.mul=function(f,y){if(f.isZero()||y.isZero())return new a(0)._forceRed(this);var b=f.mul(y),P=b.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=b.isub(P).iushrn(this.shift),O=C;return C.cmp(this.m)>=0?O=C.isub(this.m):C.cmpn(0)<0&&(O=C.iadd(this.m)),O._forceRed(this)},yt.prototype.invm=function(f){var y=this.imod(f._invmp(this.m).mul(this.r2));return y._forceRed(this)}})(r,K1)})(Y1);var ne=Y1.exports;const J1="bignumber/5.7.0";var yu=ne.BN;const Rn=new _r(J1),ol={},I0=9007199254740991;function J8(r){return r!=null&&(ze.isBigNumber(r)||typeof r=="number"&&r%1===0||typeof r=="string"&&!!r.match(/^-?[0-9]+$/)||ni(r)||typeof r=="bigint"||Do(r))}let D0=!1;class ze{constructor(t,e){t!==ol&&Rn.throwError("cannot call constructor directly; use BigNumber.from",_r.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=e,this._isBigNumber=!0,Object.freeze(this)}fromTwos(t){return Hr(ve(this).fromTwos(t))}toTwos(t){return Hr(ve(this).toTwos(t))}abs(){return this._hex[0]==="-"?ze.from(this._hex.substring(1)):this}add(t){return Hr(ve(this).add(ve(t)))}sub(t){return Hr(ve(this).sub(ve(t)))}div(t){return ze.from(t).isZero()&&bi("division-by-zero","div"),Hr(ve(this).div(ve(t)))}mul(t){return Hr(ve(this).mul(ve(t)))}mod(t){const e=ve(t);return e.isNeg()&&bi("division-by-zero","mod"),Hr(ve(this).umod(e))}pow(t){const e=ve(t);return e.isNeg()&&bi("negative-power","pow"),Hr(ve(this).pow(e))}and(t){const e=ve(t);return(this.isNegative()||e.isNeg())&&bi("unbound-bitwise-result","and"),Hr(ve(this).and(e))}or(t){const e=ve(t);return(this.isNegative()||e.isNeg())&&bi("unbound-bitwise-result","or"),Hr(ve(this).or(e))}xor(t){const e=ve(t);return(this.isNegative()||e.isNeg())&&bi("unbound-bitwise-result","xor"),Hr(ve(this).xor(e))}mask(t){return(this.isNegative()||t<0)&&bi("negative-width","mask"),Hr(ve(this).maskn(t))}shl(t){return(this.isNegative()||t<0)&&bi("negative-width","shl"),Hr(ve(this).shln(t))}shr(t){return(this.isNegative()||t<0)&&bi("negative-width","shr"),Hr(ve(this).shrn(t))}eq(t){return ve(this).eq(ve(t))}lt(t){return ve(this).lt(ve(t))}lte(t){return ve(this).lte(ve(t))}gt(t){return ve(this).gt(ve(t))}gte(t){return ve(this).gte(ve(t))}isNegative(){return this._hex[0]==="-"}isZero(){return ve(this).isZero()}toNumber(){try{return ve(this).toNumber()}catch{bi("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Rn.throwError("this platform does not support BigInt",_r.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?D0||(D0=!0,Rn.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Rn.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",_r.errors.UNEXPECTED_ARGUMENT,{}):Rn.throwError("BigNumber.toString does not accept parameters",_r.errors.UNEXPECTED_ARGUMENT,{})),ve(this).toString(10)}toHexString(){return this._hex}toJSON(t){return{type:"BigNumber",hex:this.toHexString()}}static from(t){if(t instanceof ze)return t;if(typeof t=="string")return t.match(/^-?0x[0-9a-f]+$/i)?new ze(ol,Sa(t)):t.match(/^-?[0-9]+$/)?new ze(ol,Sa(new yu(t))):Rn.throwArgumentError("invalid BigNumber string","value",t);if(typeof t=="number")return t%1&&bi("underflow","BigNumber.from",t),(t>=I0||t<=-I0)&&bi("overflow","BigNumber.from",t),ze.from(String(t));const e=t;if(typeof e=="bigint")return ze.from(e.toString());if(Do(e))return ze.from(Gr(e));if(e)if(e.toHexString){const i=e.toHexString();if(typeof i=="string")return ze.from(i)}else{let i=e._hex;if(i==null&&e.type==="BigNumber"&&(i=e.hex),typeof i=="string"&&(ni(i)||i[0]==="-"&&ni(i.substring(1))))return ze.from(i)}return Rn.throwArgumentError("invalid BigNumber value","value",t)}static isBigNumber(t){return!!(t&&t._isBigNumber)}}function Sa(r){if(typeof r!="string")return Sa(r.toString(16));if(r[0]==="-")return r=r.substring(1),r[0]==="-"&&Rn.throwArgumentError("invalid hex","value",r),r=Sa(r),r==="0x00"?r:"-"+r;if(r.substring(0,2)!=="0x"&&(r="0x"+r),r==="0x")return"0x00";for(r.length%2&&(r="0x0"+r.substring(2));r.length>4&&r.substring(0,4)==="0x00";)r="0x"+r.substring(4);return r}function Hr(r){return ze.from(Sa(r))}function ve(r){const t=ze.from(r).toHexString();return t[0]==="-"?new yu("-"+t.substring(3),16):new yu(t.substring(2),16)}function bi(r,t,e){const i={fault:r,operation:t};return e!=null&&(i.value=e),Rn.throwError(r,_r.errors.NUMERIC_FAULT,i)}function Q8(r){return new yu(r,36).toString(16)}const Ur=new _r(J1),ga={},Q1=ze.from(0),X1=ze.from(-1);function Z1(r,t,e,i){const s={fault:t,operation:e};return i!==void 0&&(s.value=i),Ur.throwError(r,_r.errors.NUMERIC_FAULT,s)}let ma="0";for(;ma.length<256;)ma+=ma;function yf(r){if(typeof r!="number")try{r=ze.from(r).toNumber()}catch{}return typeof r=="number"&&r>=0&&r<=256&&!(r%1)?"1"+ma.substring(0,r):Ur.throwArgumentError("invalid decimal size","decimals",r)}function al(r,t){t==null&&(t=0);const e=yf(t);r=ze.from(r);const i=r.lt(Q1);i&&(r=r.mul(X1));let s=r.mod(e).toString();for(;s.length<e.length-1;)s="0"+s;s=s.match(/^([0-9]*[1-9]|0)(0*)/)[1];const a=r.div(e).toString();return e.length===1?r=a:r=a+"."+s,i&&(r="-"+r),r}function Nn(r,t){t==null&&(t=0);const e=yf(t);(typeof r!="string"||!r.match(/^-?[0-9.]+$/))&&Ur.throwArgumentError("invalid decimal value","value",r);const i=r.substring(0,1)==="-";i&&(r=r.substring(1)),r==="."&&Ur.throwArgumentError("missing value","value",r);const s=r.split(".");s.length>2&&Ur.throwArgumentError("too many decimal points","value",r);let a=s[0],u=s[1];for(a||(a="0"),u||(u="0");u[u.length-1]==="0";)u=u.substring(0,u.length-1);for(u.length>e.length-1&&Z1("fractional component exceeds decimals","underflow","parseFixed"),u===""&&(u="0");u.length<e.length-1;)u+="0";const h=ze.from(a),d=ze.from(u);let l=h.mul(e).add(d);return i&&(l=l.mul(X1)),l}let cl=class Vl{constructor(t,e,i,s){t!==ga&&Ur.throwError("cannot use FixedFormat constructor; use FixedFormat.from",_r.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=e,this.width=i,this.decimals=s,this.name=(e?"":"u")+"fixed"+String(i)+"x"+String(s),this._multiplier=yf(s),Object.freeze(this)}static from(t){if(t instanceof Vl)return t;typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,i=128,s=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const a=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);a||Ur.throwArgumentError("invalid fixed format","format",t),e=a[1]!=="u",i=parseInt(a[2]),s=parseInt(a[3])}}else if(t){const a=(u,h,d)=>t[u]==null?d:(typeof t[u]!==h&&Ur.throwArgumentError("invalid fixed format ("+u+" not "+h+")","format."+u,t[u]),t[u]);e=a("signed","boolean",e),i=a("width","number",i),s=a("decimals","number",s)}return i%8&&Ur.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",i),s>80&&Ur.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",s),new Vl(ga,e,i,s)}},tm=class Rr{constructor(t,e,i,s){t!==ga&&Ur.throwError("cannot use FixedNumber constructor; use FixedNumber.from",_r.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=s,this._hex=e,this._value=i,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(t){this.format.name!==t.format.name&&Ur.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",t)}addUnsafe(t){this._checkFormat(t);const e=Nn(this._value,this.format.decimals),i=Nn(t._value,t.format.decimals);return Rr.fromValue(e.add(i),this.format.decimals,this.format)}subUnsafe(t){this._checkFormat(t);const e=Nn(this._value,this.format.decimals),i=Nn(t._value,t.format.decimals);return Rr.fromValue(e.sub(i),this.format.decimals,this.format)}mulUnsafe(t){this._checkFormat(t);const e=Nn(this._value,this.format.decimals),i=Nn(t._value,t.format.decimals);return Rr.fromValue(e.mul(i).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(t){this._checkFormat(t);const e=Nn(this._value,this.format.decimals),i=Nn(t._value,t.format.decimals);return Rr.fromValue(e.mul(this.format._multiplier).div(i),this.format.decimals,this.format)}floor(){const t=this.toString().split(".");t.length===1&&t.push("0");let e=Rr.from(t[0],this.format);const i=!t[1].match(/^(0*)$/);return this.isNegative()&&i&&(e=e.subUnsafe(x0.toFormat(e.format))),e}ceiling(){const t=this.toString().split(".");t.length===1&&t.push("0");let e=Rr.from(t[0],this.format);const i=!t[1].match(/^(0*)$/);return!this.isNegative()&&i&&(e=e.addUnsafe(x0.toFormat(e.format))),e}round(t){t==null&&(t=0);const e=this.toString().split(".");if(e.length===1&&e.push("0"),(t<0||t>80||t%1)&&Ur.throwArgumentError("invalid decimal count","decimals",t),e[1].length<=t)return this;const i=Rr.from("1"+ma.substring(0,t),this.format),s=X8.toFormat(this.format);return this.mulUnsafe(i).addUnsafe(s).floor().divUnsafe(i)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(t){if(t==null)return this._hex;t%8&&Ur.throwArgumentError("invalid byte width","width",t);const e=ze.from(this._hex).fromTwos(this.format.width).toTwos(t).toHexString();return fn(e,t/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return Rr.fromString(this._value,t)}static fromValue(t,e,i){return i==null&&e!=null&&!J8(e)&&(i=e,e=null),e==null&&(e=0),i==null&&(i="fixed"),Rr.fromString(al(t,e),cl.from(i))}static fromString(t,e){e==null&&(e="fixed");const i=cl.from(e),s=Nn(t,i.decimals);!i.signed&&s.lt(Q1)&&Z1("unsigned value cannot be negative","overflow","value",t);let a=null;i.signed?a=s.toTwos(i.width).toHexString():(a=s.toHexString(),a=fn(a,i.width/8));const u=al(s,i.decimals);return new Rr(ga,a,u,i)}static fromBytes(t,e){e==null&&(e="fixed");const i=cl.from(e);if(Ze(t).length>i.width/8)throw new Error("overflow");let s=ze.from(t);i.signed&&(s=s.fromTwos(i.width));const a=s.toTwos((i.signed?0:1)+i.width).toHexString(),u=al(s,i.decimals);return new Rr(ga,a,u,i)}static from(t,e){if(typeof t=="string")return Rr.fromString(t,e);if(Do(t))return Rr.fromBytes(t,e);try{return Rr.fromValue(t,0,e)}catch(i){if(i.code!==_r.errors.INVALID_ARGUMENT)throw i}return Ur.throwArgumentError("invalid FixedNumber value","value",t)}static isFixedNumber(t){return!!(t&&t._isFixedNumber)}};const x0=tm.from(1),X8=tm.from("0.5"),Z8="strings/5.7.0",t4=new _r(Z8);var wu;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(wu||(wu={}));var M0;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(M0||(M0={}));function ul(r,t=wu.current){t!=wu.current&&(t4.checkNormalize(),r=r.normalize(t));let e=[];for(let i=0;i<r.length;i++){const s=r.charCodeAt(i);if(s<128)e.push(s);else if(s<2048)e.push(s>>6|192),e.push(s&63|128);else if((s&64512)==55296){i++;const a=r.charCodeAt(i);if(i>=r.length||(a&64512)!==56320)throw new Error("invalid utf-8 string");const u=65536+((s&1023)<<10)+(a&1023);e.push(u>>18|240),e.push(u>>12&63|128),e.push(u>>6&63|128),e.push(u&63|128)}else e.push(s>>12|224),e.push(s>>6&63|128),e.push(s&63|128)}return Ze(e)}function e4(r){if(r.length%4!==0)throw new Error("bad data");let t=[];for(let e=0;e<r.length;e+=4)t.push(parseInt(r.substring(e,e+4),16));return t}function hl(r,t){t||(t=function(s){return[parseInt(s,16)]});let e=0,i={};return r.split(",").forEach(s=>{let a=s.split(":");e+=parseInt(a[0],16),i[e]=t(a[1])}),i}function P0(r){let t=0;return r.split(",").map(e=>{let i=e.split("-");i.length===1?i[1]="0":i[1]===""&&(i[1]="1");let s=t+parseInt(i[0],16);return t=parseInt(i[1],16),{l:s,h:t}})}P0("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),"ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(r=>parseInt(r,16)),hl("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),hl("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),hl("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",e4),P0("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function r4(r){r=atob(r);const t=[];for(let e=0;e<r.length;e++)t.push(r.charCodeAt(e));return Ze(t)}function em(r,t){t==null&&(t=1);const e=[],i=e.forEach,s=function(a,u){i.call(a,function(h){u>0&&Array.isArray(h)?s(h,u-1):e.push(h)})};return s(r,t),e}function i4(r){const t={};for(let e=0;e<r.length;e++){const i=r[e];t[i[0]]=i[1]}return t}function n4(r){let t=0;function e(){return r[t++]<<8|r[t++]}let i=e(),s=1,a=[0,1];for(let $=1;$<i;$++)a.push(s+=e());let u=e(),h=t;t+=u;let d=0,l=0;function w(){return d==0&&(l=l<<8|r[t++],d=8),l>>--d&1}const _=31,I=Math.pow(2,_),S=I>>>1,M=S>>1,G=I-1;let V=0;for(let $=0;$<_;$++)V=V<<1|w();let Z=[],H=0,W=I;for(;;){let $=Math.floor(((V-H+1)*s-1)/W),k=0,v=i;for(;v-k>1;){let dt=k+v>>>1;$<a[dt]?v=dt:k=dt}if(k==0)break;Z.push(k);let R=H+Math.floor(W*a[k]/s),st=H+Math.floor(W*a[k+1]/s)-1;for(;!((R^st)&S);)V=V<<1&G|w(),R=R<<1&G,st=st<<1&G|1;for(;R&~st&M;)V=V&S|V<<1&G>>>1|w(),R=R<<1^S,st=(st^S)<<1|S|1;H=R,W=1+st-R}let U=i-4;return Z.map($=>{switch($-U){case 3:return U+65792+(r[h++]<<16|r[h++]<<8|r[h++]);case 2:return U+256+(r[h++]<<8|r[h++]);case 1:return U+r[h++];default:return $-1}})}function s4(r){let t=0;return()=>r[t++]}function o4(r){return s4(n4(r))}function a4(r){return r&1?~r>>1:r>>1}function c4(r,t){let e=Array(r);for(let i=0;i<r;i++)e[i]=1+t();return e}function C0(r,t){let e=Array(r);for(let i=0,s=-1;i<r;i++)e[i]=s+=1+t();return e}function u4(r,t){let e=Array(r);for(let i=0,s=0;i<r;i++)e[i]=s+=a4(t());return e}function bu(r,t){let e=C0(r(),r),i=r(),s=C0(i,r),a=c4(i,r);for(let u=0;u<i;u++)for(let h=0;h<a[u];h++)e.push(s[u]+h);return t?e.map(u=>t[u]):e}function h4(r){let t=[];for(;;){let e=r();if(e==0)break;t.push(f4(e,r))}for(;;){let e=r()-1;if(e<0)break;t.push(d4(e,r))}return i4(em(t))}function l4(r){let t=[];for(;;){let e=r();if(e==0)break;t.push(e)}return t}function rm(r,t,e){let i=Array(r).fill(void 0).map(()=>[]);for(let s=0;s<t;s++)u4(r,e).forEach((a,u)=>i[u].push(a));return i}function f4(r,t){let e=1+t(),i=t(),s=l4(t),a=rm(s.length,1+r,t);return em(a.map((u,h)=>{const d=u[0],l=u.slice(1);return Array(s[h]).fill(void 0).map((w,_)=>{let I=_*i;return[d+_*e,l.map(S=>S+I)]})}))}function d4(r,t){let e=1+t();return rm(e,1+r,t).map(i=>[i[0],i.slice(1)])}function p4(r){let t=bu(r).sort((i,s)=>i-s);return e();function e(){let i=[];for(;;){let l=bu(r,t);if(l.length==0)break;i.push({set:new Set(l),node:e()})}i.sort((l,w)=>w.set.size-l.set.size);let s=r(),a=s%3;s=s/3|0;let u=!!(s&1);s>>=1;let h=s==1,d=s==2;return{branches:i,valid:a,fe0f:u,save:h,check:d}}}function g4(){return o4(r4("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const Kc=g4();new Set(bu(Kc)),new Set(bu(Kc)),h4(Kc),p4(Kc);const m4=new Uint8Array(32);m4.fill(0);const v4=`Ethereum Signed Message:
`;function im(r){return typeof r=="string"&&(r=ul(r)),vf(H8([ul(v4),ul(String(r.length)),r]))}const y4="address/5.7.0",ha=new _r(y4);function O0(r){ni(r,20)||ha.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const t=r.substring(2).split(""),e=new Uint8Array(40);for(let s=0;s<40;s++)e[s]=t[s].charCodeAt(0);const i=Ze(vf(e));for(let s=0;s<40;s+=2)i[s>>1]>>4>=8&&(t[s]=t[s].toUpperCase()),(i[s>>1]&15)>=8&&(t[s+1]=t[s+1].toUpperCase());return"0x"+t.join("")}const w4=9007199254740991;function b4(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const wf={};for(let r=0;r<10;r++)wf[String(r)]=String(r);for(let r=0;r<26;r++)wf[String.fromCharCode(65+r)]=String(10+r);const N0=Math.floor(b4(w4));function _4(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let t=r.split("").map(i=>wf[i]).join("");for(;t.length>=N0;){let i=t.substring(0,N0);t=parseInt(i,10)%97+t.substring(i.length)}let e=String(98-parseInt(t,10)%97);for(;e.length<2;)e="0"+e;return e}function E4(r){let t=null;if(typeof r!="string"&&ha.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),t=O0(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==r&&ha.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==_4(r)&&ha.throwArgumentError("bad icap checksum","address",r),t=Q8(r.substring(4));t.length<40;)t="0"+t;t=O0("0x"+t)}else ha.throwArgumentError("invalid address","address",r);return t}function ta(r,t,e){Object.defineProperty(r,t,{enumerable:!0,value:e,writable:!1})}const A4=new Uint8Array(32);A4.fill(0),ze.from(-1);const S4=ze.from(0),I4=ze.from(1);ze.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),fn(I4.toHexString(),32),fn(S4.toHexString(),32);var nn={},ye={},Ua=nm;function nm(r,t){if(!r)throw new Error(t||"Assertion failed")}nm.equal=function(r,t,e){if(r!=t)throw new Error(e||"Assertion failed: "+r+" != "+t)};var Gl={exports:{}};typeof Object.create=="function"?Gl.exports=function(r,t){t&&(r.super_=t,r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:Gl.exports=function(r,t){if(t){r.super_=t;var e=function(){};e.prototype=t.prototype,r.prototype=new e,r.prototype.constructor=r}};var D4=Ua,x4=Gl.exports;ye.inherits=x4;function M4(r,t){return(r.charCodeAt(t)&64512)!==55296||t<0||t+1>=r.length?!1:(r.charCodeAt(t+1)&64512)===56320}function P4(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var e=[];if(typeof r=="string")if(t){if(t==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),s=0;s<r.length;s+=2)e.push(parseInt(r[s]+r[s+1],16))}else for(var i=0,s=0;s<r.length;s++){var a=r.charCodeAt(s);a<128?e[i++]=a:a<2048?(e[i++]=a>>6|192,e[i++]=a&63|128):M4(r,s)?(a=65536+((a&1023)<<10)+(r.charCodeAt(++s)&1023),e[i++]=a>>18|240,e[i++]=a>>12&63|128,e[i++]=a>>6&63|128,e[i++]=a&63|128):(e[i++]=a>>12|224,e[i++]=a>>6&63|128,e[i++]=a&63|128)}else for(s=0;s<r.length;s++)e[s]=r[s]|0;return e}ye.toArray=P4;function C4(r){for(var t="",e=0;e<r.length;e++)t+=om(r[e].toString(16));return t}ye.toHex=C4;function sm(r){var t=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return t>>>0}ye.htonl=sm;function O4(r,t){for(var e="",i=0;i<r.length;i++){var s=r[i];t==="little"&&(s=sm(s)),e+=am(s.toString(16))}return e}ye.toHex32=O4;function om(r){return r.length===1?"0"+r:r}ye.zero2=om;function am(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}ye.zero8=am;function N4(r,t,e,i){var s=e-t;D4(s%4===0);for(var a=new Array(s/4),u=0,h=t;u<a.length;u++,h+=4){var d;i==="big"?d=r[h]<<24|r[h+1]<<16|r[h+2]<<8|r[h+3]:d=r[h+3]<<24|r[h+2]<<16|r[h+1]<<8|r[h],a[u]=d>>>0}return a}ye.join32=N4;function T4(r,t){for(var e=new Array(r.length*4),i=0,s=0;i<r.length;i++,s+=4){var a=r[i];t==="big"?(e[s]=a>>>24,e[s+1]=a>>>16&255,e[s+2]=a>>>8&255,e[s+3]=a&255):(e[s+3]=a>>>24,e[s+2]=a>>>16&255,e[s+1]=a>>>8&255,e[s]=a&255)}return e}ye.split32=T4;function R4(r,t){return r>>>t|r<<32-t}ye.rotr32=R4;function F4(r,t){return r<<t|r>>>32-t}ye.rotl32=F4;function U4(r,t){return r+t>>>0}ye.sum32=U4;function L4(r,t,e){return r+t+e>>>0}ye.sum32_3=L4;function B4(r,t,e,i){return r+t+e+i>>>0}ye.sum32_4=B4;function q4(r,t,e,i,s){return r+t+e+i+s>>>0}ye.sum32_5=q4;function j4(r,t,e,i){var s=r[t],a=r[t+1],u=i+a>>>0,h=(u<i?1:0)+e+s;r[t]=h>>>0,r[t+1]=u}ye.sum64=j4;function $4(r,t,e,i){var s=t+i>>>0,a=(s<t?1:0)+r+e;return a>>>0}ye.sum64_hi=$4;function k4(r,t,e,i){var s=t+i;return s>>>0}ye.sum64_lo=k4;function z4(r,t,e,i,s,a,u,h){var d=0,l=t;l=l+i>>>0,d+=l<t?1:0,l=l+a>>>0,d+=l<a?1:0,l=l+h>>>0,d+=l<h?1:0;var w=r+e+s+u+d;return w>>>0}ye.sum64_4_hi=z4;function H4(r,t,e,i,s,a,u,h){var d=t+i+a+h;return d>>>0}ye.sum64_4_lo=H4;function K4(r,t,e,i,s,a,u,h,d,l){var w=0,_=t;_=_+i>>>0,w+=_<t?1:0,_=_+a>>>0,w+=_<a?1:0,_=_+h>>>0,w+=_<h?1:0,_=_+l>>>0,w+=_<l?1:0;var I=r+e+s+u+d+w;return I>>>0}ye.sum64_5_hi=K4;function V4(r,t,e,i,s,a,u,h,d,l){var w=t+i+a+h+l;return w>>>0}ye.sum64_5_lo=V4;function G4(r,t,e){var i=t<<32-e|r>>>e;return i>>>0}ye.rotr64_hi=G4;function W4(r,t,e){var i=r<<32-e|t>>>e;return i>>>0}ye.rotr64_lo=W4;function Y4(r,t,e){return r>>>e}ye.shr64_hi=Y4;function J4(r,t,e){var i=r<<32-e|t>>>e;return i>>>0}ye.shr64_lo=J4;var xo={},T0=ye,Q4=Ua;function Vc(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}xo.BlockHash=Vc,Vc.prototype.update=function(r,t){if(r=T0.toArray(r,t),this.pending?this.pending=this.pending.concat(r):this.pending=r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){r=this.pending;var e=r.length%this._delta8;this.pending=r.slice(r.length-e,r.length),this.pending.length===0&&(this.pending=null),r=T0.join32(r,0,r.length-e,this.endian);for(var i=0;i<r.length;i+=this._delta32)this._update(r,i,i+this._delta32)}return this},Vc.prototype.digest=function(r){return this.update(this._pad()),Q4(this.pending===null),this._digest(r)},Vc.prototype._pad=function(){var r=this.pendingTotal,t=this._delta8,e=t-(r+this.padLength)%t,i=new Array(e+this.padLength);i[0]=128;for(var s=1;s<e;s++)i[s]=0;if(r<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=r>>>24&255,i[s++]=r>>>16&255,i[s++]=r>>>8&255,i[s++]=r&255}else for(i[s++]=r&255,i[s++]=r>>>8&255,i[s++]=r>>>16&255,i[s++]=r>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,a=8;a<this.padLength;a++)i[s++]=0;return i};var mo={},yn={},X4=ye,dn=X4.rotr32;function Z4(r,t,e,i){if(r===0)return cm(t,e,i);if(r===1||r===3)return hm(t,e,i);if(r===2)return um(t,e,i)}yn.ft_1=Z4;function cm(r,t,e){return r&t^~r&e}yn.ch32=cm;function um(r,t,e){return r&t^r&e^t&e}yn.maj32=um;function hm(r,t,e){return r^t^e}yn.p32=hm;function tS(r){return dn(r,2)^dn(r,13)^dn(r,22)}yn.s0_256=tS;function eS(r){return dn(r,6)^dn(r,11)^dn(r,25)}yn.s1_256=eS;function rS(r){return dn(r,7)^dn(r,18)^r>>>3}yn.g0_256=rS;function iS(r){return dn(r,17)^dn(r,19)^r>>>10}yn.g1_256=iS;var Eo=ye,nS=xo,sS=yn,ll=Eo.rotl32,ea=Eo.sum32,oS=Eo.sum32_5,aS=sS.ft_1,lm=nS.BlockHash,cS=[1518500249,1859775393,2400959708,3395469782];function cn(){if(!(this instanceof cn))return new cn;lm.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Eo.inherits(cn,lm);var uS=cn;cn.blockSize=512,cn.outSize=160,cn.hmacStrength=80,cn.padLength=64,cn.prototype._update=function(r,t){for(var e=this.W,i=0;i<16;i++)e[i]=r[t+i];for(;i<e.length;i++)e[i]=ll(e[i-3]^e[i-8]^e[i-14]^e[i-16],1);var s=this.h[0],a=this.h[1],u=this.h[2],h=this.h[3],d=this.h[4];for(i=0;i<e.length;i++){var l=~~(i/20),w=oS(ll(s,5),aS(l,a,u,h),d,e[i],cS[l]);d=h,h=u,u=ll(a,30),a=s,s=w}this.h[0]=ea(this.h[0],s),this.h[1]=ea(this.h[1],a),this.h[2]=ea(this.h[2],u),this.h[3]=ea(this.h[3],h),this.h[4]=ea(this.h[4],d)},cn.prototype._digest=function(r){return r==="hex"?Eo.toHex32(this.h,"big"):Eo.split32(this.h,"big")};var Ao=ye,hS=xo,Mo=yn,lS=Ua,Fi=Ao.sum32,fS=Ao.sum32_4,dS=Ao.sum32_5,pS=Mo.ch32,gS=Mo.maj32,mS=Mo.s0_256,vS=Mo.s1_256,yS=Mo.g0_256,wS=Mo.g1_256,fm=hS.BlockHash,bS=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function un(){if(!(this instanceof un))return new un;fm.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=bS,this.W=new Array(64)}Ao.inherits(un,fm);var dm=un;un.blockSize=512,un.outSize=256,un.hmacStrength=192,un.padLength=64,un.prototype._update=function(r,t){for(var e=this.W,i=0;i<16;i++)e[i]=r[t+i];for(;i<e.length;i++)e[i]=fS(wS(e[i-2]),e[i-7],yS(e[i-15]),e[i-16]);var s=this.h[0],a=this.h[1],u=this.h[2],h=this.h[3],d=this.h[4],l=this.h[5],w=this.h[6],_=this.h[7];for(lS(this.k.length===e.length),i=0;i<e.length;i++){var I=dS(_,vS(d),pS(d,l,w),this.k[i],e[i]),S=Fi(mS(s),gS(s,a,u));_=w,w=l,l=d,d=Fi(h,I),h=u,u=a,a=s,s=Fi(I,S)}this.h[0]=Fi(this.h[0],s),this.h[1]=Fi(this.h[1],a),this.h[2]=Fi(this.h[2],u),this.h[3]=Fi(this.h[3],h),this.h[4]=Fi(this.h[4],d),this.h[5]=Fi(this.h[5],l),this.h[6]=Fi(this.h[6],w),this.h[7]=Fi(this.h[7],_)},un.prototype._digest=function(r){return r==="hex"?Ao.toHex32(this.h,"big"):Ao.split32(this.h,"big")};var Wl=ye,pm=dm;function Un(){if(!(this instanceof Un))return new Un;pm.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Wl.inherits(Un,pm);var _S=Un;Un.blockSize=512,Un.outSize=224,Un.hmacStrength=192,Un.padLength=64,Un.prototype._digest=function(r){return r==="hex"?Wl.toHex32(this.h.slice(0,7),"big"):Wl.split32(this.h.slice(0,7),"big")};var Yr=ye,ES=xo,AS=Ua,pn=Yr.rotr64_hi,gn=Yr.rotr64_lo,gm=Yr.shr64_hi,mm=Yr.shr64_lo,Xn=Yr.sum64,fl=Yr.sum64_hi,dl=Yr.sum64_lo,SS=Yr.sum64_4_hi,IS=Yr.sum64_4_lo,DS=Yr.sum64_5_hi,xS=Yr.sum64_5_lo,vm=ES.BlockHash,MS=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ji(){if(!(this instanceof ji))return new ji;vm.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=MS,this.W=new Array(160)}Yr.inherits(ji,vm);var ym=ji;ji.blockSize=1024,ji.outSize=512,ji.hmacStrength=192,ji.padLength=128,ji.prototype._prepareBlock=function(r,t){for(var e=this.W,i=0;i<32;i++)e[i]=r[t+i];for(;i<e.length;i+=2){var s=qS(e[i-4],e[i-3]),a=jS(e[i-4],e[i-3]),u=e[i-14],h=e[i-13],d=LS(e[i-30],e[i-29]),l=BS(e[i-30],e[i-29]),w=e[i-32],_=e[i-31];e[i]=SS(s,a,u,h,d,l,w,_),e[i+1]=IS(s,a,u,h,d,l,w,_)}},ji.prototype._update=function(r,t){this._prepareBlock(r,t);var e=this.W,i=this.h[0],s=this.h[1],a=this.h[2],u=this.h[3],h=this.h[4],d=this.h[5],l=this.h[6],w=this.h[7],_=this.h[8],I=this.h[9],S=this.h[10],M=this.h[11],G=this.h[12],V=this.h[13],Z=this.h[14],H=this.h[15];AS(this.k.length===e.length);for(var W=0;W<e.length;W+=2){var U=Z,$=H,k=FS(_,I),v=US(_,I),R=PS(_,I,S,M,G),st=CS(_,I,S,M,G,V),dt=this.k[W],pt=this.k[W+1],yt=e[W],f=e[W+1],y=DS(U,$,k,v,R,st,dt,pt,yt,f),b=xS(U,$,k,v,R,st,dt,pt,yt,f);U=TS(i,s),$=RS(i,s),k=OS(i,s,a,u,h),v=NS(i,s,a,u,h,d);var P=fl(U,$,k,v),C=dl(U,$,k,v);Z=G,H=V,G=S,V=M,S=_,M=I,_=fl(l,w,y,b),I=dl(w,w,y,b),l=h,w=d,h=a,d=u,a=i,u=s,i=fl(y,b,P,C),s=dl(y,b,P,C)}Xn(this.h,0,i,s),Xn(this.h,2,a,u),Xn(this.h,4,h,d),Xn(this.h,6,l,w),Xn(this.h,8,_,I),Xn(this.h,10,S,M),Xn(this.h,12,G,V),Xn(this.h,14,Z,H)},ji.prototype._digest=function(r){return r==="hex"?Yr.toHex32(this.h,"big"):Yr.split32(this.h,"big")};function PS(r,t,e,i,s){var a=r&e^~r&s;return a<0&&(a+=4294967296),a}function CS(r,t,e,i,s,a){var u=t&i^~t&a;return u<0&&(u+=4294967296),u}function OS(r,t,e,i,s){var a=r&e^r&s^e&s;return a<0&&(a+=4294967296),a}function NS(r,t,e,i,s,a){var u=t&i^t&a^i&a;return u<0&&(u+=4294967296),u}function TS(r,t){var e=pn(r,t,28),i=pn(t,r,2),s=pn(t,r,7),a=e^i^s;return a<0&&(a+=4294967296),a}function RS(r,t){var e=gn(r,t,28),i=gn(t,r,2),s=gn(t,r,7),a=e^i^s;return a<0&&(a+=4294967296),a}function FS(r,t){var e=pn(r,t,14),i=pn(r,t,18),s=pn(t,r,9),a=e^i^s;return a<0&&(a+=4294967296),a}function US(r,t){var e=gn(r,t,14),i=gn(r,t,18),s=gn(t,r,9),a=e^i^s;return a<0&&(a+=4294967296),a}function LS(r,t){var e=pn(r,t,1),i=pn(r,t,8),s=gm(r,t,7),a=e^i^s;return a<0&&(a+=4294967296),a}function BS(r,t){var e=gn(r,t,1),i=gn(r,t,8),s=mm(r,t,7),a=e^i^s;return a<0&&(a+=4294967296),a}function qS(r,t){var e=pn(r,t,19),i=pn(t,r,29),s=gm(r,t,6),a=e^i^s;return a<0&&(a+=4294967296),a}function jS(r,t){var e=gn(r,t,19),i=gn(t,r,29),s=mm(r,t,6),a=e^i^s;return a<0&&(a+=4294967296),a}var Yl=ye,wm=ym;function Ln(){if(!(this instanceof Ln))return new Ln;wm.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Yl.inherits(Ln,wm);var $S=Ln;Ln.blockSize=1024,Ln.outSize=384,Ln.hmacStrength=192,Ln.padLength=128,Ln.prototype._digest=function(r){return r==="hex"?Yl.toHex32(this.h.slice(0,12),"big"):Yl.split32(this.h.slice(0,12),"big")},mo.sha1=uS,mo.sha224=_S,mo.sha256=dm,mo.sha384=$S,mo.sha512=ym;var bm={},Us=ye,kS=xo,Gc=Us.rotl32,R0=Us.sum32,ra=Us.sum32_3,F0=Us.sum32_4,_m=kS.BlockHash;function sn(){if(!(this instanceof sn))return new sn;_m.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Us.inherits(sn,_m),bm.ripemd160=sn,sn.blockSize=512,sn.outSize=160,sn.hmacStrength=192,sn.padLength=64,sn.prototype._update=function(r,t){for(var e=this.h[0],i=this.h[1],s=this.h[2],a=this.h[3],u=this.h[4],h=e,d=i,l=s,w=a,_=u,I=0;I<80;I++){var S=R0(Gc(F0(e,U0(I,i,s,a),r[KS[I]+t],zS(I)),GS[I]),u);e=u,u=a,a=Gc(s,10),s=i,i=S,S=R0(Gc(F0(h,U0(79-I,d,l,w),r[VS[I]+t],HS(I)),WS[I]),_),h=_,_=w,w=Gc(l,10),l=d,d=S}S=ra(this.h[1],s,w),this.h[1]=ra(this.h[2],a,_),this.h[2]=ra(this.h[3],u,h),this.h[3]=ra(this.h[4],e,d),this.h[4]=ra(this.h[0],i,l),this.h[0]=S},sn.prototype._digest=function(r){return r==="hex"?Us.toHex32(this.h,"little"):Us.split32(this.h,"little")};function U0(r,t,e,i){return r<=15?t^e^i:r<=31?t&e|~t&i:r<=47?(t|~e)^i:r<=63?t&i|e&~i:t^(e|~i)}function zS(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function HS(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var KS=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],VS=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],GS=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],WS=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],YS=ye,JS=Ua;function _o(r,t,e){if(!(this instanceof _o))return new _o(r,t,e);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(YS.toArray(t,e))}var QS=_o;_o.prototype._init=function(r){r.length>this.blockSize&&(r=new this.Hash().update(r).digest()),JS(r.length<=this.blockSize);for(var t=r.length;t<this.blockSize;t++)r.push(0);for(t=0;t<r.length;t++)r[t]^=54;for(this.inner=new this.Hash().update(r),t=0;t<r.length;t++)r[t]^=106;this.outer=new this.Hash().update(r)},_o.prototype.update=function(r,t){return this.inner.update(r,t),this},_o.prototype.digest=function(r){return this.outer.update(this.inner.digest()),this.outer.digest(r)},function(r){var t=r;t.utils=ye,t.common=xo,t.sha=mo,t.ripemd=bm,t.hmac=QS,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160}(nn);function Po(r,t,e){return e={path:t,exports:{},require:function(i,s){return XS(i,s??e.path)}},r(e,e.exports),e.exports}function XS(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var bf=Em;function Em(r,t){if(!r)throw new Error(t||"Assertion failed")}Em.equal=function(r,t,e){if(r!=t)throw new Error(e||"Assertion failed: "+r+" != "+t)};var $i=Po(function(r,t){var e=t;function i(u,h){if(Array.isArray(u))return u.slice();if(!u)return[];var d=[];if(typeof u!="string"){for(var l=0;l<u.length;l++)d[l]=u[l]|0;return d}if(h==="hex"){u=u.replace(/[^a-z0-9]+/ig,""),u.length%2!==0&&(u="0"+u);for(var l=0;l<u.length;l+=2)d.push(parseInt(u[l]+u[l+1],16))}else for(var l=0;l<u.length;l++){var w=u.charCodeAt(l),_=w>>8,I=w&255;_?d.push(_,I):d.push(I)}return d}e.toArray=i;function s(u){return u.length===1?"0"+u:u}e.zero2=s;function a(u){for(var h="",d=0;d<u.length;d++)h+=s(u[d].toString(16));return h}e.toHex=a,e.encode=function(u,h){return h==="hex"?a(u):u}}),si=Po(function(r,t){var e=t;e.assert=bf,e.toArray=$i.toArray,e.zero2=$i.zero2,e.toHex=$i.toHex,e.encode=$i.encode;function i(d,l,w){var _=new Array(Math.max(d.bitLength(),w)+1);_.fill(0);for(var I=1<<l+1,S=d.clone(),M=0;M<_.length;M++){var G,V=S.andln(I-1);S.isOdd()?(V>(I>>1)-1?G=(I>>1)-V:G=V,S.isubn(G)):G=0,_[M]=G,S.iushrn(1)}return _}e.getNAF=i;function s(d,l){var w=[[],[]];d=d.clone(),l=l.clone();for(var _=0,I=0,S;d.cmpn(-_)>0||l.cmpn(-I)>0;){var M=d.andln(3)+_&3,G=l.andln(3)+I&3;M===3&&(M=-1),G===3&&(G=-1);var V;M&1?(S=d.andln(7)+_&7,(S===3||S===5)&&G===2?V=-M:V=M):V=0,w[0].push(V);var Z;G&1?(S=l.andln(7)+I&7,(S===3||S===5)&&M===2?Z=-G:Z=G):Z=0,w[1].push(Z),2*_===V+1&&(_=1-_),2*I===Z+1&&(I=1-I),d.iushrn(1),l.iushrn(1)}return w}e.getJSF=s;function a(d,l,w){var _="_"+l;d.prototype[l]=function(){return this[_]!==void 0?this[_]:this[_]=w.call(this)}}e.cachedProperty=a;function u(d){return typeof d=="string"?e.toArray(d,"hex"):d}e.parseBytes=u;function h(d){return new ne(d,"hex","le")}e.intFromLE=h}),Wc=si.getNAF,ZS=si.getJSF,_u=si.assert;function rs(r,t){this.type=r,this.p=new ne(t.p,16),this.red=t.prime?ne.red(t.prime):ne.mont(this.p),this.zero=new ne(0).toRed(this.red),this.one=new ne(1).toRed(this.red),this.two=new ne(2).toRed(this.red),this.n=t.n&&new ne(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var e=this.n&&this.p.div(this.n);!e||e.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var zs=rs;rs.prototype.point=function(){throw new Error("Not implemented")},rs.prototype.validate=function(){throw new Error("Not implemented")},rs.prototype._fixedNafMul=function(r,t){_u(r.precomputed);var e=r._getDoubles(),i=Wc(t,1,this._bitLength),s=(1<<e.step+1)-(e.step%2===0?2:1);s/=3;var a=[],u,h;for(u=0;u<i.length;u+=e.step){h=0;for(var d=u+e.step-1;d>=u;d--)h=(h<<1)+i[d];a.push(h)}for(var l=this.jpoint(null,null,null),w=this.jpoint(null,null,null),_=s;_>0;_--){for(u=0;u<a.length;u++)h=a[u],h===_?w=w.mixedAdd(e.points[u]):h===-_&&(w=w.mixedAdd(e.points[u].neg()));l=l.add(w)}return l.toP()},rs.prototype._wnafMul=function(r,t){var e=4,i=r._getNAFPoints(e);e=i.wnd;for(var s=i.points,a=Wc(t,e,this._bitLength),u=this.jpoint(null,null,null),h=a.length-1;h>=0;h--){for(var d=0;h>=0&&a[h]===0;h--)d++;if(h>=0&&d++,u=u.dblp(d),h<0)break;var l=a[h];_u(l!==0),r.type==="affine"?l>0?u=u.mixedAdd(s[l-1>>1]):u=u.mixedAdd(s[-l-1>>1].neg()):l>0?u=u.add(s[l-1>>1]):u=u.add(s[-l-1>>1].neg())}return r.type==="affine"?u.toP():u},rs.prototype._wnafMulAdd=function(r,t,e,i,s){var a=this._wnafT1,u=this._wnafT2,h=this._wnafT3,d=0,l,w,_;for(l=0;l<i;l++){_=t[l];var I=_._getNAFPoints(r);a[l]=I.wnd,u[l]=I.points}for(l=i-1;l>=1;l-=2){var S=l-1,M=l;if(a[S]!==1||a[M]!==1){h[S]=Wc(e[S],a[S],this._bitLength),h[M]=Wc(e[M],a[M],this._bitLength),d=Math.max(h[S].length,d),d=Math.max(h[M].length,d);continue}var G=[t[S],null,null,t[M]];t[S].y.cmp(t[M].y)===0?(G[1]=t[S].add(t[M]),G[2]=t[S].toJ().mixedAdd(t[M].neg())):t[S].y.cmp(t[M].y.redNeg())===0?(G[1]=t[S].toJ().mixedAdd(t[M]),G[2]=t[S].add(t[M].neg())):(G[1]=t[S].toJ().mixedAdd(t[M]),G[2]=t[S].toJ().mixedAdd(t[M].neg()));var V=[-3,-1,-5,-7,0,7,5,1,3],Z=ZS(e[S],e[M]);for(d=Math.max(Z[0].length,d),h[S]=new Array(d),h[M]=new Array(d),w=0;w<d;w++){var H=Z[0][w]|0,W=Z[1][w]|0;h[S][w]=V[(H+1)*3+(W+1)],h[M][w]=0,u[S]=G}}var U=this.jpoint(null,null,null),$=this._wnafT4;for(l=d;l>=0;l--){for(var k=0;l>=0;){var v=!0;for(w=0;w<i;w++)$[w]=h[w][l]|0,$[w]!==0&&(v=!1);if(!v)break;k++,l--}if(l>=0&&k++,U=U.dblp(k),l<0)break;for(w=0;w<i;w++){var R=$[w];R!==0&&(R>0?_=u[w][R-1>>1]:R<0&&(_=u[w][-R-1>>1].neg()),_.type==="affine"?U=U.mixedAdd(_):U=U.add(_))}}for(l=0;l<i;l++)u[l]=null;return s?U:U.toP()};function _i(r,t){this.curve=r,this.type=t,this.precomputed=null}rs.BasePoint=_i,_i.prototype.eq=function(){throw new Error("Not implemented")},_i.prototype.validate=function(){return this.curve.validate(this)},rs.prototype.decodePoint=function(r,t){r=si.toArray(r,t);var e=this.p.byteLength();if((r[0]===4||r[0]===6||r[0]===7)&&r.length-1===2*e){r[0]===6?_u(r[r.length-1]%2===0):r[0]===7&&_u(r[r.length-1]%2===1);var i=this.point(r.slice(1,1+e),r.slice(1+e,1+2*e));return i}else if((r[0]===2||r[0]===3)&&r.length-1===e)return this.pointFromX(r.slice(1,1+e),r[0]===3);throw new Error("Unknown point format")},_i.prototype.encodeCompressed=function(r){return this.encode(r,!0)},_i.prototype._encode=function(r){var t=this.curve.p.byteLength(),e=this.getX().toArray("be",t);return r?[this.getY().isEven()?2:3].concat(e):[4].concat(e,this.getY().toArray("be",t))},_i.prototype.encode=function(r,t){return si.encode(this._encode(t),r)},_i.prototype.precompute=function(r){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,r),t.beta=this._getBeta(),this.precomputed=t,this},_i.prototype._hasDoubles=function(r){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((r.bitLength()+1)/t.step):!1},_i.prototype._getDoubles=function(r,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var e=[this],i=this,s=0;s<t;s+=r){for(var a=0;a<r;a++)i=i.dbl();e.push(i)}return{step:r,points:e}},_i.prototype._getNAFPoints=function(r){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],e=(1<<r)-1,i=e===1?null:this.dbl(),s=1;s<e;s++)t[s]=t[s-1].add(i);return{wnd:r,points:t}},_i.prototype._getBeta=function(){return null},_i.prototype.dblp=function(r){for(var t=this,e=0;e<r;e++)t=t.dbl();return t};var _f=Po(function(r){typeof Object.create=="function"?r.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(t,e){if(e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}}),tI=si.assert;function Di(r){zs.call(this,"short",r),this.a=new ne(r.a,16).toRed(this.red),this.b=new ne(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}_f(Di,zs);var eI=Di;Di.prototype._getEndomorphism=function(r){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,e;if(r.beta)t=new ne(r.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=i[0].cmp(i[1])<0?i[0]:i[1],t=t.toRed(this.red)}if(r.lambda)e=new ne(r.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?e=s[0]:(e=s[1],tI(this.g.mul(e).x.cmp(this.g.x.redMul(t))===0))}var a;return r.basis?a=r.basis.map(function(u){return{a:new ne(u.a,16),b:new ne(u.b,16)}}):a=this._getEndoBasis(e),{beta:t,lambda:e,basis:a}}},Di.prototype._getEndoRoots=function(r){var t=r===this.p?this.red:ne.mont(r),e=new ne(2).toRed(t).redInvm(),i=e.redNeg(),s=new ne(3).toRed(t).redNeg().redSqrt().redMul(e),a=i.redAdd(s).fromRed(),u=i.redSub(s).fromRed();return[a,u]},Di.prototype._getEndoBasis=function(r){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),e=r,i=this.n.clone(),s=new ne(1),a=new ne(0),u=new ne(0),h=new ne(1),d,l,w,_,I,S,M,G=0,V,Z;e.cmpn(0)!==0;){var H=i.div(e);V=i.sub(H.mul(e)),Z=u.sub(H.mul(s));var W=h.sub(H.mul(a));if(!w&&V.cmp(t)<0)d=M.neg(),l=s,w=V.neg(),_=Z;else if(w&&++G===2)break;M=V,i=e,e=V,u=s,s=Z,h=a,a=W}I=V.neg(),S=Z;var U=w.sqr().add(_.sqr()),$=I.sqr().add(S.sqr());return $.cmp(U)>=0&&(I=d,S=l),w.negative&&(w=w.neg(),_=_.neg()),I.negative&&(I=I.neg(),S=S.neg()),[{a:w,b:_},{a:I,b:S}]},Di.prototype._endoSplit=function(r){var t=this.endo.basis,e=t[0],i=t[1],s=i.b.mul(r).divRound(this.n),a=e.b.neg().mul(r).divRound(this.n),u=s.mul(e.a),h=a.mul(i.a),d=s.mul(e.b),l=a.mul(i.b),w=r.sub(u).sub(h),_=d.add(l).neg();return{k1:w,k2:_}},Di.prototype.pointFromX=function(r,t){r=new ne(r,16),r.red||(r=r.toRed(this.red));var e=r.redSqr().redMul(r).redIAdd(r.redMul(this.a)).redIAdd(this.b),i=e.redSqrt();if(i.redSqr().redSub(e).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(t&&!s||!t&&s)&&(i=i.redNeg()),this.point(r,i)},Di.prototype.validate=function(r){if(r.inf)return!0;var t=r.x,e=r.y,i=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return e.redSqr().redISub(s).cmpn(0)===0},Di.prototype._endoWnafMulAdd=function(r,t,e){for(var i=this._endoWnafT1,s=this._endoWnafT2,a=0;a<r.length;a++){var u=this._endoSplit(t[a]),h=r[a],d=h._getBeta();u.k1.negative&&(u.k1.ineg(),h=h.neg(!0)),u.k2.negative&&(u.k2.ineg(),d=d.neg(!0)),i[a*2]=h,i[a*2+1]=d,s[a*2]=u.k1,s[a*2+1]=u.k2}for(var l=this._wnafMulAdd(1,i,s,a*2,e),w=0;w<a*2;w++)i[w]=null,s[w]=null;return l};function pr(r,t,e,i){zs.BasePoint.call(this,r,"affine"),t===null&&e===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new ne(t,16),this.y=new ne(e,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}_f(pr,zs.BasePoint),Di.prototype.point=function(r,t,e){return new pr(this,r,t,e)},Di.prototype.pointFromJSON=function(r,t){return pr.fromJSON(this,r,t)},pr.prototype._getBeta=function(){if(this.curve.endo){var r=this.precomputed;if(r&&r.beta)return r.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(r){var e=this.curve,i=function(s){return e.point(s.x.redMul(e.endo.beta),s.y)};r.beta=t,t.precomputed={beta:null,naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return t}},pr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},pr.fromJSON=function(r,t,e){typeof t=="string"&&(t=JSON.parse(t));var i=r.point(t[0],t[1],e);if(!t[2])return i;function s(u){return r.point(u[0],u[1],e)}var a=t[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(s))}},i},pr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},pr.prototype.isInfinity=function(){return this.inf},pr.prototype.add=function(r){if(this.inf)return r;if(r.inf)return this;if(this.eq(r))return this.dbl();if(this.neg().eq(r))return this.curve.point(null,null);if(this.x.cmp(r.x)===0)return this.curve.point(null,null);var t=this.y.redSub(r.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(r.x).redInvm()));var e=t.redSqr().redISub(this.x).redISub(r.x),i=t.redMul(this.x.redSub(e)).redISub(this.y);return this.curve.point(e,i)},pr.prototype.dbl=function(){if(this.inf)return this;var r=this.y.redAdd(this.y);if(r.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,e=this.x.redSqr(),i=r.redInvm(),s=e.redAdd(e).redIAdd(e).redIAdd(t).redMul(i),a=s.redSqr().redISub(this.x.redAdd(this.x)),u=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,u)},pr.prototype.getX=function(){return this.x.fromRed()},pr.prototype.getY=function(){return this.y.fromRed()},pr.prototype.mul=function(r){return r=new ne(r,16),this.isInfinity()?this:this._hasDoubles(r)?this.curve._fixedNafMul(this,r):this.curve.endo?this.curve._endoWnafMulAdd([this],[r]):this.curve._wnafMul(this,r)},pr.prototype.mulAdd=function(r,t,e){var i=[this,t],s=[r,e];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},pr.prototype.jmulAdd=function(r,t,e){var i=[this,t],s=[r,e];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},pr.prototype.eq=function(r){return this===r||this.inf===r.inf&&(this.inf||this.x.cmp(r.x)===0&&this.y.cmp(r.y)===0)},pr.prototype.neg=function(r){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(r&&this.precomputed){var e=this.precomputed,i=function(s){return s.neg()};t.precomputed={naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t},pr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var r=this.curve.jpoint(this.x,this.y,this.curve.one);return r};function br(r,t,e,i){zs.BasePoint.call(this,r,"jacobian"),t===null&&e===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ne(0)):(this.x=new ne(t,16),this.y=new ne(e,16),this.z=new ne(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}_f(br,zs.BasePoint),Di.prototype.jpoint=function(r,t,e){return new br(this,r,t,e)},br.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var r=this.z.redInvm(),t=r.redSqr(),e=this.x.redMul(t),i=this.y.redMul(t).redMul(r);return this.curve.point(e,i)},br.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},br.prototype.add=function(r){if(this.isInfinity())return r;if(r.isInfinity())return this;var t=r.z.redSqr(),e=this.z.redSqr(),i=this.x.redMul(t),s=r.x.redMul(e),a=this.y.redMul(t.redMul(r.z)),u=r.y.redMul(e.redMul(this.z)),h=i.redSub(s),d=a.redSub(u);if(h.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=h.redSqr(),w=l.redMul(h),_=i.redMul(l),I=d.redSqr().redIAdd(w).redISub(_).redISub(_),S=d.redMul(_.redISub(I)).redISub(a.redMul(w)),M=this.z.redMul(r.z).redMul(h);return this.curve.jpoint(I,S,M)},br.prototype.mixedAdd=function(r){if(this.isInfinity())return r.toJ();if(r.isInfinity())return this;var t=this.z.redSqr(),e=this.x,i=r.x.redMul(t),s=this.y,a=r.y.redMul(t).redMul(this.z),u=e.redSub(i),h=s.redSub(a);if(u.cmpn(0)===0)return h.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=u.redSqr(),l=d.redMul(u),w=e.redMul(d),_=h.redSqr().redIAdd(l).redISub(w).redISub(w),I=h.redMul(w.redISub(_)).redISub(s.redMul(l)),S=this.z.redMul(u);return this.curve.jpoint(_,I,S)},br.prototype.dblp=function(r){if(r===0)return this;if(this.isInfinity())return this;if(!r)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var e=this;for(t=0;t<r;t++)e=e.dbl();return e}var i=this.curve.a,s=this.curve.tinv,a=this.x,u=this.y,h=this.z,d=h.redSqr().redSqr(),l=u.redAdd(u);for(t=0;t<r;t++){var w=a.redSqr(),_=l.redSqr(),I=_.redSqr(),S=w.redAdd(w).redIAdd(w).redIAdd(i.redMul(d)),M=a.redMul(_),G=S.redSqr().redISub(M.redAdd(M)),V=M.redISub(G),Z=S.redMul(V);Z=Z.redIAdd(Z).redISub(I);var H=l.redMul(h);t+1<r&&(d=d.redMul(I)),a=G,h=H,l=Z}return this.curve.jpoint(a,l.redMul(s),h)},br.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},br.prototype._zeroDbl=function(){var r,t,e;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(i).redISub(a);u=u.redIAdd(u);var h=i.redAdd(i).redIAdd(i),d=h.redSqr().redISub(u).redISub(u),l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),r=d,t=h.redMul(u.redISub(d)).redISub(l),e=this.y.redAdd(this.y)}else{var w=this.x.redSqr(),_=this.y.redSqr(),I=_.redSqr(),S=this.x.redAdd(_).redSqr().redISub(w).redISub(I);S=S.redIAdd(S);var M=w.redAdd(w).redIAdd(w),G=M.redSqr(),V=I.redIAdd(I);V=V.redIAdd(V),V=V.redIAdd(V),r=G.redISub(S).redISub(S),t=M.redMul(S.redISub(r)).redISub(V),e=this.y.redMul(this.z),e=e.redIAdd(e)}return this.curve.jpoint(r,t,e)},br.prototype._threeDbl=function(){var r,t,e;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(i).redISub(a);u=u.redIAdd(u);var h=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),d=h.redSqr().redISub(u).redISub(u);r=d;var l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),t=h.redMul(u.redISub(d)).redISub(l),e=this.y.redAdd(this.y)}else{var w=this.z.redSqr(),_=this.y.redSqr(),I=this.x.redMul(_),S=this.x.redSub(w).redMul(this.x.redAdd(w));S=S.redAdd(S).redIAdd(S);var M=I.redIAdd(I);M=M.redIAdd(M);var G=M.redAdd(M);r=S.redSqr().redISub(G),e=this.y.redAdd(this.z).redSqr().redISub(_).redISub(w);var V=_.redSqr();V=V.redIAdd(V),V=V.redIAdd(V),V=V.redIAdd(V),t=S.redMul(M.redISub(r)).redISub(V)}return this.curve.jpoint(r,t,e)},br.prototype._dbl=function(){var r=this.curve.a,t=this.x,e=this.y,i=this.z,s=i.redSqr().redSqr(),a=t.redSqr(),u=e.redSqr(),h=a.redAdd(a).redIAdd(a).redIAdd(r.redMul(s)),d=t.redAdd(t);d=d.redIAdd(d);var l=d.redMul(u),w=h.redSqr().redISub(l.redAdd(l)),_=l.redISub(w),I=u.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var S=h.redMul(_).redISub(I),M=e.redAdd(e).redMul(i);return this.curve.jpoint(w,S,M)},br.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var r=this.x.redSqr(),t=this.y.redSqr(),e=this.z.redSqr(),i=t.redSqr(),s=r.redAdd(r).redIAdd(r),a=s.redSqr(),u=this.x.redAdd(t).redSqr().redISub(r).redISub(i);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(a);var h=u.redSqr(),d=i.redIAdd(i);d=d.redIAdd(d),d=d.redIAdd(d),d=d.redIAdd(d);var l=s.redIAdd(u).redSqr().redISub(a).redISub(h).redISub(d),w=t.redMul(l);w=w.redIAdd(w),w=w.redIAdd(w);var _=this.x.redMul(h).redISub(w);_=_.redIAdd(_),_=_.redIAdd(_);var I=this.y.redMul(l.redMul(d.redISub(l)).redISub(u.redMul(h)));I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var S=this.z.redAdd(u).redSqr().redISub(e).redISub(h);return this.curve.jpoint(_,I,S)},br.prototype.mul=function(r,t){return r=new ne(r,t),this.curve._wnafMul(this,r)},br.prototype.eq=function(r){if(r.type==="affine")return this.eq(r.toJ());if(this===r)return!0;var t=this.z.redSqr(),e=r.z.redSqr();if(this.x.redMul(e).redISub(r.x.redMul(t)).cmpn(0)!==0)return!1;var i=t.redMul(this.z),s=e.redMul(r.z);return this.y.redMul(s).redISub(r.y.redMul(i)).cmpn(0)===0},br.prototype.eqXToP=function(r){var t=this.z.redSqr(),e=r.toRed(this.curve.red).redMul(t);if(this.x.cmp(e)===0)return!0;for(var i=r.clone(),s=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(s),this.x.cmp(e)===0)return!0}},br.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},br.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var su=Po(function(r,t){var e=t;e.base=zs,e.short=eI,e.mont=null,e.edwards=null}),ou=Po(function(r,t){var e=t,i=si.assert;function s(h){h.type==="short"?this.curve=new su.short(h):h.type==="edwards"?this.curve=new su.edwards(h):this.curve=new su.mont(h),this.g=this.curve.g,this.n=this.curve.n,this.hash=h.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=s;function a(h,d){Object.defineProperty(e,h,{configurable:!0,enumerable:!0,get:function(){var l=new s(d);return Object.defineProperty(e,h,{configurable:!0,enumerable:!0,value:l}),l}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:nn.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:nn.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:nn.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:nn.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:nn.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:nn.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:nn.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var u;try{u=null.crash()}catch{u=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:nn.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",u]})});function is(r){if(!(this instanceof is))return new is(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=$i.toArray(r.entropy,r.entropyEnc||"hex"),e=$i.toArray(r.nonce,r.nonceEnc||"hex"),i=$i.toArray(r.pers,r.persEnc||"hex");bf(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,e,i)}var L0=is;is.prototype._init=function(r,t,e){var i=r.concat(t).concat(e);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},is.prototype._hmac=function(){return new nn.hmac(this.hash,this.K)},is.prototype._update=function(r){var t=this._hmac().update(this.V).update([0]);r&&(t=t.update(r)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),r&&(this.K=this._hmac().update(this.V).update([1]).update(r).digest(),this.V=this._hmac().update(this.V).digest())},is.prototype.reseed=function(r,t,e,i){typeof t!="string"&&(i=e,e=t,t=null),r=$i.toArray(r,t),e=$i.toArray(e,i),bf(r.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(r.concat(e||[])),this._reseed=1},is.prototype.generate=function(r,t,e,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(i=e,e=t,t=null),e&&(e=$i.toArray(e,i||"hex"),this._update(e));for(var s=[];s.length<r;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,r);return this._update(e),this._reseed++,$i.encode(a,t)};var pl=si.assert;function xr(r,t){this.ec=r,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var gl=xr;xr.fromPublic=function(r,t,e){return t instanceof xr?t:new xr(r,{pub:t,pubEnc:e})},xr.fromPrivate=function(r,t,e){return t instanceof xr?t:new xr(r,{priv:t,privEnc:e})},xr.prototype.validate=function(){var r=this.getPublic();return r.isInfinity()?{result:!1,reason:"Invalid public key"}:r.validate()?r.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},xr.prototype.getPublic=function(r,t){return typeof r=="string"&&(t=r,r=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,r):this.pub},xr.prototype.getPrivate=function(r){return r==="hex"?this.priv.toString(16,2):this.priv},xr.prototype._importPrivate=function(r,t){this.priv=new ne(r,t||16),this.priv=this.priv.umod(this.ec.curve.n)},xr.prototype._importPublic=function(r,t){if(r.x||r.y){this.ec.curve.type==="mont"?pl(r.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&pl(r.x&&r.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(r.x,r.y);return}this.pub=this.ec.curve.decodePoint(r,t)},xr.prototype.derive=function(r){return r.validate()||pl(r.validate(),"public point not validated"),r.mul(this.priv).getX()},xr.prototype.sign=function(r,t,e){return this.ec.sign(r,this,t,e)},xr.prototype.verify=function(r,t){return this.ec.verify(r,t,this)},xr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var rI=si.assert;function Bu(r,t){if(r instanceof Bu)return r;this._importDER(r,t)||(rI(r.r&&r.s,"Signature without r or s"),this.r=new ne(r.r,16),this.s=new ne(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var Yc=Bu;function iI(){this.place=0}function ml(r,t){var e=r[t.place++];if(!(e&128))return e;var i=e&15;if(i===0||i>4)return!1;for(var s=0,a=0,u=t.place;a<i;a++,u++)s<<=8,s|=r[u],s>>>=0;return s<=127?!1:(t.place=u,s)}function B0(r){for(var t=0,e=r.length-1;!r[t]&&!(r[t+1]&128)&&t<e;)t++;return t===0?r:r.slice(t)}Bu.prototype._importDER=function(r,t){r=si.toArray(r,t);var e=new iI;if(r[e.place++]!==48)return!1;var i=ml(r,e);if(i===!1||i+e.place!==r.length||r[e.place++]!==2)return!1;var s=ml(r,e);if(s===!1)return!1;var a=r.slice(e.place,s+e.place);if(e.place+=s,r[e.place++]!==2)return!1;var u=ml(r,e);if(u===!1||r.length!==u+e.place)return!1;var h=r.slice(e.place,u+e.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;return this.r=new ne(a),this.s=new ne(h),this.recoveryParam=null,!0};function vl(r,t){if(t<128){r.push(t);return}var e=1+(Math.log(t)/Math.LN2>>>3);for(r.push(e|128);--e;)r.push(t>>>(e<<3)&255);r.push(t)}Bu.prototype.toDER=function(r){var t=this.r.toArray(),e=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),e[0]&128&&(e=[0].concat(e)),t=B0(t),e=B0(e);!e[0]&&!(e[1]&128);)e=e.slice(1);var i=[2];vl(i,t.length),i=i.concat(t),i.push(2),vl(i,e.length);var s=i.concat(e),a=[48];return vl(a,s.length),a=a.concat(s),si.encode(a,r)};var nI=function(){throw new Error("unsupported")},Am=si.assert;function Si(r){if(!(this instanceof Si))return new Si(r);typeof r=="string"&&(Am(Object.prototype.hasOwnProperty.call(ou,r),"Unknown curve "+r),r=ou[r]),r instanceof ou.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var sI=Si;Si.prototype.keyPair=function(r){return new gl(this,r)},Si.prototype.keyFromPrivate=function(r,t){return gl.fromPrivate(this,r,t)},Si.prototype.keyFromPublic=function(r,t){return gl.fromPublic(this,r,t)},Si.prototype.genKeyPair=function(r){r||(r={});for(var t=new L0({hash:this.hash,pers:r.pers,persEnc:r.persEnc||"utf8",entropy:r.entropy||nI(this.hash.hmacStrength),entropyEnc:r.entropy&&r.entropyEnc||"utf8",nonce:this.n.toArray()}),e=this.n.byteLength(),i=this.n.sub(new ne(2));;){var s=new ne(t.generate(e));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}},Si.prototype._truncateToN=function(r,t){var e=r.byteLength()*8-this.n.bitLength();return e>0&&(r=r.ushrn(e)),!t&&r.cmp(this.n)>=0?r.sub(this.n):r},Si.prototype.sign=function(r,t,e,i){typeof e=="object"&&(i=e,e=null),i||(i={}),t=this.keyFromPrivate(t,e),r=this._truncateToN(new ne(r,16));for(var s=this.n.byteLength(),a=t.getPrivate().toArray("be",s),u=r.toArray("be",s),h=new L0({hash:this.hash,entropy:a,nonce:u,pers:i.pers,persEnc:i.persEnc||"utf8"}),d=this.n.sub(new ne(1)),l=0;;l++){var w=i.k?i.k(l):new ne(h.generate(this.n.byteLength()));if(w=this._truncateToN(w,!0),!(w.cmpn(1)<=0||w.cmp(d)>=0)){var _=this.g.mul(w);if(!_.isInfinity()){var I=_.getX(),S=I.umod(this.n);if(S.cmpn(0)!==0){var M=w.invm(this.n).mul(S.mul(t.getPrivate()).iadd(r));if(M=M.umod(this.n),M.cmpn(0)!==0){var G=(_.getY().isOdd()?1:0)|(I.cmp(S)!==0?2:0);return i.canonical&&M.cmp(this.nh)>0&&(M=this.n.sub(M),G^=1),new Yc({r:S,s:M,recoveryParam:G})}}}}}},Si.prototype.verify=function(r,t,e,i){r=this._truncateToN(new ne(r,16)),e=this.keyFromPublic(e,i),t=new Yc(t,"hex");var s=t.r,a=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var u=a.invm(this.n),h=u.mul(r).umod(this.n),d=u.mul(s).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(h,e.getPublic(),d),l.isInfinity()?!1:l.eqXToP(s)):(l=this.g.mulAdd(h,e.getPublic(),d),l.isInfinity()?!1:l.getX().umod(this.n).cmp(s)===0)},Si.prototype.recoverPubKey=function(r,t,e,i){Am((3&e)===e,"The recovery param is more than two bits"),t=new Yc(t,i);var s=this.n,a=new ne(r),u=t.r,h=t.s,d=e&1,l=e>>1;if(u.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?u=this.curve.pointFromX(u.add(this.curve.n),d):u=this.curve.pointFromX(u,d);var w=t.r.invm(s),_=s.sub(a).mul(w).umod(s),I=h.mul(w).umod(s);return this.g.mulAdd(_,u,I)},Si.prototype.getKeyRecoveryParam=function(r,t,e,i){if(t=new Yc(t,i),t.recoveryParam!==null)return t.recoveryParam;for(var s=0;s<4;s++){var a;try{a=this.recoverPubKey(r,t,s)}catch{continue}if(a.eq(e))return s}throw new Error("Unable to find valid recovery factor")};var oI=Po(function(r,t){var e=t;e.version="6.5.4",e.utils=si,e.rand=function(){throw new Error("unsupported")},e.curve=su,e.curves=ou,e.ec=sI,e.eddsa=null}),aI=oI.ec;const cI="signing-key/5.7.0",Jl=new _r(cI);let yl=null;function es(){return yl||(yl=new aI("secp256k1")),yl}class uI{constructor(t){ta(this,"curve","secp256k1"),ta(this,"privateKey",Gr(t)),V8(this.privateKey)!==32&&Jl.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const e=es().keyFromPrivate(Ze(this.privateKey));ta(this,"publicKey","0x"+e.getPublic(!1,"hex")),ta(this,"compressedPublicKey","0x"+e.getPublic(!0,"hex")),ta(this,"_isSigningKey",!0)}_addPoint(t){const e=es().keyFromPublic(Ze(this.publicKey)),i=es().keyFromPublic(Ze(t));return"0x"+e.pub.add(i.pub).encodeCompressed("hex")}signDigest(t){const e=es().keyFromPrivate(Ze(this.privateKey)),i=Ze(t);i.length!==32&&Jl.throwArgumentError("bad digest length","digest",t);const s=e.sign(i,{canonical:!0});return W1({recoveryParam:s.recoveryParam,r:fn("0x"+s.r.toString(16),32),s:fn("0x"+s.s.toString(16),32)})}computeSharedSecret(t){const e=es().keyFromPrivate(Ze(this.privateKey)),i=es().keyFromPublic(Ze(Sm(t)));return fn("0x"+e.derive(i.getPublic()).toString(16),32)}static isSigningKey(t){return!!(t&&t._isSigningKey)}}function hI(r,t){const e=W1(t),i={r:Ze(e.r),s:Ze(e.s)};return"0x"+es().recoverPubKey(Ze(r),i,e.recoveryParam).encode("hex",!1)}function Sm(r,t){const e=Ze(r);return e.length===32?new uI(e).publicKey:e.length===33?"0x"+es().keyFromPublic(e).getPublic(!1,"hex"):e.length===65?Gr(e):Jl.throwArgumentError("invalid public or private key","key","[REDACTED]")}var q0;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(q0||(q0={}));function lI(r){const t=Sm(r);return E4(S0(vf(S0(t,1)),12))}function fI(r,t){return lI(hI(Ze(r),t))}const dI="https://rpc.walletconnect.org/v1";async function pI(r,t,e,i,s,a){switch(e.t){case"eip191":return gI(r,t,e.s);case"eip1271":return await mI(r,t,e.s,i,s,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${e.t}`)}}function gI(r,t,e){return fI(im(t),e).toLowerCase()===r.toLowerCase()}async function mI(r,t,e,i,s,a){try{const u="0x1626ba7e",h="0000000000000000000000000000000000000000000000000000000000000040",d="0000000000000000000000000000000000000000000000000000000000000041",l=e.substring(2),w=im(t).substring(2),_=u+w+h+d+l,I=await fetch(`${a||dI}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:vI(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:_},"latest"]})}),{result:S}=await I.json();return S?S.slice(0,u.length).toLowerCase()===u.toLowerCase():!1}catch(u){return console.error("isValidEip1271Signature: ",u),!1}}function vI(){return Date.now()+Math.floor(Math.random()*1e3)}var yI=Object.defineProperty,wI=Object.defineProperties,bI=Object.getOwnPropertyDescriptors,j0=Object.getOwnPropertySymbols,_I=Object.prototype.hasOwnProperty,EI=Object.prototype.propertyIsEnumerable,$0=(r,t,e)=>t in r?yI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,AI=(r,t)=>{for(var e in t||(t={}))_I.call(t,e)&&$0(r,e,t[e]);if(j0)for(var e of j0(t))EI.call(t,e)&&$0(r,e,t[e]);return r},SI=(r,t)=>wI(r,bI(t));const II="did:pkh:",Ef=r=>r==null?void 0:r.split(":"),Im=r=>{const t=r&&Ef(r);if(t)return r.includes(II)?t[3]:t[1]},k0=r=>{const t=r&&Ef(r);if(t)return t[2]+":"+t[3]},Eu=r=>{const t=r&&Ef(r);if(t)return t.pop()};async function z0(r){const{cacao:t,projectId:e}=r,{s:i,p:s}=t,a=Dm(s,s.iss),u=Eu(s.iss);return await pI(u,a,i,Im(s.iss),e)}const Dm=(r,t)=>{const e=`${r.domain} wants you to sign in with your Ethereum account:`,i=Eu(t);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const a=`URI: ${r.aud||r.uri}`,u=`Version: ${r.version}`,h=`Chain ID: ${Im(t)}`,d=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,w=r.exp?`Expiration Time: ${r.exp}`:void 0,_=r.nbf?`Not Before: ${r.nbf}`:void 0,I=r.requestId?`Request ID: ${r.requestId}`:void 0,S=r.resources?`Resources:${r.resources.map(G=>`
- ${G}`).join("")}`:void 0,M=au(r.resources);if(M){const G=Ia(M);s=RI(s,G)}return[e,i,"",s,"",a,u,h,d,l,w,_,I,S].filter(G=>G!=null).join(`
`)};function DI(r){return xi.from(JSON.stringify(r)).toString("base64")}function xI(r){return JSON.parse(xi.from(r,"base64").toString("utf-8"))}function Bs(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const t=Object.keys(r.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(e=>{const i=r.att[e];if(Array.isArray(i))throw new Error(`Resource must be an object: ${e}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${e}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${e}`);Object.keys(i).forEach(s=>{const a=i[s];if(!Array.isArray(a))throw new Error(`Ability limits ${s} must be an array of objects, found: ${a}`);if(!a.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);a.forEach(u=>{if(typeof u!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${u}`)})})})}function MI(r,t,e,i={}){return e==null||e.sort((s,a)=>s.localeCompare(a)),{att:{[r]:PI(t,e,i)}}}function PI(r,t,e={}){t=t==null?void 0:t.sort((s,a)=>s.localeCompare(a));const i=t.map(s=>({[`${r}/${s}`]:[e]}));return Object.assign({},...i)}function xm(r){return Bs(r),`urn:recap:${DI(r).replace(/=/g,"")}`}function Ia(r){const t=xI(r.replace("urn:recap:",""));return Bs(t),t}function CI(r,t,e){const i=MI(r,t,e);return xm(i)}function OI(r){return r&&r.includes("urn:recap:")}function NI(r,t){const e=Ia(r),i=Ia(t),s=TI(e,i);return xm(s)}function TI(r,t){Bs(r),Bs(t);const e=Object.keys(r.att).concat(Object.keys(t.att)).sort((s,a)=>s.localeCompare(a)),i={att:{}};return e.forEach(s=>{var a,u;Object.keys(((a=r.att)==null?void 0:a[s])||{}).concat(Object.keys(((u=t.att)==null?void 0:u[s])||{})).sort((h,d)=>h.localeCompare(d)).forEach(h=>{var d,l;i.att[s]=SI(AI({},i.att[s]),{[h]:((d=r.att[s])==null?void 0:d[h])||((l=t.att[s])==null?void 0:l[h])})})}),i}function RI(r="",t){Bs(t);const e="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(e))return r;const i=[];let s=0;Object.keys(t.att).forEach(h=>{const d=Object.keys(t.att[h]).map(_=>({ability:_.split("/")[0],action:_.split("/")[1]}));d.sort((_,I)=>_.action.localeCompare(I.action));const l={};d.forEach(_=>{l[_.ability]||(l[_.ability]=[]),l[_.ability].push(_.action)});const w=Object.keys(l).map(_=>(s++,`(${s}) '${_}': '${l[_].join("', '")}' for '${h}'.`));i.push(w.join(", ").replace(".,","."))});const a=i.join(" "),u=`${e}${a}`;return`${r?r+" ":""}${u}`}function H0(r){var t;const e=Ia(r);Bs(e);const i=(t=e.att)==null?void 0:t.eip155;return i?Object.keys(i).map(s=>s.split("/")[1]):[]}function K0(r){const t=Ia(r);Bs(t);const e=[];return Object.values(t.att).forEach(i=>{Object.values(i).forEach(s=>{var a;(a=s==null?void 0:s[0])!=null&&a.chains&&e.push(s[0].chains)})}),[...new Set(e.flat())]}function au(r){if(!r)return;const t=r==null?void 0:r[r.length-1];return OI(t)?t:void 0}const Mm="base10",Lr="base16",ss="base64pad",ia="base64url",La="utf8",Pm=0,Bn=1,Ba=2,FI=0,V0=1,va=12,Af=32;function UI(){const r=lf.generateKeyPair();return{privateKey:yr(r.secretKey,Lr),publicKey:yr(r.publicKey,Lr)}}function Ql(){const r=os.randomBytes(Af);return yr(r,Lr)}function LI(r,t){const e=lf.sharedKey(vr(r,Lr),vr(t,Lr),!0),i=new pA(Ta.SHA256,e).expand(Af);return yr(i,Lr)}function cu(r){const t=Ta.hash(vr(r,Lr));return yr(t,Lr)}function Fn(r){const t=Ta.hash(vr(r,La));return yr(t,Lr)}function Cm(r){return vr(`${r}`,Mm)}function qs(r){return Number(yr(r,Mm))}function BI(r){const t=Cm(typeof r.type<"u"?r.type:Pm);if(qs(t)===Bn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const e=typeof r.senderPublicKey<"u"?vr(r.senderPublicKey,Lr):void 0,i=typeof r.iv<"u"?vr(r.iv,Lr):os.randomBytes(va),s=new uf.ChaCha20Poly1305(vr(r.symKey,Lr)).seal(i,vr(r.message,La));return Om({type:t,sealed:s,iv:i,senderPublicKey:e,encoding:r.encoding})}function qI(r,t){const e=Cm(Ba),i=os.randomBytes(va),s=vr(r,La);return Om({type:e,sealed:s,iv:i,encoding:t})}function jI(r){const t=new uf.ChaCha20Poly1305(vr(r.symKey,Lr)),{sealed:e,iv:i}=Da({encoded:r.encoded,encoding:r==null?void 0:r.encoding}),s=t.open(i,e);if(s===null)throw new Error("Failed to decrypt");return yr(s,La)}function $I(r,t){const{sealed:e}=Da({encoded:r,encoding:t});return yr(e,La)}function Om(r){const{encoding:t=ss}=r;if(qs(r.type)===Ba)return yr(ru([r.type,r.sealed]),t);if(qs(r.type)===Bn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return yr(ru([r.type,r.senderPublicKey,r.iv,r.sealed]),t)}return yr(ru([r.type,r.iv,r.sealed]),t)}function Da(r){const{encoded:t,encoding:e=ss}=r,i=vr(t,e),s=i.slice(FI,V0),a=V0;if(qs(s)===Bn){const l=a+Af,w=l+va,_=i.slice(a,l),I=i.slice(l,w),S=i.slice(w);return{type:s,sealed:S,iv:I,senderPublicKey:_}}if(qs(s)===Ba){const l=i.slice(a),w=os.randomBytes(va);return{type:s,sealed:l,iv:w}}const u=a+va,h=i.slice(a,u),d=i.slice(u);return{type:s,sealed:d,iv:h}}function kI(r,t){const e=Da({encoded:r,encoding:t==null?void 0:t.encoding});return Nm({type:qs(e.type),senderPublicKey:typeof e.senderPublicKey<"u"?yr(e.senderPublicKey,Lr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Nm(r){const t=(r==null?void 0:r.type)||Pm;if(t===Bn){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function G0(r){return r.type===Bn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function W0(r){return r.type===Ba}function zI(r){return new L3.ec("p256").keyFromPublic({x:xi.from(r.x,"base64").toString("hex"),y:xi.from(r.y,"base64").toString("hex")},"hex")}function HI(r){let t=r.replace(/-/g,"+").replace(/_/g,"/");const e=t.length%4;return e>0&&(t+="=".repeat(4-e)),t}function KI(r){return xi.from(HI(r),"base64")}function VI(r,t){const[e,i,s]=r.split("."),a=KI(s);if(a.length!==64)throw new Error("Invalid signature length");const u=a.slice(0,32).toString("hex"),h=a.slice(32,64).toString("hex"),d=`${e}.${i}`,l=new Ta.SHA256().update(xi.from(d)).digest(),w=zI(t),_=xi.from(l).toString("hex");if(!w.verify(_,{r:u,s:h}))throw new Error("Invalid signature");return ql(r).payload}const GI="irn";function Xl(r){return(r==null?void 0:r.relay)||{protocol:GI}}function la(r){const t=NA[r];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${r}`);return t}var WI=Object.defineProperty,YI=Object.defineProperties,JI=Object.getOwnPropertyDescriptors,Y0=Object.getOwnPropertySymbols,QI=Object.prototype.hasOwnProperty,XI=Object.prototype.propertyIsEnumerable,J0=(r,t,e)=>t in r?WI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Q0=(r,t)=>{for(var e in t||(t={}))QI.call(t,e)&&J0(r,e,t[e]);if(Y0)for(var e of Y0(t))XI.call(t,e)&&J0(r,e,t[e]);return r},ZI=(r,t)=>YI(r,JI(t));function tD(r,t="-"){const e={},i="relay"+t;return Object.keys(r).forEach(s=>{if(s.startsWith(i)){const a=s.replace(i,""),u=r[s];e[a]=u}}),e}function X0(r){if(!r.includes("wc:")){const d=H1(r);d!=null&&d.includes("wc:")&&(r=d)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const t=r.indexOf(":"),e=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,t),s=r.substring(t+1,e).split("@"),a=typeof e<"u"?r.substring(e):"",u=Ea.parse(a),h=typeof u.methods=="string"?u.methods.split(","):void 0;return{protocol:i,topic:eD(s[0]),version:parseInt(s[1],10),symKey:u.symKey,relay:tD(u),methods:h,expiryTimestamp:u.expiryTimestamp?parseInt(u.expiryTimestamp,10):void 0}}function eD(r){return r.startsWith("//")?r.substring(2):r}function rD(r,t="-"){const e="relay",i={};return Object.keys(r).forEach(s=>{const a=e+t+s;r[s]&&(i[a]=r[s])}),i}function Z0(r){return`${r.protocol}:${r.topic}@${r.version}?`+Ea.stringify(Q0(ZI(Q0({symKey:r.symKey},rD(r.relay)),{expiryTimestamp:r.expiryTimestamp}),r.methods?{methods:r.methods.join(",")}:{}))}function Jc(r,t,e){return`${r}?wc_ev=${e}&topic=${t}`}function Co(r){const t=[];return r.forEach(e=>{const[i,s]=e.split(":");t.push(`${i}:${s}`)}),t}function iD(r){const t=[];return Object.values(r).forEach(e=>{t.push(...Co(e.accounts))}),t}function nD(r,t){const e=[];return Object.values(r).forEach(i=>{Co(i.accounts).includes(t)&&e.push(...i.methods)}),e}function sD(r,t){const e=[];return Object.values(r).forEach(i=>{Co(i.accounts).includes(t)&&e.push(...i.events)}),e}function Sf(r){return r.includes(":")}function fa(r){return Sf(r)?r.split(":")[0]:r}function oD(r){const t={};return r==null||r.forEach(e=>{const[i,s]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[]}),t[i].accounts.push(e),t[i].chains.push(`${i}:${s}`)}),t}function tg(r,t){t=t.map(i=>i.replace("did:pkh:",""));const e=oD(t);for(const[i,s]of Object.entries(e))s.methods?s.methods=iu(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return e}const aD={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},cD={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function gt(r,t){const{message:e,code:i}=cD[r];return{message:t?`${e} ${t}`:e,code:i}}function Re(r,t){const{message:e,code:i}=aD[r];return{message:t?`${e} ${t}`:e,code:i}}function mn(r,t){return!!Array.isArray(r)}function xa(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function Wr(r){return typeof r>"u"}function nr(r,t){return t&&Wr(r)?!0:typeof r=="string"&&!!r.trim().length}function If(r,t){return typeof r=="number"&&!isNaN(r)}function uD(r,t){const{requiredNamespaces:e}=t,i=Object.keys(r.namespaces),s=Object.keys(e);let a=!0;return Fs(s,i)?(i.forEach(u=>{const{accounts:h,methods:d,events:l}=r.namespaces[u],w=Co(h),_=e[u];(!Fs(L1(u,_),w)||!Fs(_.methods,d)||!Fs(_.events,l))&&(a=!1)}),a):!1}function Au(r){return nr(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function hD(r){if(nr(r,!1)&&r.includes(":")){const t=r.split(":");if(t.length===3){const e=t[0]+":"+t[1];return!!t[2]&&Au(e)}}return!1}function lD(r){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(nr(r,!1)){if(t(r))return!0;const e=H1(r);return t(e)}}catch{}return!1}function fD(r){var t;return(t=r==null?void 0:r.proposer)==null?void 0:t.publicKey}function dD(r){return r==null?void 0:r.topic}function pD(r,t){let e=null;return nr(r==null?void 0:r.publicKey,!1)||(e=gt("MISSING_OR_INVALID",`${t} controller public key should be a string`)),e}function eg(r){let t=!0;return mn(r)?r.length&&(t=r.every(e=>nr(e,!1))):t=!1,t}function gD(r,t,e){let i=null;return mn(t)&&t.length?t.forEach(s=>{i||Au(s)||(i=Re("UNSUPPORTED_CHAINS",`${e}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Au(r)||(i=Re("UNSUPPORTED_CHAINS",`${e}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function mD(r,t,e){let i=null;return Object.entries(r).forEach(([s,a])=>{if(i)return;const u=gD(s,L1(s,a),`${t} ${e}`);u&&(i=u)}),i}function vD(r,t){let e=null;return mn(r)?r.forEach(i=>{e||hD(i)||(e=Re("UNSUPPORTED_ACCOUNTS",`${t}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):e=Re("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),e}function yD(r,t){let e=null;return Object.values(r).forEach(i=>{if(e)return;const s=vD(i==null?void 0:i.accounts,`${t} namespace`);s&&(e=s)}),e}function wD(r,t){let e=null;return eg(r==null?void 0:r.methods)?eg(r==null?void 0:r.events)||(e=Re("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):e=Re("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),e}function Tm(r,t){let e=null;return Object.values(r).forEach(i=>{if(e)return;const s=wD(i,`${t}, namespace`);s&&(e=s)}),e}function bD(r,t,e){let i=null;if(r&&xa(r)){const s=Tm(r,t);s&&(i=s);const a=mD(r,t,e);a&&(i=a)}else i=gt("MISSING_OR_INVALID",`${t}, ${e} should be an object with data`);return i}function wl(r,t){let e=null;if(r&&xa(r)){const i=Tm(r,t);i&&(e=i);const s=yD(r,t);s&&(e=s)}else e=gt("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return e}function Rm(r){return nr(r.protocol,!0)}function _D(r,t){let e=!1;return r?r&&mn(r)&&r.length&&r.forEach(i=>{e=Rm(i)}):e=!0,e}function ED(r){return typeof r=="number"}function Vr(r){return typeof r<"u"&&typeof r!==null}function AD(r){return!(!r||typeof r!="object"||!r.code||!If(r.code)||!r.message||!nr(r.message,!1))}function SD(r){return!(Wr(r)||!nr(r.method,!1))}function ID(r){return!(Wr(r)||Wr(r.result)&&Wr(r.error)||!If(r.id)||!nr(r.jsonrpc,!1))}function DD(r){return!(Wr(r)||!nr(r.name,!1))}function rg(r,t){return!(!Au(t)||!iD(r).includes(t))}function xD(r,t,e){return nr(e,!1)?nD(r,t).includes(e):!1}function MD(r,t,e){return nr(e,!1)?sD(r,t).includes(e):!1}function ig(r,t,e){let i=null;const s=PD(r),a=CD(t),u=Object.keys(s),h=Object.keys(a),d=ng(Object.keys(r)),l=ng(Object.keys(t)),w=d.filter(_=>!l.includes(_));return w.length&&(i=gt("NON_CONFORMING_NAMESPACES",`${e} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(t).toString()}`)),Fs(u,h)||(i=gt("NON_CONFORMING_NAMESPACES",`${e} namespaces chains don't satisfy required namespaces.
      Required: ${u.toString()}
      Approved: ${h.toString()}`)),Object.keys(t).forEach(_=>{if(!_.includes(":")||i)return;const I=Co(t[_].accounts);I.includes(_)||(i=gt("NON_CONFORMING_NAMESPACES",`${e} namespaces accounts don't satisfy namespace accounts for ${_}
        Required: ${_}
        Approved: ${I.toString()}`))}),u.forEach(_=>{i||(Fs(s[_].methods,a[_].methods)?Fs(s[_].events,a[_].events)||(i=gt("NON_CONFORMING_NAMESPACES",`${e} namespaces events don't satisfy namespace events for ${_}`)):i=gt("NON_CONFORMING_NAMESPACES",`${e} namespaces methods don't satisfy namespace methods for ${_}`))}),i}function PD(r){const t={};return Object.keys(r).forEach(e=>{var i;e.includes(":")?t[e]=r[e]:(i=r[e].chains)==null||i.forEach(s=>{t[s]={methods:r[e].methods,events:r[e].events}})}),t}function ng(r){return[...new Set(r.map(t=>t.includes(":")?t.split(":")[0]:t))]}function CD(r){const t={};return Object.keys(r).forEach(e=>{if(e.includes(":"))t[e]=r[e];else{const i=Co(r[e].accounts);i==null||i.forEach(s=>{t[s]={accounts:r[e].accounts.filter(a=>a.includes(`${s}:`)),methods:r[e].methods,events:r[e].events}})}}),t}function OD(r,t){return If(r)&&r<=t.max&&r>=t.min}function sg(){const r=Fa();return new Promise(t=>{switch(r){case ii.browser:t(ND());break;case ii.reactNative:t(TD());break;case ii.node:t(RD());break;default:t(!0)}})}function ND(){return Ra()&&(navigator==null?void 0:navigator.onLine)}async function TD(){if(Io()&&typeof oe<"u"&&oe!=null&&oe.NetInfo){const r=await(oe==null?void 0:oe.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function RD(){return!0}function FD(r){switch(Fa()){case ii.browser:UD(r);break;case ii.reactNative:LD(r);break}}function UD(r){!Io()&&Ra()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function LD(r){var t;Io()&&typeof oe<"u"&&oe!=null&&oe.NetInfo&&((t=oe)==null||t.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const bl={};class na{static get(t){return bl[t]}static set(t,e){bl[t]=e}static delete(t){delete bl[t]}}let BD=class extends $s{constructor(t){super()}};const og=mt.FIVE_SECONDS,Oo={pulse:"heartbeat_pulse"};class Df extends BD{constructor(t){super(t),this.events=new Mi.EventEmitter,this.interval=og,this.interval=(t==null?void 0:t.interval)||og}static async init(t){const e=new Df(t);return await e.init(),e}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),mt.toMiliseconds(this.interval))}pulse(){this.events.emit(Oo.pulse)}}class qD extends $s{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let jD=class extends $s{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}},$D=class{constructor(t,e){this.logger=t,this.core=e}},kD=class extends $s{constructor(t,e){super(),this.relayer=t,this.logger=e}},zD=class extends $s{constructor(t){super()}},HD=class{constructor(t,e,i,s){this.core=t,this.logger=e,this.name=i}},KD=class extends $s{constructor(t,e){super(),this.relayer=t,this.logger=e}},VD=class extends $s{constructor(t,e){super(),this.core=t,this.logger=e}},GD=class{constructor(t,e,i){this.core=t,this.logger=e,this.store=i}},WD=class{constructor(t,e){this.projectId=t,this.logger=e}},YD=class{constructor(t,e,i){this.core=t,this.logger=e,this.telemetryEnabled=i}},JD=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},QD=class{constructor(t){this.client=t}};class zi extends f8{constructor(t){super(t),this.events=new Mi.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async request(t,e){return this.requestStrict(ns(t.method,t.params||[],t.id||Rs().toString()),e)}async requestStrict(t,e){return new Promise(async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(a){s(a)}this.events.on(`${t.id}`,a=>{Ii(a)?s(a.error):i(a.result)});try{await this.connection.send(t,e)}catch(a){s(a)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Lu(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const XD=()=>typeof WebSocket<"u"?WebSocket:typeof oe<"u"&&typeof oe.WebSocket<"u"?oe.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),ZD=()=>typeof WebSocket<"u"||typeof oe<"u"&&typeof oe.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ag=r=>r.split("?")[0],cg=10,tx=XD();let ex=class{constructor(t){if(this.url=t,this.events=new Mi.EventEmitter,this.registering=!1,!l0(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,e)=>{if(typeof this.socket>"u"){e(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(qn(t))}catch(e){this.onError(t.id,e)}}register(t=this.url){if(!l0(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=t,this.registering=!0,new Promise((e,i)=>{const s=new URLSearchParams(t).get("origin"),a=T1.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!m8(t)},u=new tx(t,[],a);ZD()?u.onerror=h=>{const d=h;i(this.emitError(d.error))}:u.on("error",h=>{i(this.emitError(h))}),u.onopen=()=>{this.onOpen(u),e(u)}})}onOpen(t){t.onmessage=e=>this.onPayload(e),t.onclose=e=>this.onClose(e),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?Ls(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const i=this.parseError(e),s=i.message||i.toString(),a=Uu(t,s);this.events.emit("payload",a)}parseError(t,e=this.url){return N1(t,ag(e),"WS")}resetMaxListeners(){this.events.getMaxListeners()>cg&&this.events.setMaxListeners(cg)}emitError(t){const e=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${ag(this.url)}`));return this.events.emit("register_error",e),e}};const Fm="wc",Um=2,xf="core",vn=`${Fm}@2:${xf}:`,rx={name:xf,logger:"error"},ix={database:":memory:"},nx="crypto",ug="client_ed25519_seed",sx=mt.ONE_DAY,ox="keychain",ax="0.3",cx="messages",ux="0.3",hx=mt.SIX_HOURS,lx="publisher",Lm="irn",fx="error",Bm="wss://relay.walletconnect.org",dx="relayer",Fr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},px="_subscription",Ei={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},gx=.1,Zl="2.17.0",$e={link_mode:"link_mode",relay:"relay"},mx="0.3",vx="WALLETCONNECT_CLIENT_ID",hg="WALLETCONNECT_LINK_MODE_APPS",on={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},yx="subscription",wx="0.3",bx=mt.FIVE_SECONDS*1e3,_x="pairing",Ex="0.3",sa={wc_pairingDelete:{req:{ttl:mt.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:mt.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:mt.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:mt.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:mt.ONE_DAY,prompt:!1,tag:0},res:{ttl:mt.ONE_DAY,prompt:!1,tag:0}}},Ts={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Ui={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Ax="history",Sx="0.3",Ix="expirer",Ai={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Dx="0.3",xx="verify-api",Mx="https://verify.walletconnect.com",qm="https://verify.walletconnect.org",ya=qm,Px=`${ya}/v3`,Cx=[Mx,qm],Ox="echo",Nx="https://echo.walletconnect.com",en={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Tn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Li={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Cs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Os={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},oa={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},Tx=.1,Rx="event-client",Fx=86400,Ux="https://pulse.walletconnect.org/batch";function Lx(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),i=0;i<e.length;i++)e[i]=255;for(var s=0;s<r.length;s++){var a=r.charAt(s),u=a.charCodeAt(0);if(e[u]!==255)throw new TypeError(a+" is ambiguous");e[u]=s}var h=r.length,d=r.charAt(0),l=Math.log(h)/Math.log(256),w=Math.log(256)/Math.log(h);function _(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var G=0,V=0,Z=0,H=M.length;Z!==H&&M[Z]===0;)Z++,G++;for(var W=(H-Z)*w+1>>>0,U=new Uint8Array(W);Z!==H;){for(var $=M[Z],k=0,v=W-1;($!==0||k<V)&&v!==-1;v--,k++)$+=256*U[v]>>>0,U[v]=$%h>>>0,$=$/h>>>0;if($!==0)throw new Error("Non-zero carry");V=k,Z++}for(var R=W-V;R!==W&&U[R]===0;)R++;for(var st=d.repeat(G);R<W;++R)st+=r.charAt(U[R]);return st}function I(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var G=0;if(M[G]!==" "){for(var V=0,Z=0;M[G]===d;)V++,G++;for(var H=(M.length-G)*l+1>>>0,W=new Uint8Array(H);M[G];){var U=e[M.charCodeAt(G)];if(U===255)return;for(var $=0,k=H-1;(U!==0||$<Z)&&k!==-1;k--,$++)U+=h*W[k]>>>0,W[k]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");Z=$,G++}if(M[G]!==" "){for(var v=H-Z;v!==H&&W[v]===0;)v++;for(var R=new Uint8Array(V+(H-v)),st=V;v!==H;)R[st++]=W[v++];return R}}}function S(M){var G=I(M);if(G)return G;throw new Error(`Non-${t} character`)}return{encode:_,decodeUnsafe:I,decode:S}}var Bx=Lx,qx=Bx;const jm=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},jx=r=>new TextEncoder().encode(r),$x=r=>new TextDecoder().decode(r);class kx{constructor(t,e,i){this.name=t,this.prefix=e,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class zx{constructor(t,e,i){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return $m(this,t)}}class Hx{constructor(t){this.decoders=t}or(t){return $m(this,t)}decode(t){const e=t[0],i=this.decoders[e];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $m=(r,t)=>new Hx({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}});class Kx{constructor(t,e,i,s){this.name=t,this.prefix=e,this.baseEncode=i,this.baseDecode=s,this.encoder=new kx(t,e,i),this.decoder=new zx(t,e,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const qu=({name:r,prefix:t,encode:e,decode:i})=>new Kx(r,t,e,i),qa=({prefix:r,name:t,alphabet:e})=>{const{encode:i,decode:s}=qx(e,t);return qu({prefix:r,name:t,encode:i,decode:a=>jm(s(a))})},Vx=(r,t,e,i)=>{const s={};for(let w=0;w<t.length;++w)s[t[w]]=w;let a=r.length;for(;r[a-1]==="=";)--a;const u=new Uint8Array(a*e/8|0);let h=0,d=0,l=0;for(let w=0;w<a;++w){const _=s[r[w]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<e|_,h+=e,h>=8&&(h-=8,u[l++]=255&d>>h)}if(h>=e||255&d<<8-h)throw new SyntaxError("Unexpected end of data");return u},Gx=(r,t,e)=>{const i=t[t.length-1]==="=",s=(1<<e)-1;let a="",u=0,h=0;for(let d=0;d<r.length;++d)for(h=h<<8|r[d],u+=8;u>e;)u-=e,a+=t[s&h>>u];if(u&&(a+=t[s&h<<e-u]),i)for(;a.length*e&7;)a+="=";return a},Ar=({name:r,prefix:t,bitsPerChar:e,alphabet:i})=>qu({prefix:t,name:r,encode(s){return Gx(s,i,e)},decode(s){return Vx(s,i,e,r)}}),Wx=qu({prefix:"\0",name:"identity",encode:r=>$x(r),decode:r=>jx(r)});var Yx=Object.freeze({__proto__:null,identity:Wx});const Jx=Ar({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Qx=Object.freeze({__proto__:null,base2:Jx});const Xx=Ar({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Zx=Object.freeze({__proto__:null,base8:Xx});const t7=qa({prefix:"9",name:"base10",alphabet:"0123456789"});var e7=Object.freeze({__proto__:null,base10:t7});const r7=Ar({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),i7=Ar({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var n7=Object.freeze({__proto__:null,base16:r7,base16upper:i7});const s7=Ar({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),o7=Ar({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),a7=Ar({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),c7=Ar({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),u7=Ar({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),h7=Ar({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l7=Ar({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),f7=Ar({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d7=Ar({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var p7=Object.freeze({__proto__:null,base32:s7,base32upper:o7,base32pad:a7,base32padupper:c7,base32hex:u7,base32hexupper:h7,base32hexpad:l7,base32hexpadupper:f7,base32z:d7});const g7=qa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),m7=qa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var v7=Object.freeze({__proto__:null,base36:g7,base36upper:m7});const y7=qa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),w7=qa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var b7=Object.freeze({__proto__:null,base58btc:y7,base58flickr:w7});const _7=Ar({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),E7=Ar({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),A7=Ar({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),S7=Ar({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var I7=Object.freeze({__proto__:null,base64:_7,base64pad:E7,base64url:A7,base64urlpad:S7});const km=Array.from(""),D7=km.reduce((r,t,e)=>(r[e]=t,r),[]),x7=km.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function M7(r){return r.reduce((t,e)=>(t+=D7[e],t),"")}function P7(r){const t=[];for(const e of r){const i=x7[e.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(i)}return new Uint8Array(t)}const C7=qu({prefix:"",name:"base256emoji",encode:M7,decode:P7});var O7=Object.freeze({__proto__:null,base256emoji:C7}),N7=zm,lg=128,T7=127,R7=~T7,F7=Math.pow(2,31);function zm(r,t,e){t=t||[],e=e||0;for(var i=e;r>=F7;)t[e++]=r&255|lg,r/=128;for(;r&R7;)t[e++]=r&255|lg,r>>>=7;return t[e]=r|0,zm.bytes=e-i+1,t}var U7=tf,L7=128,fg=127;function tf(r,i){var e=0,i=i||0,s=0,a=i,u,h=r.length;do{if(a>=h)throw tf.bytes=0,new RangeError("Could not decode varint");u=r[a++],e+=s<28?(u&fg)<<s:(u&fg)*Math.pow(2,s),s+=7}while(u>=L7);return tf.bytes=a-i,e}var B7=Math.pow(2,7),q7=Math.pow(2,14),j7=Math.pow(2,21),$7=Math.pow(2,28),k7=Math.pow(2,35),z7=Math.pow(2,42),H7=Math.pow(2,49),K7=Math.pow(2,56),V7=Math.pow(2,63),G7=function(r){return r<B7?1:r<q7?2:r<j7?3:r<$7?4:r<k7?5:r<z7?6:r<H7?7:r<K7?8:r<V7?9:10},W7={encode:N7,decode:U7,encodingLength:G7},Hm=W7;const dg=(r,t,e=0)=>(Hm.encode(r,t,e),t),pg=r=>Hm.encodingLength(r),ef=(r,t)=>{const e=t.byteLength,i=pg(r),s=i+pg(e),a=new Uint8Array(s+e);return dg(r,a,0),dg(e,a,i),a.set(t,s),new Y7(r,e,t,a)};class Y7{constructor(t,e,i,s){this.code=t,this.size=e,this.digest=i,this.bytes=s}}const Km=({name:r,code:t,encode:e})=>new J7(r,t,e);class J7{constructor(t,e,i){this.name=t,this.code=e,this.encode=i}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?ef(this.code,e):e.then(i=>ef(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Vm=r=>async t=>new Uint8Array(await crypto.subtle.digest(r,t)),Q7=Km({name:"sha2-256",code:18,encode:Vm("SHA-256")}),X7=Km({name:"sha2-512",code:19,encode:Vm("SHA-512")});var Z7=Object.freeze({__proto__:null,sha256:Q7,sha512:X7});const Gm=0,tM="identity",Wm=jm,eM=r=>ef(Gm,Wm(r)),rM={code:Gm,name:tM,encode:Wm,digest:eM};var iM=Object.freeze({__proto__:null,identity:rM});new TextEncoder,new TextDecoder;const gg={...Yx,...Qx,...Zx,...e7,...n7,...p7,...v7,...b7,...I7,...O7};({...Z7,...iM});function nM(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Ym(r,t,e,i){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:i}}}const mg=Ym("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),_l=Ym("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);const t=nM(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),sM={utf8:mg,"utf-8":mg,hex:gg.base16,latin1:_l,ascii:_l,binary:_l,...gg};function oM(r,t="utf8"){const e=sM[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):e.decoder.decode(`${e.prefix}${r}`)}class aM{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name=ox,this.version=ax,this.initialized=!1,this.storagePrefix=vn,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,s)=>{this.isInitialized(),this.keychain.set(i,s),await this.persist()},this.get=i=>{this.isInitialized();const s=this.keychain.get(i);if(typeof s>"u"){const{message:a}=gt("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(a)}return s},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=t,this.logger=Br(e,this.name)}get context(){return Jr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,j1(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?$1(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}}class cM{constructor(t,e,i){this.core=t,this.logger=e,this.name=nx,this.randomSessionIdentifier=Ql(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),a=e0(s);return _1(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=UI();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const a=await this.getClientSeed(),u=e0(a),h=this.randomSessionIdentifier;return await eA(h,s,sx,u)},this.generateSharedKey=(s,a,u)=>{this.isInitialized();const h=this.getPrivateKey(s),d=LI(h,a);return this.setSymKey(d,u)},this.setSymKey=async(s,a)=>{this.isInitialized();const u=a||cu(s);return await this.keychain.set(u,s),u},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,a,u)=>{this.isInitialized();const h=Nm(u),d=qn(a);if(W0(h))return qI(d,u==null?void 0:u.encoding);if(G0(h)){const I=h.senderPublicKey,S=h.receiverPublicKey;s=await this.generateSharedKey(I,S)}const l=this.getSymKey(s),{type:w,senderPublicKey:_}=h;return BI({type:w,symKey:l,message:d,senderPublicKey:_,encoding:u==null?void 0:u.encoding})},this.decode=async(s,a,u)=>{this.isInitialized();const h=kI(a,u);if(W0(h)){const d=$I(a,u==null?void 0:u.encoding);return Ls(d)}if(G0(h)){const d=h.receiverPublicKey,l=h.senderPublicKey;s=await this.generateSharedKey(d,l)}try{const d=this.getSymKey(s),l=jI({symKey:d,encoded:a,encoding:u==null?void 0:u.encoding});return Ls(l)}catch(d){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(d)}},this.getPayloadType=(s,a=ss)=>{const u=Da({encoded:s,encoding:a});return qs(u.type)},this.getPayloadSenderPublicKey=(s,a=ss)=>{const u=Da({encoded:s,encoding:a});return u.senderPublicKey?yr(u.senderPublicKey,Lr):void 0},this.core=t,this.logger=Br(e,this.name),this.keychain=i||new aM(this.core,this.logger)}get context(){return Jr(this.logger)}async setPrivateKey(t,e){return await this.keychain.set(t,e),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(ug)}catch{t=Ql(),await this.keychain.set(ug,t)}return oM(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}}class uM extends $D{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name=cx,this.version=ux,this.initialized=!1,this.storagePrefix=vn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,s)=>{this.isInitialized();const a=Fn(s);let u=this.messages.get(i);return typeof u>"u"&&(u={}),typeof u[a]<"u"||(u[a]=s,this.messages.set(i,u),await this.persist()),a},this.get=i=>{this.isInitialized();let s=this.messages.get(i);return typeof s>"u"&&(s={}),s},this.has=(i,s)=>{this.isInitialized();const a=this.get(i),u=Fn(s);return typeof a[u]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Br(t,this.name),this.core=e}get context(){return Jr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,j1(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?$1(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}}class hM extends kD{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new Mi.EventEmitter,this.name=lx,this.queue=new Map,this.publishTimeout=mt.toMiliseconds(mt.ONE_MINUTE),this.failedPublishTimeout=mt.toMiliseconds(mt.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(i,s,a)=>{var u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:a}});const h=(a==null?void 0:a.ttl)||hx,d=Xl(a),l=(a==null?void 0:a.prompt)||!1,w=(a==null?void 0:a.tag)||0,_=(a==null?void 0:a.id)||Rs().toString(),I={topic:i,message:s,opts:{ttl:h,relay:d,prompt:l,tag:w,id:_,attestation:a==null?void 0:a.attestation}},S=`Failed to publish payload, please try again. id:${_} tag:${w}`,M=Date.now();let G,V=1;try{for(;G===void 0;){if(Date.now()-M>this.publishTimeout)throw new Error(S);this.logger.trace({id:_,attempts:V},`publisher.publish - attempt ${V}`),G=await await wo(this.rpcPublish(i,s,h,d,l,w,_,a==null?void 0:a.attestation).catch(Z=>this.logger.warn(Z)),this.publishTimeout,S),V++,G||await new Promise(Z=>setTimeout(Z,this.failedPublishTimeout))}this.relayer.events.emit(Fr.publish,I),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:_,topic:i,message:s,opts:a}})}catch(Z){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(Z),(u=a==null?void 0:a.internal)!=null&&u.throwOnFailedPublish)throw Z;this.queue.set(_,I)}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.relayer=t,this.logger=Br(e,this.name),this.registerEventListeners()}get context(){return Jr(this.logger)}rpcPublish(t,e,i,s,a,u,h,d){var l,w,_,I;const S={method:la(s.protocol).publish,params:{topic:t,message:e,ttl:i,prompt:a,tag:u,attestation:d},id:h};return Wr((l=S.params)==null?void 0:l.prompt)&&((w=S.params)==null||delete w.prompt),Wr((_=S.params)==null?void 0:_.tag)&&((I=S.params)==null||delete I.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:e,message:i,opts:s}=t;await this.publish(e,i,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(Oo.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Fr.connection_stalled);return}this.checkQueue()}),this.relayer.on(Fr.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class lM{constructor(){this.map=new Map,this.set=(t,e)=>{const i=this.get(t);this.exists(t,e)||this.map.set(t,[...i,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const i=this.get(t);if(!this.exists(t,e))return;const s=i.filter(a=>a!==e);if(!s.length){this.map.delete(t);return}this.map.set(t,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var fM=Object.defineProperty,dM=Object.defineProperties,pM=Object.getOwnPropertyDescriptors,vg=Object.getOwnPropertySymbols,gM=Object.prototype.hasOwnProperty,mM=Object.prototype.propertyIsEnumerable,yg=(r,t,e)=>t in r?fM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,aa=(r,t)=>{for(var e in t||(t={}))gM.call(t,e)&&yg(r,e,t[e]);if(vg)for(var e of vg(t))mM.call(t,e)&&yg(r,e,t[e]);return r},El=(r,t)=>dM(r,pM(t));class vM extends KD{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new lM,this.events=new Mi.EventEmitter,this.name=yx,this.version=wx,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=vn,this.subscribeTimeout=mt.toMiliseconds(mt.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(i,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}});try{const a=Xl(s),u={topic:i,relay:a,transportType:s==null?void 0:s.transportType};this.pending.set(i,u);const h=await this.rpcSubscribe(i,a,s==null?void 0:s.transportType);return typeof h=="string"&&(this.onSubscribe(h,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}})),h}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(i,s.id,s):await this.unsubscribeByTopic(i,s)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;const s=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((a,u)=>{const h=new mt.Watch;h.start(s);const d=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(d),h.stop(s),a(!0)),h.elapsed(s)>=bx&&(clearInterval(d),h.stop(s),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Br(e,this.name),this.clientId=""}get context(){return Jr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let i=!1;try{i=this.getSubscription(t).topic===e}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,e){const i=this.topicMap.get(t);await Promise.all(i.map(async s=>await this.unsubscribeById(t,s,e)))}async unsubscribeById(t,e,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:i}});try{const s=Xl(i);await this.rpcUnsubscribe(t,e,s);const a=Re("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,e,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,e,i=$e.relay){i===$e.relay&&await this.restartToComplete();const s={method:la(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{const a=Fn(t+this.clientId);return i===$e.link_mode?(setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(u=>this.logger.warn(u))},mt.toMiliseconds(mt.ONE_SECOND)),a):await await wo(this.relayer.request(s).catch(u=>this.logger.warn(u)),this.subscribeTimeout)?a:null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Fr.connection_stalled)}return null}async rpcBatchSubscribe(t){if(!t.length)return;const e=t[0].relay,i={method:la(e.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await wo(this.relayer.request(i).catch(s=>this.logger.warn(s)),this.subscribeTimeout)}catch{this.relayer.events.emit(Fr.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const e=t[0].relay,i={method:la(e.protocol).batchFetchMessages,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let s;try{s=await await wo(this.relayer.request(i).catch(a=>this.logger.warn(a)),this.subscribeTimeout)}catch{this.relayer.events.emit(Fr.connection_stalled)}return s}rpcUnsubscribe(t,e,i){const s={method:la(i.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,e){this.setSubscription(t,El(aa({},e),{id:t})),this.pending.delete(e.topic)}onBatchSubscribe(t){t.length&&t.forEach(e=>{this.setSubscription(e.id,aa({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(t,e,i){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,i),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,e){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e)}addSubscription(t,e){this.subscriptions.set(t,aa({},e)),this.topicMap.set(e.topic,t),this.events.emit(on.created,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const e=this.subscriptions.get(t);if(!e){const{message:i}=gt("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});const i=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(i.topic,t),this.events.emit(on.deleted,El(aa({},i),{reason:e}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(on.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let e=0;e<t;e++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(i),await this.batchSubscribe(i)}}this.events.emit(on.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:e}=gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const e=await this.rpcBatchSubscribe(t);mn(e)&&this.onBatchSubscribe(e.map((i,s)=>El(aa({},t[s]),{id:i})))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const e=await this.rpcBatchFetchMessages(t);e&&e.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(e.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const t=[];this.pending.forEach(e=>{t.push(e)}),await this.batchSubscribe(t),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(Oo.pulse,async()=>{await this.checkPending()}),this.events.on(on.created,async t=>{const e=on.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()}),this.events.on(on.deleted,async t=>{const e=on.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen(),this.restartInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.restartInProgress||(clearInterval(e),t())},this.pollingInterval)})}}var yM=Object.defineProperty,wg=Object.getOwnPropertySymbols,wM=Object.prototype.hasOwnProperty,bM=Object.prototype.propertyIsEnumerable,bg=(r,t,e)=>t in r?yM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,_M=(r,t)=>{for(var e in t||(t={}))wM.call(t,e)&&bg(r,e,t[e]);if(wg)for(var e of wg(t))bM.call(t,e)&&bg(r,e,t[e]);return r};class EM extends zD{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Mi.EventEmitter,this.name=dx,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=mt.toMiliseconds(mt.THIRTY_SECONDS+mt.ONE_SECOND),this.request=async e=>{var i,s;this.logger.debug("Publishing Request Payload");const a=e.id||Rs().toString();await this.toEstablishConnection();try{const u=this.provider.request(e);this.requestsInFlight.set(a,{promise:u,request:e}),this.logger.trace({id:a,method:e.method,topic:(i=e.params)==null?void 0:i.topic},"relayer.request - attempt to publish...");const h=await new Promise(async(d,l)=>{const w=()=>{l(new Error(`relayer.request - publish interrupted, id: ${a}`))};this.provider.on(Ei.disconnect,w);const _=await u;this.provider.off(Ei.disconnect,w),d(_)});return this.logger.trace({id:a,method:e.method,topic:(s=e.params)==null?void 0:s.topic},"relayer.request - published"),h}catch(u){throw this.logger.debug(`Failed to Publish Request: ${a}`),u}finally{this.requestsInFlight.delete(a)}},this.resetPingTimeout=()=>{if(vu())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,i,s;(s=(i=(e=this.provider)==null?void 0:e.connection)==null?void 0:i.socket)==null||s.terminate()},this.heartBeatTimeout)}catch(e){this.logger.warn(e)}},this.onPayloadHandler=e=>{this.onProviderPayload(e),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit(Fr.connect)},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.error(e),this.events.emit(Fr.error,e),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ei.payload,this.onPayloadHandler),this.provider.on(Ei.connect,this.onConnectHandler),this.provider.on(Ei.disconnect,this.onDisconnectHandler),this.provider.on(Ei.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Br(t.logger,this.name):Pa(xu({level:t.logger||fx})),this.messages=new uM(this.logger,t.core),this.subscriber=new vM(this,this.logger),this.publisher=new hM(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Bm,this.projectId=t.projectId,this.bundleId=D8(),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(t){this.logger.warn(t)}}get context(){return Jr(this.logger)}get connected(){var t,e,i;return((i=(e=(t=this.provider)==null?void 0:t.connection)==null?void 0:e.socket)==null?void 0:i.readyState)===1}get connecting(){var t,e,i;return((i=(e=(t=this.provider)==null?void 0:t.connection)==null?void 0:e.socket)==null?void 0:i.readyState)===0}async publish(t,e,i){this.isInitialized(),await this.publisher.publish(t,e,i),await this.recordMessageEvent({topic:t,message:e,publishedAt:Date.now(),transportType:$e.relay})}async subscribe(t,e){var i;this.isInitialized(),(e==null?void 0:e.transportType)==="relay"&&await this.toEstablishConnection();let s=((i=this.subscriber.topicMap.get(t))==null?void 0:i[0])||"",a;const u=h=>{h.topic===t&&(this.subscriber.off(on.created,u),a())};return await Promise.all([new Promise(h=>{a=h,this.subscriber.on(on.created,u)}),new Promise(async h=>{s=await this.subscriber.subscribe(t,e)||s,h()})]),s}async unsubscribe(t,e){this.isInitialized(),await this.subscriber.unsubscribe(t,e)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(t=>t.promise))}catch(t){this.logger.warn(t)}this.hasExperiencedNetworkDisruption||this.connected?await wo(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(e,i)=>{const s=()=>{this.provider.off(Ei.disconnect,s),i(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Ei.disconnect,s),await wo(this.provider.connect(),mt.toMiliseconds(mt.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{i(a)}).finally(()=>{clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),this.subscriber.start().catch(a=>{this.logger.error(a),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){this.logger.error(e);const i=e;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(i.message))throw e}finally{this.connectionAttemptInProgress=!1}}async restartTransport(t){this.connectionAttemptInProgress||(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await sg())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if((t==null?void 0:t.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const e=t.sort((i,s)=>i.publishedAt-s.publishedAt);this.logger.trace(`Batch of ${e.length} message events sorted`);for(const i of e)try{await this.onMessageEvent(i)}catch(s){this.logger.warn(s)}this.logger.trace(`Batch of ${e.length} message events processed`)}async onLinkMessageEvent(t,e){const{topic:i}=t;if(!e.sessionExists){const s=hr(mt.FIVE_MINUTES),a={topic:i,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,a)}this.events.emit(Fr.message,t),await this.recordMessageEvent(t)}startPingTimeout(){var t,e,i,s,a;if(vu())try{(e=(t=this.provider)==null?void 0:t.connection)!=null&&e.socket&&((a=(s=(i=this.provider)==null?void 0:i.connection)==null?void 0:s.socket)==null||a.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(u){this.logger.warn(u)}}isConnectionStalled(t){return this.staleConnectionErrors.some(e=>t.includes(e))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new zi(new ex(C8({sdkVersion:Zl,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:e,message:i}=t;await this.messages.set(e,i)}async shouldIgnoreMessageEvent(t){const{topic:e,message:i}=t;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(e))return this.logger.debug(`Ignoring message for non-subscribed topic ${e}`),!0;const s=this.messages.has(e,i);return s&&this.logger.debug(`Ignoring duplicate message: ${i}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),gf(t)){if(!t.method.endsWith(px))return;const e=t.params,{topic:i,message:s,publishedAt:a,attestation:u}=e.data,h={topic:i,message:s,publishedAt:a,transportType:$e.relay,attestation:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(_M({type:"event",event:e.id},h)),this.events.emit(e.id,h),await this.acknowledgePayload(t),await this.onMessageEvent(h)}else Lu(t)&&this.events.emit(Fr.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Fr.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const e=Fu(t.id,!0);await this.provider.connection.send(e)}unregisterProviderListeners(){this.provider.off(Ei.payload,this.onPayloadHandler),this.provider.off(Ei.connect,this.onConnectHandler),this.provider.off(Ei.disconnect,this.onDisconnectHandler),this.provider.off(Ei.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await sg();FD(async e=>{t!==e&&(t=e,e?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(Fr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t))},mt.toMiliseconds(gx))))}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.connected&&(clearInterval(e),t())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var AM=Object.defineProperty,_g=Object.getOwnPropertySymbols,SM=Object.prototype.hasOwnProperty,IM=Object.prototype.propertyIsEnumerable,Eg=(r,t,e)=>t in r?AM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ag=(r,t)=>{for(var e in t||(t={}))SM.call(t,e)&&Eg(r,e,t[e]);if(_g)for(var e of _g(t))IM.call(t,e)&&Eg(r,e,t[e]);return r};class Hs extends HD{constructor(t,e,i,s=vn,a=void 0){super(t,e,i,s),this.core=t,this.logger=e,this.name=i,this.map=new Map,this.version=mx,this.cached=[],this.initialized=!1,this.storagePrefix=vn,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(u=>{this.getKey&&u!==null&&!Wr(u)?this.map.set(this.getKey(u),u):fD(u)?this.map.set(u.id,u):dD(u)&&this.map.set(u.topic,u)}),this.cached=[],this.initialized=!0)},this.set=async(u,h)=>{this.isInitialized(),this.map.has(u)?await this.update(u,h):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:u,value:h}),this.map.set(u,h),await this.persist())},this.get=u=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:u}),this.getData(u)),this.getAll=u=>(this.isInitialized(),u?this.values.filter(h=>Object.keys(u).every(d=>y8(h[d],u[d]))):this.values),this.update=async(u,h)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:u,update:h});const d=Ag(Ag({},this.getData(u)),h);this.map.set(u,d),await this.persist()},this.delete=async(u,h)=>{this.isInitialized(),this.map.has(u)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:u,reason:h}),this.map.delete(u),this.addToRecentlyDeleted(u),await this.persist())},this.logger=Br(e,this.name),this.storagePrefix=s,this.getKey=a}get context(){return Jr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const e=this.map.get(t);if(!e){if(this.recentlyDeleted.includes(t)){const{message:s}=gt("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}const{message:i}=gt("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return e}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:e}=gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}}class DM{constructor(t,e){this.core=t,this.logger=e,this.name=_x,this.version=Ex,this.events=new of,this.initialized=!1,this.storagePrefix=vn,this.ignoredPayloadTypes=[Bn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();const s=Ql(),a=await this.core.crypto.setSymKey(s),u=hr(mt.FIVE_MINUTES),h={protocol:Lm},d={topic:a,expiry:u,relay:h,active:!1,methods:i==null?void 0:i.methods},l=Z0({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:h,expiryTimestamp:u,methods:i==null?void 0:i.methods});return this.events.emit(Ts.create,d),this.core.expirer.set(a,u),await this.pairings.set(a,d),await this.core.relayer.subscribe(a,{transportType:i==null?void 0:i.transportType}),{topic:a,uri:l}},this.pair=async i=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[en.pairing_started]}});this.isValidPair(i,s);const{topic:a,symKey:u,relay:h,expiryTimestamp:d,methods:l}=X0(i.uri);s.props.properties.topic=a,s.addTrace(en.pairing_uri_validation_success),s.addTrace(en.pairing_uri_not_expired);let w;if(this.pairings.keys.includes(a)){if(w=this.pairings.get(a),s.addTrace(en.existing_pairing),w.active)throw s.setError(Tn.active_pairing_already_exists),new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);s.addTrace(en.pairing_not_expired)}const _=d||hr(mt.FIVE_MINUTES),I={topic:a,relay:h,expiry:_,active:!1,methods:l};this.core.expirer.set(a,_),await this.pairings.set(a,I),s.addTrace(en.store_new_pairing),i.activatePairing&&await this.activate({topic:a}),this.events.emit(Ts.create,I),s.addTrace(en.emit_inactive_pairing),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(u,a),s.addTrace(en.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Tn.no_internet_connection)}try{await this.core.relayer.subscribe(a,{relay:h})}catch(S){throw s.setError(Tn.subscribe_pairing_topic_failure),S}return s.addTrace(en.subscribe_pairing_topic_success),I},this.activate=async({topic:i})=>{this.isInitialized();const s=hr(mt.THIRTY_DAYS);this.core.expirer.set(i,s),await this.pairings.update(i,{active:!0,expiry:s})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.pairings.keys.includes(s)){const a=await this.sendRequest(s,"wc_pairingPing",{}),{done:u,resolve:h,reject:d}=Ns();this.events.once(pe("pairing_ping",a),({error:l})=>{l?d(l):h()}),await u()}},this.updateExpiry=async({topic:i,expiry:s})=>{this.isInitialized(),await this.pairings.update(i,{expiry:s})},this.updateMetadata=async({topic:i,metadata:s})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Re("USER_DISCONNECTED")),await this.deletePairing(s))},this.formatUriFromPairing=i=>{this.isInitialized();const{topic:s,relay:a,expiry:u,methods:h}=i,d=this.core.crypto.keychain.get(s);return Z0({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:d,relay:a,expiryTimestamp:u,methods:h})},this.sendRequest=async(i,s,a)=>{const u=ns(s,a),h=await this.core.crypto.encode(i,u),d=sa[s].req;return this.core.history.set(i,u),this.core.relayer.publish(i,h,d),u.id},this.sendResult=async(i,s,a)=>{const u=Fu(i,a),h=await this.core.crypto.encode(s,u),d=await this.core.history.get(s,i),l=sa[d.request.method].res;await this.core.relayer.publish(s,h,l),await this.core.history.resolve(u)},this.sendError=async(i,s,a)=>{const u=Uu(i,a),h=await this.core.crypto.encode(s,u),d=await this.core.history.get(s,i),l=sa[d.request.method]?sa[d.request.method].res:sa.unregistered_method.res;await this.core.relayer.publish(s,h,l),await this.core.history.resolve(u)},this.deletePairing=async(i,s)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Re("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),s?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(s=>ts(s.expiry));await Promise.all(i.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=i=>{const{topic:s,payload:a}=i;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(s,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,a);default:return this.onUnknownRpcMethodRequest(s,a)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:a}=i,u=(await this.core.history.get(s,a.id)).request.method;switch(u){case"wc_pairingPing":return this.onPairingPingResponse(s,a);default:return this.onUnknownRpcMethodResponse(u)}},this.onPairingPingRequest=async(i,s)=>{const{id:a}=s;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.events.emit(Ts.ping,{id:a,topic:i})}catch(u){await this.sendError(a,i,u),this.logger.error(u)}},this.onPairingPingResponse=(i,s)=>{const{id:a}=s;setTimeout(()=>{rn(s)?this.events.emit(pe("pairing_ping",a),{}):Ii(s)&&this.events.emit(pe("pairing_ping",a),{error:s.error})},500)},this.onPairingDeleteRequest=async(i,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Ts.delete,{id:a,topic:i})}catch(u){await this.sendError(a,i,u),this.logger.error(u)}},this.onUnknownRpcMethodRequest=async(i,s)=>{const{id:a,method:u}=s;try{if(this.registeredMethods.includes(u))return;const h=Re("WC_METHOD_UNSUPPORTED",u);await this.sendError(a,i,h),this.logger.error(h)}catch(h){await this.sendError(a,i,h),this.logger.error(h)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Re("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=(i,s)=>{var a;if(!Vr(i)){const{message:h}=gt("MISSING_OR_INVALID",`pair() params: ${i}`);throw s.setError(Tn.malformed_pairing_uri),new Error(h)}if(!lD(i.uri)){const{message:h}=gt("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw s.setError(Tn.malformed_pairing_uri),new Error(h)}const u=X0(i==null?void 0:i.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:h}=gt("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Tn.malformed_pairing_uri),new Error(h)}if(!(u!=null&&u.symKey)){const{message:h}=gt("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Tn.malformed_pairing_uri),new Error(h)}if(u!=null&&u.expiryTimestamp&&mt.toMiliseconds(u==null?void 0:u.expiryTimestamp)<Date.now()){s.setError(Tn.pairing_expired);const{message:h}=gt("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(h)}},this.isValidPing=async i=>{if(!Vr(i)){const{message:a}=gt("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidDisconnect=async i=>{if(!Vr(i)){const{message:a}=gt("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async i=>{if(!nr(i,!1)){const{message:s}=gt("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(s)}if(!this.pairings.keys.includes(i)){const{message:s}=gt("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(s)}if(ts(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:s}=gt("EXPIRED",`pairing topic: ${i}`);throw new Error(s)}},this.core=t,this.logger=Br(e,this.name),this.pairings=new Hs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Jr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Fr.message,async t=>{const{topic:e,message:i,transportType:s}=t;if(!this.pairings.keys.includes(e)||s===$e.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const a=await this.core.crypto.decode(e,i);try{gf(a)?(this.core.history.set(e,a),this.onRelayEventRequest({topic:e,payload:a})):Lu(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:e,payload:a}),this.core.history.delete(e,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Ai.expired,async t=>{const{topic:e}=z1(t.target);e&&this.pairings.keys.includes(e)&&(await this.deletePairing(e,!0),this.events.emit(Ts.expire,{topic:e}))})}}class xM extends jD{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new Mi.EventEmitter,this.name=Ax,this.version=Sx,this.cached=[],this.initialized=!1,this.storagePrefix=vn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,s,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:s,chainId:a}),this.records.has(s.id))return;const u={id:s.id,topic:i,request:{method:s.method,params:s.params||null},chainId:a,expiry:hr(mt.THIRTY_DAYS)};this.records.set(u.id,u),this.persist(),this.events.emit(Ui.created,u)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const s=await this.getRecord(i.id);typeof s.response>"u"&&(s.response=Ii(i)?{error:i.error}:{result:i.result},this.records.set(s.id,s),this.persist(),this.events.emit(Ui.updated,s))},this.get=async(i,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:s}),await this.getRecord(s)),this.delete=(i,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(a=>{if(a.topic===i){if(typeof s<"u"&&a.id!==s)return;this.records.delete(a.id),this.events.emit(Ui.deleted,a)}}),this.persist()},this.exists=async(i,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===i:!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Br(e,this.name)}get context(){return Jr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(e=>{if(typeof e.response<"u")return;const i={topic:e.topic,request:ns(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(i)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const e=this.records.get(t);if(!e){const{message:i}=gt("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return e}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ui.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:e}=gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Ui.created,t=>{const e=Ui.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.events.on(Ui.updated,t=>{const e=Ui.updated;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.events.on(Ui.deleted,t=>{const e=Ui.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.core.heartbeat.on(Oo.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(e=>{mt.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.records.delete(e.id),this.events.emit(Ui.deleted,e,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}}class MM extends VD{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new Mi.EventEmitter,this.name=Ix,this.version=Dx,this.cached=[],this.initialized=!1,this.storagePrefix=vn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const s=this.formatTarget(i);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(i,s)=>{this.isInitialized();const a=this.formatTarget(i),u={target:a,expiry:s};this.expirations.set(a,u),this.checkExpiry(a,u),this.events.emit(Ai.created,{target:a,expiration:u})},this.get=i=>{this.isInitialized();const s=this.formatTarget(i);return this.getExpiration(s)},this.del=i=>{if(this.isInitialized(),this.has(i)){const s=this.formatTarget(i),a=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Ai.deleted,{target:s,expiration:a})}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Br(e,this.name)}get context(){return Jr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return O8(t);if(typeof t=="number")return N8(t);const{message:e}=gt("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(e)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ai.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:e}=gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const e=this.expirations.get(t);if(!e){const{message:i}=gt("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(i),new Error(i)}return e}checkExpiry(t,e){const{expiry:i}=e;mt.toMiliseconds(i)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit(Ai.expired,{target:t,expiration:e})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,e)=>this.checkExpiry(e,t))}registerEventListeners(){this.core.heartbeat.on(Oo.pulse,()=>this.checkExpirations()),this.events.on(Ai.created,t=>{const e=Ai.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(Ai.expired,t=>{const e=Ai.expired;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(Ai.deleted,t=>{const e=Ai.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.getLocalStorage=Ve.getLocalStorageOrThrow=Ve.getCrypto=Ve.getCryptoOrThrow=Ve.getLocation=Ve.getLocationOrThrow=Ve.getNavigator=Ve.getNavigatorOrThrow=Jm=Ve.getDocument=Ve.getDocumentOrThrow=Ve.getFromWindowOrThrow=Ve.getFromWindow=void 0;function Ks(r){let t;return typeof window<"u"&&typeof window[r]<"u"&&(t=window[r]),t}Ve.getFromWindow=Ks;function No(r){const t=Ks(r);if(!t)throw new Error(`${r} is not defined in Window`);return t}Ve.getFromWindowOrThrow=No;function PM(){return No("document")}Ve.getDocumentOrThrow=PM;function CM(){return Ks("document")}var Jm=Ve.getDocument=CM;function OM(){return No("navigator")}Ve.getNavigatorOrThrow=OM;function NM(){return Ks("navigator")}Ve.getNavigator=NM;function TM(){return No("location")}Ve.getLocationOrThrow=TM;function RM(){return Ks("location")}Ve.getLocation=RM;function FM(){return No("crypto")}Ve.getCryptoOrThrow=FM;function UM(){return Ks("crypto")}Ve.getCrypto=UM;function LM(){return No("localStorage")}Ve.getLocalStorageOrThrow=LM;function BM(){return Ks("localStorage")}Ve.getLocalStorage=BM;class qM extends GD{constructor(t,e,i){super(t,e,i),this.core=t,this.logger=e,this.store=i,this.name=xx,this.verifyUrlV3=Px,this.storagePrefix=vn,this.version=Um,this.init=async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&mt.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async s=>{if(!Ra()||this.isDevEnv)return;const a=window.location.origin,{id:u,decryptedId:h}=s,d=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${a}&id=${u}&decryptedId=${h}`;try{const l=Jm(),w=this.startAbortTimer(mt.ONE_SECOND*5),_=await new Promise((I,S)=>{const M=()=>{window.removeEventListener("message",V),l.body.removeChild(G),S("attestation aborted")};this.abortController.signal.addEventListener("abort",M);const G=l.createElement("iframe");G.src=d,G.style.display="none",G.addEventListener("error",M,{signal:this.abortController.signal});const V=Z=>{if(Z.data&&typeof Z.data=="string")try{const H=JSON.parse(Z.data);if(H.type==="verify_attestation"){if(ql(H.attestation).payload.id!==u)return;clearInterval(w),l.body.removeChild(G),this.abortController.signal.removeEventListener("abort",M),window.removeEventListener("message",V),I(H.attestation===null?"":H.attestation)}}catch(H){this.logger.warn(H)}};l.body.appendChild(G),window.addEventListener("message",V,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",_),_}catch(l){this.logger.warn(l)}return""},this.resolve=async s=>{if(this.isDevEnv)return"";const{attestationId:a,hash:u,encryptedId:h}=s;if(a===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(a){if(ql(a).payload.id!==h)return;const l=await this.isValidJwtAttestation(a);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!u)return;const d=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(u,d)},this.fetchAttestation=async(s,a)=>{this.logger.debug(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(mt.ONE_SECOND*5),h=await fetch(`${a}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(u),h.status===200?await h.json():void 0},this.getVerifyUrl=s=>{let a=s||ya;return Cx.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${ya}`),a=ya),a},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(mt.FIVE_SECONDS),a=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await a.json()}catch(s){this.logger.warn(s)}},this.persistPublicKey=async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async s=>{const a=await this.getPublicKey();try{if(a)return this.validateAttestation(s,a)}catch(h){this.logger.error(h),this.logger.warn("error validating attestation")}const u=await this.fetchAndPersistPublicKey();try{if(u)return this.validateAttestation(s,u)}catch(h){this.logger.error(h),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{const u=await this.fetchPublicKey();u&&(await this.persistPublicKey(u),a(u))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s},this.validateAttestation=(s,a)=>{const u=VI(s,a.publicKey),h={hasExpired:mt.toMiliseconds(u.exp)<Date.now(),payload:u};if(h.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:h.payload.origin,isScam:h.payload.isScam,isVerified:h.payload.isVerified}},this.logger=Br(e,this.name),this.abortController=new AbortController,this.isDevEnv=mf(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Jr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),mt.toMiliseconds(t))}}class jM extends WD{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.context=Ox,this.registerDeviceToken=async i=>{const{clientId:s,token:a,notificationType:u,enableEncrypted:h=!1}=i,d=`${Nx}/${this.projectId}/clients`;await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:u,token:a,always_raw:h})})},this.logger=Br(e,this.context)}}var $M=Object.defineProperty,Sg=Object.getOwnPropertySymbols,kM=Object.prototype.hasOwnProperty,zM=Object.prototype.propertyIsEnumerable,Ig=(r,t,e)=>t in r?$M(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,ca=(r,t)=>{for(var e in t||(t={}))kM.call(t,e)&&Ig(r,e,t[e]);if(Sg)for(var e of Sg(t))zM.call(t,e)&&Ig(r,e,t[e]);return r};class HM extends YD{constructor(t,e,i=!0){super(t,e,i),this.core=t,this.logger=e,this.context=Rx,this.storagePrefix=vn,this.storageVersion=Tx,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!mf())try{const s={eventId:v0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:q1(this.core.relayer.protocol,this.core.relayer.version,Zl)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}},this.createEvent=s=>{const{event:a="ERROR",type:u="",properties:{topic:h,trace:d}}=s,l=v0(),w=this.core.projectId||"",_=Date.now(),I=ca({eventId:l,timestamp:_,props:{event:a,type:u,properties:{topic:h,trace:d}},bundleId:w,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,I),this.shouldPersist=!0),I},this.getEvent=s=>{const{eventId:a,topic:u}=s;if(a)return this.events.get(a);const h=Array.from(this.events.values()).find(d=>d.props.properties.topic===u);if(h)return ca(ca({},h),this.setMethods(h.eventId))},this.deleteEvent=s=>{const{eventId:a}=s;this.events.delete(a),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(Oo.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{mt.fromMiliseconds(Date.now())-mt.fromMiliseconds(s.timestamp)>Fx&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})},this.setMethods=s=>({addTrace:a=>this.addTrace(s,a),setError:a=>this.setError(s,a)}),this.addTrace=(s,a)=>{const u=this.events.get(s);u&&(u.props.properties.trace.push(a),this.events.set(s,u),this.shouldPersist=!0)},this.setError=(s,a)=>{const u=this.events.get(s);u&&(u.props.type=a,u.timestamp=Date.now(),this.events.set(s,u),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(a=>{this.events.set(a.eventId,ca(ca({},a),this.setMethods(a.eventId)))})}catch(s){this.logger.warn(s)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[a,u]of this.events)u.props.type&&s.push(u);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const a of s)this.events.delete(a.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}},this.sendEvent=async s=>{const a=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Ux}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Zl}${a}`,{method:"POST",body:JSON.stringify(s)})},this.getAppDomain=()=>B1().url,this.logger=Br(e,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var KM=Object.defineProperty,Dg=Object.getOwnPropertySymbols,VM=Object.prototype.hasOwnProperty,GM=Object.prototype.propertyIsEnumerable,xg=(r,t,e)=>t in r?KM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Mg=(r,t)=>{for(var e in t||(t={}))VM.call(t,e)&&xg(r,e,t[e]);if(Dg)for(var e of Dg(t))GM.call(t,e)&&xg(r,e,t[e]);return r};class Mf extends qD{constructor(t){var e;super(t),this.protocol=Fm,this.version=Um,this.name=xf,this.events=new Mi.EventEmitter,this.initialized=!1,this.on=(u,h)=>this.events.on(u,h),this.once=(u,h)=>this.events.once(u,h),this.off=(u,h)=>this.events.off(u,h),this.removeListener=(u,h)=>this.events.removeListener(u,h),this.dispatchEnvelope=({topic:u,message:h,sessionExists:d})=>{if(!u||!h)return;const l={topic:u,message:h,publishedAt:Date.now(),transportType:$e.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:d})},this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Bm,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const i=xu({level:typeof(t==null?void 0:t.logger)=="string"&&t.logger?t.logger:rx.logger}),{logger:s,chunkLoggerController:a}=yE({opts:i,maxSizeInBytes:t==null?void 0:t.maxLogBlobSizeInBytes,loggerOverride:t==null?void 0:t.logger});this.logChunkController=a,(e=this.logChunkController)!=null&&e.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var u,h;(u=this.logChunkController)!=null&&u.downloadLogsBlobInBrowser&&((h=this.logChunkController)==null||h.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Br(s,this.name),this.heartbeat=new Df,this.crypto=new cM(this,this.logger,t==null?void 0:t.keychain),this.history=new xM(this,this.logger),this.expirer=new MM(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new m6(Mg(Mg({},ix),t==null?void 0:t.storageOptions)),this.relayer=new EM({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new DM(this,this.logger),this.verify=new qM(this,this.logger,this.storage),this.echoClient=new jM(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new HM(this,this.logger,t==null?void 0:t.telemetryEnabled)}static async init(t){const e=new Mf(t);await e.initialize();const i=await e.crypto.getClientId();return await e.storage.setItem(vx,i),e}get context(){return Jr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(hg,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.eventClient.init(),this.linkModeSupportedApps=await this.storage.getItem(hg)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const WM=Mf,Qm="wc",Xm=2,Zm="client",Pf=`${Qm}@${Xm}:${Zm}:`,Al={name:Zm,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},Pg="WALLETCONNECT_DEEPLINK_CHOICE",YM="proposal",tv="Proposal expired",JM="session",po=mt.SEVEN_DAYS,QM="engine",gr={wc_sessionPropose:{req:{ttl:mt.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:mt.ONE_DAY,prompt:!1,tag:1104},res:{ttl:mt.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:mt.ONE_DAY,prompt:!1,tag:1106},res:{ttl:mt.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:mt.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:mt.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:mt.ONE_DAY,prompt:!1,tag:1112},res:{ttl:mt.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:mt.ONE_DAY,prompt:!1,tag:1114},res:{ttl:mt.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:mt.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:mt.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:mt.FIVE_MINUTES,prompt:!1,tag:1119}}},Sl={min:mt.FIVE_MINUTES,max:mt.SEVEN_DAYS},tn={idle:"IDLE",active:"ACTIVE"},XM="request",ZM=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],tP="wc",eP="auth",rP="authKeys",iP="pairingTopics",nP="requests",ju=`${tP}@${1.5}:${eP}:`,uu=`${ju}:PUB_KEY`;var sP=Object.defineProperty,oP=Object.defineProperties,aP=Object.getOwnPropertyDescriptors,Cg=Object.getOwnPropertySymbols,cP=Object.prototype.hasOwnProperty,uP=Object.prototype.propertyIsEnumerable,Og=(r,t,e)=>t in r?sP(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Xe=(r,t)=>{for(var e in t||(t={}))cP.call(t,e)&&Og(r,e,t[e]);if(Cg)for(var e of Cg(t))uP.call(t,e)&&Og(r,e,t[e]);return r},Bi=(r,t)=>oP(r,aP(t));class hP extends QD{constructor(t){super(t),this.name=QM,this.events=new of,this.initialized=!1,this.requestQueue={state:tn.idle,queue:[]},this.sessionRequestQueue={state:tn.idle,queue:[]},this.requestQueueDelay=mt.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(gr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},mt.toMiliseconds(this.requestQueueDelay)))},this.connect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=Bi(Xe({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:h,relays:d}=i;let l=s,w,_=!1;try{l&&(_=this.client.core.pairing.pairings.get(l).active)}catch(U){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),U}if(!l||!_){const{topic:U,uri:$}=await this.client.core.pairing.create();l=U,w=$}if(!l){const{message:U}=gt("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(U)}const I=await this.client.core.crypto.generateKeyPair(),S=gr.wc_sessionPropose.req.ttl||mt.FIVE_MINUTES,M=hr(S),G=Xe({requiredNamespaces:a,optionalNamespaces:u,relays:d??[{protocol:Lm}],proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:M,pairingTopic:l},h&&{sessionProperties:h}),{reject:V,resolve:Z,done:H}=Ns(S,tv);this.events.once(pe("session_connect"),async({error:U,session:$})=>{if(U)V(U);else if($){$.self.publicKey=I;const k=Bi(Xe({},$),{pairingTopic:G.pairingTopic,requiredNamespaces:G.requiredNamespaces,optionalNamespaces:G.optionalNamespaces,transportType:$e.relay});await this.client.session.set($.topic,k),await this.setExpiry($.topic,$.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:$.peer.metadata}),this.cleanupDuplicatePairings(k),Z(k)}});const W=await this.sendRequest({topic:l,method:"wc_sessionPropose",params:G,throwOnFailedPublish:!0});return await this.setProposal(W,Xe({id:W},G)),{uri:w,approval:H}},this.pair=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async e=>{var i,s,a;const u=this.client.core.eventClient.createEvent({properties:{topic:(i=e==null?void 0:e.id)==null?void 0:i.toString(),trace:[Li.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(R){throw u.setError(Cs.no_internet_connection),R}try{await this.isValidProposalId(e==null?void 0:e.id)}catch(R){throw this.client.logger.error(`approve() -> proposal.get(${e==null?void 0:e.id}) failed`),u.setError(Cs.proposal_not_found),R}try{await this.isValidApprove(e)}catch(R){throw this.client.logger.error("approve() -> isValidApprove() failed"),u.setError(Cs.session_approve_namespace_validation_failure),R}const{id:h,relayProtocol:d,namespaces:l,sessionProperties:w,sessionConfig:_}=e,I=this.client.proposal.get(h);this.client.core.eventClient.deleteEvent({eventId:u.eventId});const{pairingTopic:S,proposer:M,requiredNamespaces:G,optionalNamespaces:V}=I;let Z=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:S});Z||(Z=(a=this.client.core.eventClient)==null?void 0:a.createEvent({type:Li.session_approve_started,properties:{topic:S,trace:[Li.session_approve_started,Li.session_namespaces_validation_success]}}));const H=await this.client.core.crypto.generateKeyPair(),W=M.publicKey,U=await this.client.core.crypto.generateSharedKey(H,W),$=Xe(Xe({relay:{protocol:d??"irn"},namespaces:l,controller:{publicKey:H,metadata:this.client.metadata},expiry:hr(po)},w&&{sessionProperties:w}),_&&{sessionConfig:_}),k=$e.relay;Z.addTrace(Li.subscribing_session_topic);try{await this.client.core.relayer.subscribe(U,{transportType:k})}catch(R){throw Z.setError(Cs.subscribe_session_topic_failure),R}Z.addTrace(Li.subscribe_session_topic_success);const v=Bi(Xe({},$),{topic:U,requiredNamespaces:G,optionalNamespaces:V,pairingTopic:S,acknowledged:!1,self:$.controller,peer:{publicKey:M.publicKey,metadata:M.metadata},controller:H,transportType:$e.relay});await this.client.session.set(U,v),Z.addTrace(Li.store_session);try{Z.addTrace(Li.publishing_session_settle),await this.sendRequest({topic:U,method:"wc_sessionSettle",params:$,throwOnFailedPublish:!0}).catch(R=>{throw Z==null||Z.setError(Cs.session_settle_publish_failure),R}),Z.addTrace(Li.session_settle_publish_success),Z.addTrace(Li.publishing_session_approve),await this.sendResult({id:h,topic:S,result:{relay:{protocol:d??"irn"},responderPublicKey:H},throwOnFailedPublish:!0}).catch(R=>{throw Z==null||Z.setError(Cs.session_approve_publish_failure),R}),Z.addTrace(Li.session_approve_publish_success)}catch(R){throw this.client.logger.error(R),this.client.session.delete(U,Re("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(U),R}return this.client.core.eventClient.deleteEvent({eventId:Z.eventId}),await this.client.core.pairing.updateMetadata({topic:S,metadata:M.metadata}),await this.client.proposal.delete(h,Re("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:S}),await this.setExpiry(U,hr(po)),{topic:U,acknowledged:()=>Promise.resolve(this.client.session.get(U))}},this.reject=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(u){throw this.client.logger.error("reject() -> isValidReject() failed"),u}const{id:i,reason:s}=e;let a;try{a=this.client.proposal.get(i).pairingTopic}catch(u){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),u}a&&(await this.sendError({id:i,topic:a,error:s,rpcOpts:gr.wc_sessionPropose.reject}),await this.client.proposal.delete(i,Re("USER_DISCONNECTED")))},this.update=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(_){throw this.client.logger.error("update() -> isValidUpdate() failed"),_}const{topic:i,namespaces:s}=e,{done:a,resolve:u,reject:h}=Ns(),d=Zn(),l=Rs().toString(),w=this.client.session.get(i).namespaces;return this.events.once(pe("session_update",d),({error:_})=>{_?h(_):u()}),await this.client.session.update(i,{namespaces:s}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:d,relayRpcId:l}).catch(_=>{this.client.logger.error(_),this.client.session.update(i,{namespaces:w}),h(_)}),{acknowledged:a}},this.extend=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(d){throw this.client.logger.error("extend() -> isValidExtend() failed"),d}const{topic:i}=e,s=Zn(),{done:a,resolve:u,reject:h}=Ns();return this.events.once(pe("session_extend",s),({error:d})=>{d?h(d):u()}),await this.setExpiry(i,hr(po)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(d=>{h(d)}),{acknowledged:a}},this.request=async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(M){throw this.client.logger.error("request() -> isValidRequest() failed"),M}const{chainId:i,request:s,topic:a,expiry:u=gr.wc_sessionRequest.req.ttl}=e,h=this.client.session.get(a);(h==null?void 0:h.transportType)===$e.relay&&await this.confirmOnlineStateOrThrow();const d=Zn(),l=Rs().toString(),{done:w,resolve:_,reject:I}=Ns(u,"Request expired. Please try again.");this.events.once(pe("session_request",d),({error:M,result:G})=>{M?I(M):_(G)});const S=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);return S?(await this.sendRequest({clientRpcId:d,relayRpcId:l,topic:a,method:"wc_sessionRequest",params:{request:Bi(Xe({},s),{expiryTimestamp:hr(u)}),chainId:i},expiry:u,throwOnFailedPublish:!0,appLink:S}).catch(M=>I(M)),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:i,id:d}),await w()):await Promise.all([new Promise(async M=>{await this.sendRequest({clientRpcId:d,relayRpcId:l,topic:a,method:"wc_sessionRequest",params:{request:Bi(Xe({},s),{expiryTimestamp:hr(u)}),chainId:i},expiry:u,throwOnFailedPublish:!0}).catch(G=>I(G)),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:i,id:d}),M()}),new Promise(async M=>{var G;if(!((G=h.sessionConfig)!=null&&G.disableDeepLink)){const V=await F8(this.client.core.storage,Pg);await T8({id:d,topic:a,wcDeepLink:V})}M()}),w()]).then(M=>M[2])},this.respond=async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:i,response:s}=e,{id:a}=s,u=this.client.session.get(i);u.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const h=this.getAppLinkIfEnabled(u.peer.metadata,u.transportType);rn(s)?await this.sendResult({id:a,topic:i,result:s.result,throwOnFailedPublish:!0,appLink:h}):Ii(s)&&await this.sendError({id:a,topic:i,error:s.error,appLink:h}),this.cleanupAfterResponse(e)},this.ping=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:i}=e;if(this.client.session.keys.includes(i)){const s=Zn(),a=Rs().toString(),{done:u,resolve:h,reject:d}=Ns();this.events.once(pe("session_ping",s),({error:l})=>{l?d(l):h()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:a}),u()])}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);const{topic:i,event:s,chainId:a}=e,u=Rs().toString();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:s,chainId:a},throwOnFailedPublish:!0,relayRpcId:u})},this.disconnect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);const{topic:i}=e;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:Re("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:s}=gt("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(s)}},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter(i=>uD(i,e))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(e,i)=>{var s;this.isInitialized(),this.isValidAuthenticate(e);const a=i&&this.client.core.linkModeSupportedApps.includes(i)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),u=a?$e.link_mode:$e.relay;u===$e.relay&&await this.confirmOnlineStateOrThrow();const{chains:h,statement:d="",uri:l,domain:w,nonce:_,type:I,exp:S,nbf:M,methods:G=[],expiry:V}=e,Z=[...e.resources||[]],{topic:H,uri:W}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:u});this.client.logger.info({message:"Generated new pairing",pairing:{topic:H,uri:W}});const U=await this.client.core.crypto.generateKeyPair(),$=cu(U);if(await Promise.all([this.client.auth.authKeys.set(uu,{responseTopic:$,publicKey:U}),this.client.auth.pairingTopics.set($,{topic:$,pairingTopic:H})]),await this.client.core.relayer.subscribe($,{transportType:u}),this.client.logger.info(`sending request to new pairing topic: ${H}`),G.length>0){const{namespace:O}=pa(h[0]);let B=CI(O,"request",G);au(Z)&&(B=NI(B,Z.pop())),Z.push(B)}const k=V&&V>gr.wc_sessionAuthenticate.req.ttl?V:gr.wc_sessionAuthenticate.req.ttl,v={authPayload:{type:I??"caip122",chains:h,statement:d,aud:l,domain:w,version:"1",nonce:_,iat:new Date().toISOString(),exp:S,nbf:M,resources:Z},requester:{publicKey:U,metadata:this.client.metadata},expiryTimestamp:hr(k)},R={eip155:{chains:h,methods:[...new Set(["personal_sign",...G])],events:["chainChanged","accountsChanged"]}},st={requiredNamespaces:{},optionalNamespaces:R,relays:[{protocol:"irn"}],pairingTopic:H,proposer:{publicKey:U,metadata:this.client.metadata},expiryTimestamp:hr(gr.wc_sessionPropose.req.ttl)},{done:dt,resolve:pt,reject:yt}=Ns(k,"Request expired"),f=async({error:O,session:B})=>{if(this.events.off(pe("session_request",b),y),O)yt(O);else if(B){B.self.publicKey=U,await this.client.session.set(B.topic,B),await this.setExpiry(B.topic,B.expiry),H&&await this.client.core.pairing.updateMetadata({topic:H,metadata:B.peer.metadata});const D=this.client.session.get(B.topic);await this.deleteProposal(P),pt({session:D})}},y=async O=>{var B,D,g;if(await this.deletePendingAuthRequest(b,{message:"fulfilled",code:0}),O.error){const q=Re("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return O.error.code===q.code?void 0:(this.events.off(pe("session_connect"),f),yt(O.error.message))}await this.deleteProposal(P),this.events.off(pe("session_connect"),f);const{cacaos:T,responder:rt}=O.result,lt=[],E=[];for(const q of T){await z0({cacao:q,projectId:this.client.core.projectId})||(this.client.logger.error(q,"Signature verification failed"),yt(Re("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:z}=q,p=au(z.resources),F=[k0(z.iss)],et=Eu(z.iss);if(p){const ot=H0(p),at=K0(p);lt.push(...ot),F.push(...at)}for(const ot of F)E.push(`${ot}:${et}`)}const tt=await this.client.core.crypto.generateSharedKey(U,rt.publicKey);let L;lt.length>0&&(L={topic:tt,acknowledged:!0,self:{publicKey:U,metadata:this.client.metadata},peer:rt,controller:rt.publicKey,expiry:hr(po),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:H,namespaces:tg([...new Set(lt)],[...new Set(E)]),transportType:u},await this.client.core.relayer.subscribe(tt,{transportType:u}),await this.client.session.set(tt,L),H&&await this.client.core.pairing.updateMetadata({topic:H,metadata:rt.metadata}),L=this.client.session.get(tt)),(B=this.client.metadata.redirect)!=null&&B.linkMode&&(D=rt.metadata.redirect)!=null&&D.linkMode&&(g=rt.metadata.redirect)!=null&&g.universal&&i&&(this.client.core.addLinkModeSupportedApp(rt.metadata.redirect.universal),this.client.session.update(tt,{transportType:$e.link_mode})),pt({auths:T,session:L})},b=Zn(),P=Zn();this.events.once(pe("session_connect"),f),this.events.once(pe("session_request",b),y);let C;try{if(a){const O=ns("wc_sessionAuthenticate",v,b);this.client.core.history.set(H,O);const B=await this.client.core.crypto.encode("",O,{type:Ba,encoding:ia});C=Jc(i,H,B)}else await Promise.all([this.sendRequest({topic:H,method:"wc_sessionAuthenticate",params:v,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:b}),this.sendRequest({topic:H,method:"wc_sessionPropose",params:st,expiry:gr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:P})])}catch(O){throw this.events.off(pe("session_connect"),f),this.events.off(pe("session_request",b),y),O}return await this.setProposal(P,Xe({id:P},st)),await this.setAuthRequest(b,{request:Bi(Xe({},v),{verifyContext:{}}),pairingTopic:H,transportType:u}),{uri:C??W,response:dt}},this.approveSessionAuthenticate=async e=>{const{id:i,auths:s}=e,a=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[Os.authenticated_session_approve_started]}});try{this.isInitialized()}catch(V){throw a.setError(oa.no_internet_connection),V}const u=this.getPendingAuthRequest(i);if(!u)throw a.setError(oa.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const h=u.transportType||$e.relay;h===$e.relay&&await this.confirmOnlineStateOrThrow();const d=u.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),w=cu(d),_={type:Bn,receiverPublicKey:d,senderPublicKey:l},I=[],S=[];for(const V of s){if(!await z0({cacao:V,projectId:this.client.core.projectId})){a.setError(oa.invalid_cacao);const $=Re("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:w,error:$,encodeOpts:_}),new Error($.message)}a.addTrace(Os.cacaos_verified);const{p:Z}=V,H=au(Z.resources),W=[k0(Z.iss)],U=Eu(Z.iss);if(H){const $=H0(H),k=K0(H);I.push(...$),W.push(...k)}for(const $ of W)S.push(`${$}:${U}`)}const M=await this.client.core.crypto.generateSharedKey(l,d);a.addTrace(Os.create_authenticated_session_topic);let G;if((I==null?void 0:I.length)>0){G={topic:M,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:d,metadata:u.requester.metadata},controller:d,expiry:hr(po),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:u.pairingTopic,namespaces:tg([...new Set(I)],[...new Set(S)]),transportType:h},a.addTrace(Os.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(M,{transportType:h})}catch(V){throw a.setError(oa.subscribe_authenticated_session_topic_failure),V}a.addTrace(Os.subscribe_authenticated_session_topic_success),await this.client.session.set(M,G),a.addTrace(Os.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:u.requester.metadata})}a.addTrace(Os.publishing_authenticated_session_approve);try{await this.sendResult({topic:w,id:i,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:_,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(u.requester.metadata,h)})}catch(V){throw a.setError(oa.authenticated_session_approve_publish_failure),V}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:u.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:a.eventId}),{session:G}},this.rejectSessionAuthenticate=async e=>{this.isInitialized();const{id:i,reason:s}=e,a=this.getPendingAuthRequest(i);if(!a)throw new Error(`Could not find pending auth request with id ${i}`);a.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const u=a.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),d=cu(u),l={type:Bn,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i,topic:d,error:s,encodeOpts:l,rpcOpts:gr.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(a.requester.metadata,a.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,Re("USER_DISCONNECTED"))},this.formatAuthMessage=e=>{this.isInitialized();const{request:i,iss:s}=e;return Dm(i,s)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)},this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{const i=this.client.core.pairing.pairings.get(e.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(a=>{var u,h;return((u=a.peerMetadata)==null?void 0:u.url)&&((h=a.peerMetadata)==null?void 0:h.url)===e.peer.metadata.url&&a.topic&&a.topic!==i.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async e=>{var i;const{topic:s,expirerHasDeleted:a=!1,emitEvent:u=!0,id:h=0}=e,{self:d}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Re("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(d.publicKey)&&await this.client.core.crypto.deleteKeyPair(d.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),a||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Pg).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,Re("USER_DISCONNECTED"))}),s===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=tn.idle),u&&this.client.events.emit("session_delete",{id:h,topic:s})},this.deleteProposal=async(e,i)=>{if(i)try{const s=this.client.proposal.get(e),a=this.client.core.eventClient.getEvent({topic:s.pairingTopic});a==null||a.setError(Cs.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,Re("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")},this.deletePendingSessionRequest=async(e,i,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,i),s?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(a=>a.id!==e),s&&(this.sessionRequestQueue.state=tn.idle,this.client.events.emit("session_request_expire",{id:e}))},this.deletePendingAuthRequest=async(e,i,s=!1)=>{await Promise.all([this.client.auth.requests.delete(e,i),s?Promise.resolve():this.client.core.expirer.del(e)])},this.setExpiry=async(e,i)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,i),await this.client.session.update(e,{expiry:i}))},this.setProposal=async(e,i)=>{this.client.core.expirer.set(e,hr(gr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,i)},this.setAuthRequest=async(e,i)=>{const{request:s,pairingTopic:a,transportType:u=$e.relay}=i;this.client.core.expirer.set(e,s.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:e,pairingTopic:a,verifyContext:s.verifyContext,transportType:u})},this.setPendingSessionRequest=async e=>{const{id:i,topic:s,params:a,verifyContext:u}=e,h=a.request.expiryTimestamp||hr(gr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,h),await this.client.pendingRequest.set(i,{id:i,topic:s,params:a,verifyContext:u})},this.sendRequest=async e=>{const{topic:i,method:s,params:a,expiry:u,relayRpcId:h,clientRpcId:d,throwOnFailedPublish:l,appLink:w}=e,_=ns(s,a,d);let I;const S=!!w;try{const V=S?ia:ss;I=await this.client.core.crypto.encode(i,_,{encoding:V})}catch(V){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),V}let M;if(ZM.includes(s)){const V=Fn(JSON.stringify(_)),Z=Fn(I);M=await this.client.core.verify.register({id:Z,decryptedId:V})}const G=gr[s].req;if(G.attestation=M,u&&(G.ttl=u),h&&(G.id=h),this.client.core.history.set(i,_),S){const V=Jc(w,i,I);await oe.Linking.openURL(V,this.client.name)}else{const V=gr[s].req;u&&(V.ttl=u),h&&(V.id=h),l?(V.internal=Bi(Xe({},V.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,I,V)):this.client.core.relayer.publish(i,I,V).catch(Z=>this.client.logger.error(Z))}return _.id},this.sendResult=async e=>{const{id:i,topic:s,result:a,throwOnFailedPublish:u,encodeOpts:h,appLink:d}=e,l=Fu(i,a);let w;const _=d&&typeof(oe==null?void 0:oe.Linking)<"u";try{const S=_?ia:ss;w=await this.client.core.crypto.encode(s,l,Bi(Xe({},h||{}),{encoding:S}))}catch(S){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),S}let I;try{I=await this.client.core.history.get(s,i)}catch(S){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${i}) failed`),S}if(_){const S=Jc(d,s,w);await oe.Linking.openURL(S,this.client.name)}else{const S=gr[I.request.method].res;u?(S.internal=Bi(Xe({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,w,S)):this.client.core.relayer.publish(s,w,S).catch(M=>this.client.logger.error(M))}await this.client.core.history.resolve(l)},this.sendError=async e=>{const{id:i,topic:s,error:a,encodeOpts:u,rpcOpts:h,appLink:d}=e,l=Uu(i,a);let w;const _=d&&typeof(oe==null?void 0:oe.Linking)<"u";try{const S=_?ia:ss;w=await this.client.core.crypto.encode(s,l,Bi(Xe({},u||{}),{encoding:S}))}catch(S){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),S}let I;try{I=await this.client.core.history.get(s,i)}catch(S){throw this.client.logger.error(`sendError() -> history.get(${s}, ${i}) failed`),S}if(_){const S=Jc(d,s,w);await oe.Linking.openURL(S,this.client.name)}else{const S=h||gr[I.request.method].res;this.client.core.relayer.publish(s,w,S)}await this.client.core.history.resolve(l)},this.cleanup=async()=>{const e=[],i=[];this.client.session.getAll().forEach(s=>{let a=!1;ts(s.expiry)&&(a=!0),this.client.core.crypto.keychain.has(s.topic)||(a=!0),a&&e.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ts(s.expiryTimestamp)&&i.push(s.id)}),await Promise.all([...e.map(s=>this.deleteSession({topic:s})),...i.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===tn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=tn.active;const e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=tn.idle},this.processRequest=async e=>{const{topic:i,payload:s,attestation:a,transportType:u,encryptedId:h}=e,d=s.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:d}))switch(d){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:s,attestation:a,encryptedId:h});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,s);case"wc_sessionPing":return await this.onSessionPingRequest(i,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:s,attestation:a,encryptedId:h,transportType:u});case"wc_sessionEvent":return await this.onSessionEventRequest(i,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:s,attestation:a,encryptedId:h,transportType:u});default:return this.client.logger.info(`Unsupported request method ${d}`)}},this.onRelayEventResponse=async e=>{const{topic:i,payload:s,transportType:a}=e,u=(await this.client.core.history.get(i,s.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(i,s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(i,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,s);case"wc_sessionExtend":return this.onSessionExtendResponse(i,s);case"wc_sessionPing":return this.onSessionPingResponse(i,s);case"wc_sessionRequest":return this.onSessionRequestResponse(i,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,s);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:i}=e,{message:s}=gt("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.shouldIgnorePairingRequest=e=>{const{topic:i,requestMethod:s}=e,a=this.expectedPairingMethodMap.get(i);return!a||a.includes(s)?!1:!!(a.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async e=>{const{topic:i,payload:s,attestation:a,encryptedId:u}=e,{params:h,id:d}=s;try{const l=this.client.core.eventClient.getEvent({topic:i});this.isValidConnect(Xe({},s.params));const w=h.expiryTimestamp||hr(gr.wc_sessionPropose.req.ttl),_=Xe({id:d,pairingTopic:i,expiryTimestamp:w},h);await this.setProposal(d,_);const I=await this.getVerifyContext({attestationId:a,hash:Fn(JSON.stringify(s)),encryptedId:u,metadata:_.proposer.metadata});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(Tn.proposal_listener_not_found)),l==null||l.addTrace(en.emit_session_proposal),this.client.events.emit("session_proposal",{id:d,params:_,verifyContext:I})}catch(l){await this.sendError({id:d,topic:i,error:l,rpcOpts:gr.wc_sessionPropose.autoReject}),this.client.logger.error(l)}},this.onSessionProposeResponse=async(e,i,s)=>{const{id:a}=i;if(rn(i)){const{result:u}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const h=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const d=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const l=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const w=await this.client.core.crypto.generateSharedKey(d,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const _=await this.client.core.relayer.subscribe(w,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:e})}else if(Ii(i)){await this.client.proposal.delete(a,Re("USER_DISCONNECTED"));const u=pe("session_connect");if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners, 954`);this.events.emit(pe("session_connect"),{error:i.error})}},this.onSessionSettleRequest=async(e,i)=>{const{id:s,params:a}=i;try{this.isValidSessionSettleRequest(a);const{relay:u,controller:h,expiry:d,namespaces:l,sessionProperties:w,sessionConfig:_}=i.params,I=Bi(Xe(Xe({topic:e,relay:u,expiry:d,namespaces:l,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:h.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:h.publicKey,metadata:h.metadata}},w&&{sessionProperties:w}),_&&{sessionConfig:_}),{transportType:$e.relay}),S=pe("session_connect");if(this.events.listenerCount(S)===0)throw new Error(`emitting ${S} without any listeners 997`);this.events.emit(pe("session_connect"),{session:I}),await this.sendResult({id:i.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(u){await this.sendError({id:s,topic:e,error:u}),this.client.logger.error(u)}},this.onSessionSettleResponse=async(e,i)=>{const{id:s}=i;rn(i)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(pe("session_approve",s),{})):Ii(i)&&(await this.client.session.delete(e,Re("USER_DISCONNECTED")),this.events.emit(pe("session_approve",s),{error:i.error}))},this.onSessionUpdateRequest=async(e,i)=>{const{params:s,id:a}=i;try{const u=`${e}_session_update`,h=na.get(u);if(h&&this.isRequestOutOfSync(h,a)){this.client.logger.info(`Discarding out of sync request - ${a}`),this.sendError({id:a,topic:e,error:Re("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Xe({topic:e},s));try{na.set(u,a),await this.client.session.update(e,{namespaces:s.namespaces}),await this.sendResult({id:a,topic:e,result:!0,throwOnFailedPublish:!0})}catch(d){throw na.delete(u),d}this.client.events.emit("session_update",{id:a,topic:e,params:s})}catch(u){await this.sendError({id:a,topic:e,error:u}),this.client.logger.error(u)}},this.isRequestOutOfSync=(e,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(e.toString().slice(0,-3)),this.onSessionUpdateResponse=(e,i)=>{const{id:s}=i,a=pe("session_update",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);rn(i)?this.events.emit(pe("session_update",s),{}):Ii(i)&&this.events.emit(pe("session_update",s),{error:i.error})},this.onSessionExtendRequest=async(e,i)=>{const{id:s}=i;try{this.isValidExtend({topic:e}),await this.setExpiry(e,hr(po)),await this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:e})}catch(a){await this.sendError({id:s,topic:e,error:a}),this.client.logger.error(a)}},this.onSessionExtendResponse=(e,i)=>{const{id:s}=i,a=pe("session_extend",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);rn(i)?this.events.emit(pe("session_extend",s),{}):Ii(i)&&this.events.emit(pe("session_extend",s),{error:i.error})},this.onSessionPingRequest=async(e,i)=>{const{id:s}=i;try{this.isValidPing({topic:e}),await this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:e})}catch(a){await this.sendError({id:s,topic:e,error:a}),this.client.logger.error(a)}},this.onSessionPingResponse=(e,i)=>{const{id:s}=i,a=pe("session_ping",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);setTimeout(()=>{rn(i)?this.events.emit(pe("session_ping",s),{}):Ii(i)&&this.events.emit(pe("session_ping",s),{error:i.error})},500)},this.onSessionDeleteRequest=async(e,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:e,reason:i.params}),Promise.all([new Promise(a=>{this.client.core.relayer.once(Fr.publish,async()=>{a(await this.deleteSession({topic:e,id:s}))})}),this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:Re("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}},this.onSessionRequest=async e=>{var i,s,a;const{topic:u,payload:h,attestation:d,encryptedId:l,transportType:w}=e,{id:_,params:I}=h;try{await this.isValidRequest(Xe({topic:u},I));const S=this.client.session.get(u),M=await this.getVerifyContext({attestationId:d,hash:Fn(JSON.stringify(ns("wc_sessionRequest",I,_))),encryptedId:l,metadata:S.peer.metadata,transportType:w}),G={id:_,topic:u,params:I,verifyContext:M};await this.setPendingSessionRequest(G),w===$e.link_mode&&(i=S.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((s=S.peer.metadata.redirect)==null?void 0:s.universal),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(G):(this.addSessionRequestToSessionRequestQueue(G),this.processSessionRequestQueue())}catch(S){await this.sendError({id:_,topic:u,error:S}),this.client.logger.error(S)}},this.onSessionRequestResponse=(e,i)=>{const{id:s}=i,a=pe("session_request",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);rn(i)?this.events.emit(pe("session_request",s),{result:i.result}):Ii(i)&&this.events.emit(pe("session_request",s),{error:i.error})},this.onSessionEventRequest=async(e,i)=>{const{id:s,params:a}=i;try{const u=`${e}_session_event_${a.event.name}`,h=na.get(u);if(h&&this.isRequestOutOfSync(h,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Xe({topic:e},a)),this.client.events.emit("session_event",{id:s,topic:e,params:a}),na.set(u,s)}catch(u){await this.sendError({id:s,topic:e,error:u}),this.client.logger.error(u)}},this.onSessionAuthenticateResponse=(e,i)=>{const{id:s}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:i}),rn(i)?this.events.emit(pe("session_request",s),{result:i.result}):Ii(i)&&this.events.emit(pe("session_request",s),{error:i.error})},this.onSessionAuthenticateRequest=async e=>{var i;const{topic:s,payload:a,attestation:u,encryptedId:h,transportType:d}=e;try{const{requester:l,authPayload:w,expiryTimestamp:_}=a.params,I=await this.getVerifyContext({attestationId:u,hash:Fn(JSON.stringify(a)),encryptedId:h,metadata:l.metadata,transportType:d}),S={requester:l,pairingTopic:s,id:a.id,authPayload:w,verifyContext:I,expiryTimestamp:_};await this.setAuthRequest(a.id,{request:S,pairingTopic:s,transportType:d}),d===$e.link_mode&&(i=l.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:a.params,id:a.id,verifyContext:I})}catch(l){this.client.logger.error(l);const w=a.params.requester.publicKey,_=await this.client.core.crypto.generateKeyPair(),I=this.getAppLinkIfEnabled(a.params.requester.metadata,d),S={type:Bn,receiverPublicKey:w,senderPublicKey:_};await this.sendError({id:a.id,topic:s,error:l,encodeOpts:S,rpcOpts:gr.wc_sessionAuthenticate.autoReject,appLink:I})}},this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=tn.idle,this.processSessionRequestQueue()},mt.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:e,error:i})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(a=>a.topic===e&&a.request.method==="wc_sessionRequest").forEach(a=>{const u=a.request.id,h=pe("session_request",u);if(this.events.listenerCount(h)===0)throw new Error(`emitting ${h} without any listeners`);this.events.emit(pe("session_request",a.request.id),{error:i})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===tn.active){this.client.logger.info("session request queue is already active.");return}const e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=tn.active,this.emitSessionRequest(e)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=e=>{this.client.events.emit("session_request",e)},this.onPairingCreated=e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const i=this.client.proposal.getAll().find(s=>s.pairingTopic===e.topic);i&&this.onSessionProposeRequest({topic:e.topic,payload:ns("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})},this.isValidConnect=async e=>{if(!Vr(e)){const{message:d}=gt("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(d)}const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:u,relays:h}=e;if(Wr(i)||await this.isValidPairingTopic(i),!_D(h)){const{message:d}=gt("MISSING_OR_INVALID",`connect() relays: ${h}`);throw new Error(d)}!Wr(s)&&xa(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!Wr(a)&&xa(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),Wr(u)||this.validateSessionProps(u,"sessionProperties")},this.validateNamespaces=(e,i)=>{const s=bD(e,"connect()",i);if(s)throw new Error(s.message)},this.isValidApprove=async e=>{if(!Vr(e))throw new Error(gt("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:i,namespaces:s,relayProtocol:a,sessionProperties:u}=e;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const h=this.client.proposal.get(i),d=wl(s,"approve()");if(d)throw new Error(d.message);const l=ig(h.requiredNamespaces,s,"approve()");if(l)throw new Error(l.message);if(!nr(a,!0)){const{message:w}=gt("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(w)}Wr(u)||this.validateSessionProps(u,"sessionProperties")},this.isValidReject=async e=>{if(!Vr(e)){const{message:a}=gt("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(a)}const{id:i,reason:s}=e;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!AD(s)){const{message:a}=gt("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidSessionSettleRequest=e=>{if(!Vr(e)){const{message:l}=gt("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(l)}const{relay:i,controller:s,namespaces:a,expiry:u}=e;if(!Rm(i)){const{message:l}=gt("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const h=pD(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);const d=wl(a,"onSessionSettleRequest()");if(d)throw new Error(d.message);if(ts(u)){const{message:l}=gt("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async e=>{if(!Vr(e)){const{message:d}=gt("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(d)}const{topic:i,namespaces:s}=e;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const a=this.client.session.get(i),u=wl(s,"update()");if(u)throw new Error(u.message);const h=ig(a.requiredNamespaces,s,"update()");if(h)throw new Error(h.message)},this.isValidExtend=async e=>{if(!Vr(e)){const{message:s}=gt("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(s)}const{topic:i}=e;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)},this.isValidRequest=async e=>{if(!Vr(e)){const{message:d}=gt("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(d)}const{topic:i,request:s,chainId:a,expiry:u}=e;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:h}=this.client.session.get(i);if(!rg(h,a)){const{message:d}=gt("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(d)}if(!SD(s)){const{message:d}=gt("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(d)}if(!xD(h,a,s.method)){const{message:d}=gt("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(d)}if(u&&!OD(u,Sl)){const{message:d}=gt("MISSING_OR_INVALID",`request() expiry: ${u}. Expiry must be a number (in seconds) between ${Sl.min} and ${Sl.max}`);throw new Error(d)}},this.isValidRespond=async e=>{var i;if(!Vr(e)){const{message:u}=gt("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(u)}const{topic:s,response:a}=e;try{await this.isValidSessionTopic(s)}catch(u){throw(i=e==null?void 0:e.response)!=null&&i.id&&this.cleanupAfterResponse(e),u}if(!ID(a)){const{message:u}=gt("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async e=>{if(!Vr(e)){const{message:s}=gt("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(s)}const{topic:i}=e;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async e=>{if(!Vr(e)){const{message:h}=gt("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(h)}const{topic:i,event:s,chainId:a}=e;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!rg(u,a)){const{message:h}=gt("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(h)}if(!DD(s)){const{message:h}=gt("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(h)}if(!MD(u,a,s.name)){const{message:h}=gt("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(h)}},this.isValidDisconnect=async e=>{if(!Vr(e)){const{message:s}=gt("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(s)}const{topic:i}=e;await this.isValidSessionOrPairingTopic(i)},this.isValidAuthenticate=e=>{const{chains:i,uri:s,domain:a,nonce:u}=e;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!nr(s,!1))throw new Error("uri is required parameter");if(!nr(a,!1))throw new Error("domain is required parameter");if(!nr(u,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(d=>pa(d).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:h}=pa(i[0]);if(h!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async e=>{const{attestationId:i,hash:s,encryptedId:a,metadata:u,transportType:h}=e,d={verified:{verifyUrl:u.verifyUrl||ya,validation:"UNKNOWN",origin:u.url||""}};try{if(h===$e.link_mode){const w=this.getAppLinkIfEnabled(u,h);return d.verified.validation=w&&new URL(w).origin===new URL(u.url).origin?"VALID":"INVALID",d}const l=await this.client.core.verify.resolve({attestationId:i,hash:s,encryptedId:a,verifyUrl:u.verifyUrl});l&&(d.verified.origin=l.origin,d.verified.isScam=l.isScam,d.verified.validation=l.origin===new URL(u.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(d)}`),d},this.validateSessionProps=(e,i)=>{Object.values(e).forEach(s=>{if(!nr(s,!1)){const{message:a}=gt("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(a)}})},this.getPendingAuthRequest=e=>{const i=this.client.auth.requests.get(e);return typeof i=="object"?i:void 0},this.addToRecentlyDeleted=(e,i)=>{if(this.recentlyDeletedMap.set(e,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const a=this.recentlyDeletedLimit/2;for(const u of this.recentlyDeletedMap.keys()){if(s++>=a)break;this.recentlyDeletedMap.delete(u)}}},this.checkRecentlyDeleted=e=>{const i=this.recentlyDeletedMap.get(e);if(i){const{message:s}=gt("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${e}`);throw new Error(s)}},this.isLinkModeEnabled=(e,i)=>{var s,a,u,h,d,l,w,_,I;return!e||i!==$e.link_mode?!1:((a=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:a.linkMode)===!0&&((h=(u=this.client.metadata)==null?void 0:u.redirect)==null?void 0:h.universal)!==void 0&&((l=(d=this.client.metadata)==null?void 0:d.redirect)==null?void 0:l.universal)!==""&&((w=e==null?void 0:e.redirect)==null?void 0:w.universal)!==void 0&&((_=e==null?void 0:e.redirect)==null?void 0:_.universal)!==""&&((I=e==null?void 0:e.redirect)==null?void 0:I.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(oe==null?void 0:oe.Linking)<"u"},this.getAppLinkIfEnabled=(e,i)=>{var s;return this.isLinkModeEnabled(e,i)?(s=e==null?void 0:e.redirect)==null?void 0:s.universal:void 0},this.handleLinkModeMessage=({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;const i=m0(e,"topic")||"",s=decodeURIComponent(m0(e,"wc_ev")||""),a=this.client.session.keys.includes(i);a&&this.client.session.update(i,{transportType:$e.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:s,sessionExists:a})},this.registerLinkModeListeners=async()=>{var e;if(mf()||Io()&&(e=this.client.metadata.redirect)!=null&&e.linkMode){const i=oe==null?void 0:oe.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await i.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}}isInitialized(){if(!this.initialized){const{message:t}=gt("NOT_INITIALIZED",this.name);throw new Error(t)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Fr.message,t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):this.onRelayMessage(t)})}async onRelayMessage(t){const{topic:e,message:i,attestation:s,transportType:a}=t,{publicKey:u}=this.client.auth.authKeys.keys.includes(uu)?this.client.auth.authKeys.get(uu):{responseTopic:void 0,publicKey:void 0},h=await this.client.core.crypto.decode(e,i,{receiverPublicKey:u,encoding:a===$e.link_mode?ia:ss});try{gf(h)?(this.client.core.history.set(e,h),this.onRelayEventRequest({topic:e,payload:h,attestation:s,transportType:a,encryptedId:Fn(i)})):Lu(h)?(await this.client.core.history.resolve(h),await this.onRelayEventResponse({topic:e,payload:h,transportType:a}),this.client.core.history.delete(e,h.id)):this.onRelayEventUnknownPayload({topic:e,payload:h,transportType:a})}catch(d){this.client.logger.error(d)}}registerExpirerEvents(){this.client.core.expirer.on(Ai.expired,async t=>{const{topic:e,id:i}=z1(t.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,gt("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,gt("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(await this.deleteSession({topic:e,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:e})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ts.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(Ts.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!nr(t,!1)){const{message:e}=gt("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=gt("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(ts(this.client.core.pairing.pairings.get(t).expiry)){const{message:e}=gt("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}async isValidSessionTopic(t){if(!nr(t,!1)){const{message:e}=gt("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:e}=gt("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(ts(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:e}=gt("EXPIRED",`session topic: ${t}`);throw new Error(e)}if(!this.client.core.crypto.keychain.has(t)){const{message:e}=gt("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(e)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(nr(t,!1)){const{message:e}=gt("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}else{const{message:e}=gt("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}}async isValidProposalId(t){if(!ED(t)){const{message:e}=gt("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){const{message:e}=gt("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(ts(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:e}=gt("EXPIRED",`proposal id: ${t}`);throw new Error(e)}}}class lP extends Hs{constructor(t,e){super(t,e,YM,Pf),this.core=t,this.logger=e}}class fP extends Hs{constructor(t,e){super(t,e,JM,Pf),this.core=t,this.logger=e}}class dP extends Hs{constructor(t,e){super(t,e,XM,Pf,i=>i.id),this.core=t,this.logger=e}}class pP extends Hs{constructor(t,e){super(t,e,rP,ju,()=>uu),this.core=t,this.logger=e}}class gP extends Hs{constructor(t,e){super(t,e,iP,ju),this.core=t,this.logger=e}}class mP extends Hs{constructor(t,e){super(t,e,nP,ju,i=>i.id),this.core=t,this.logger=e}}class vP{constructor(t,e){this.core=t,this.logger=e,this.authKeys=new pP(this.core,this.logger),this.pairingTopics=new gP(this.core,this.logger),this.requests=new mP(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class Cf extends JD{constructor(t){super(t),this.protocol=Qm,this.version=Xm,this.name=Al.name,this.events=new Mi.EventEmitter,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(s){throw this.logger.error(s.message),s}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(s){throw this.logger.error(s.message),s}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(s){throw this.logger.error(s.message),s}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(s){throw this.logger.error(s.message),s}},this.update=async i=>{try{return await this.engine.update(i)}catch(s){throw this.logger.error(s.message),s}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(s){throw this.logger.error(s.message),s}},this.request=async i=>{try{return await this.engine.request(i)}catch(s){throw this.logger.error(s.message),s}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(s){throw this.logger.error(s.message),s}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(s){throw this.logger.error(s.message),s}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(s){throw this.logger.error(s.message),s}},this.find=i=>{try{return this.engine.find(i)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async(i,s)=>{try{return await this.engine.authenticate(i,s)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(s){throw this.logger.error(s.message),s}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(s){throw this.logger.error(s.message),s}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Al.name,this.metadata=(t==null?void 0:t.metadata)||B1(),this.signConfig=t==null?void 0:t.signConfig;const e=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Pa(xu({level:(t==null?void 0:t.logger)||Al.logger}));this.core=(t==null?void 0:t.core)||new WM(t),this.logger=Br(e,this.name),this.session=new fP(this.core,this.logger),this.proposal=new lP(this.core,this.logger),this.pendingRequest=new dP(this.core,this.logger),this.engine=new hP(this),this.auth=new vP(this.core,this.logger)}static async init(t){const e=new Cf(t);return await e.initialize(),e}get context(){return Jr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}var yP=Object.defineProperty,wP=Object.defineProperties,bP=Object.getOwnPropertyDescriptors,Ng=Object.getOwnPropertySymbols,_P=Object.prototype.hasOwnProperty,EP=Object.prototype.propertyIsEnumerable,Tg=(r,t,e)=>t in r?yP(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Rg=(r,t)=>{for(var e in t||(t={}))_P.call(t,e)&&Tg(r,e,t[e]);if(Ng)for(var e of Ng(t))EP.call(t,e)&&Tg(r,e,t[e]);return r},Fg=(r,t)=>wP(r,bP(t));const AP={Accept:"application/json","Content-Type":"application/json"},SP="POST",Ug={headers:AP,method:SP},Lg=10;class wn{constructor(t,e=!1){if(this.url=t,this.disableProviderPing=e,this.events=new Mi.EventEmitter,this.isAvailable=!1,this.registering=!1,!h0(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const e=qn(t),i=await(await Np(this.url,Fg(Rg({},Ug),{body:e}))).json();this.onPayload({data:i})}catch(e){this.onError(t.id,e)}}async register(t=this.url){if(!h0(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));i()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const e=qn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Np(t,Fg(Rg({},Ug),{body:e}))}this.onOpen()}catch(e){const i=this.parseError(e);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?Ls(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const i=this.parseError(e),s=i.message||i.toString(),a=Uu(t,s);this.events.emit("payload",a)}parseError(t,e=this.url){return N1(t,e,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Lg&&this.events.setMaxListeners(Lg)}}const Bg="error",IP="wss://relay.walletconnect.org",DP="wc",xP="universal_provider",qg=`${DP}@2:${xP}:`,ev="https://rpc.walletconnect.org/v1/",vo="generic",MP=`${ev}bundler`,Hi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ua=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof oe<"u"?oe:typeof self<"u"?self:{},rf={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(r,t){(function(){var e,i="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",l=500,w="__lodash_placeholder__",_=1,I=2,S=4,M=1,G=2,V=1,Z=2,H=4,W=8,U=16,$=32,k=64,v=128,R=256,st=512,dt=30,pt="...",yt=800,f=16,y=1,b=2,P=3,C=1/0,O=9007199254740991,B=17976931348623157e292,D=NaN,g=4294967295,T=g-1,rt=g>>>1,lt=[["ary",v],["bind",V],["bindKey",Z],["curry",W],["curryRight",U],["flip",st],["partial",$],["partialRight",k],["rearg",R]],E="[object Arguments]",tt="[object Array]",L="[object AsyncFunction]",q="[object Boolean]",z="[object Date]",p="[object DOMException]",F="[object Error]",et="[object Function]",ot="[object GeneratorFunction]",at="[object Map]",Mt="[object Number]",Ct="[object Null]",It="[object Object]",Ae="[object Promise]",$t="[object Proxy]",xt="[object RegExp]",Lt="[object Set]",_t="[object String]",Et="[object Symbol]",Vt="[object Undefined]",wt="[object WeakMap]",At="[object WeakSet]",Ut="[object ArrayBuffer]",bt="[object DataView]",Pt="[object Float32Array]",Bt="[object Float64Array]",Ot="[object Int8Array]",Nt="[object Int16Array]",se="[object Int32Array]",Rt="[object Uint8Array]",Tt="[object Uint8ClampedArray]",We="[object Uint16Array]",ue="[object Uint32Array]",ge=/\b__p \+= '';/g,Ye=/\b(__p \+=) '' \+/g,we=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ee=/&(?:amp|lt|gt|quot|#39);/g,Mr=/[&<>"']/g,Gt=RegExp(Ee.source),kt=RegExp(Mr.source),De=/<%-([\s\S]+?)%>/g,Wt=/<%([\s\S]+?)%>/g,Kt=/<%=([\s\S]+?)%>/g,Se=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qt=/^\w*$/,Xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xe=/[\\^$.*+?()[\]{}|]/g,Zt=RegExp(xe.source),Yt=/^\s+/,Ce=/\s/,Jt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qt=/\{\n\/\* \[wrapped with (.+)\] \*/,Fe=/,? & /,te=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oe=/[()=,{}\[\]\/\s]/,Pi=/\\(\\)?/g,Ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,ai=/^[-+]0x[0-9a-f]+$/i,ci=/^0b[01]+$/i,ui=/^\[object .+?Constructor\]$/,hi=/^0o[0-7]+$/i,li=/^(?:0|[1-9]\d*)$/,lr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ki=/($^)/,cs=/['\n\r\u2028\u2029\\]/g,Vi="\\ud800-\\udfff",us="\\u0300-\\u036f",hs="\\ufe20-\\ufe2f",Gi="\\u20d0-\\u20ff",jn=us+hs+Gi,$n="\\u2700-\\u27bf",Pr="a-z\\xdf-\\xf6\\xf8-\\xff",ls="\\xac\\xb1\\xd7\\xf7",fs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ds="\\u2000-\\u206f",ps=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ja="A-Z\\xc0-\\xd6\\xd8-\\xde",$a="\\ufe0e\\ufe0f",gs=ls+fs+ds+ps,To="[']",ms="["+Vi+"]",Ro="["+gs+"]",vs="["+jn+"]",ka="\\d+",$u="["+$n+"]",za="["+Pr+"]",Ha="[^"+Vi+gs+ka+$n+Pr+ja+"]",Gs="\\ud83c[\\udffb-\\udfff]",ku="(?:"+vs+"|"+Gs+")",Ka="[^"+Vi+"]",Ws="(?:\\ud83c[\\udde6-\\uddff]){2}",kn="[\\ud800-\\udbff][\\udc00-\\udfff]",Qr="["+ja+"]",Va="\\u200d",Ga="(?:"+za+"|"+Ha+")",Wi="(?:"+Qr+"|"+Ha+")",Wa="(?:"+To+"(?:d|ll|m|re|s|t|ve))?",Ya="(?:"+To+"(?:D|LL|M|RE|S|T|VE))?",Ja=ku+"?",Qa="["+$a+"]?",zu="(?:"+Va+"(?:"+[Ka,Ws,kn].join("|")+")"+Qa+Ja+")*",bn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Za=Qa+Ja+zu,Ys="(?:"+[$u,Ws,kn].join("|")+")"+Za,Hu="(?:"+[Ka+vs+"?",vs,Ws,kn,ms].join("|")+")",Fo=RegExp(To,"g"),Ku=RegExp(vs,"g"),Js=RegExp(Gs+"(?="+Gs+")|"+Hu+Za,"g"),tc=RegExp([Qr+"?"+za+"+"+Wa+"(?="+[Ro,Qr,"$"].join("|")+")",Wi+"+"+Ya+"(?="+[Ro,Qr+Ga,"$"].join("|")+")",Qr+"?"+Ga+"+"+Wa,Qr+"+"+Ya,Xa,bn,ka,Ys].join("|"),"g"),ec=RegExp("["+Va+Vi+jn+$a+"]"),ys=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Vu=-1,Le={};Le[Pt]=Le[Bt]=Le[Ot]=Le[Nt]=Le[se]=Le[Rt]=Le[Tt]=Le[We]=Le[ue]=!0,Le[E]=Le[tt]=Le[Ut]=Le[q]=Le[bt]=Le[z]=Le[F]=Le[et]=Le[at]=Le[Mt]=Le[It]=Le[xt]=Le[Lt]=Le[_t]=Le[wt]=!1;var Ue={};Ue[E]=Ue[tt]=Ue[Ut]=Ue[bt]=Ue[q]=Ue[z]=Ue[Pt]=Ue[Bt]=Ue[Ot]=Ue[Nt]=Ue[se]=Ue[at]=Ue[Mt]=Ue[It]=Ue[xt]=Ue[Lt]=Ue[_t]=Ue[Et]=Ue[Rt]=Ue[Tt]=Ue[We]=Ue[ue]=!0,Ue[F]=Ue[et]=Ue[wt]=!1;var j={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},J={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ht={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},St={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Be=parseFloat,re=parseInt,He=typeof ua=="object"&&ua&&ua.Object===Object&&ua,sr=typeof self=="object"&&self&&self.Object===Object&&self,be=He||sr||Function("return this")(),qe=t&&!t.nodeType&&t,tr=qe&&!0&&r&&!r.nodeType&&r,qr=tr&&tr.exports===qe,or=qr&&He.process,Ke=function(){try{var Q=tr&&tr.require&&tr.require("util").types;return Q||or&&or.binding&&or.binding("util")}catch{}}(),Cr=Ke&&Ke.isArrayBuffer,Ci=Ke&&Ke.isDate,fi=Ke&&Ke.isMap,Yi=Ke&&Ke.isRegExp,Uo=Ke&&Ke.isSet,ws=Ke&&Ke.isTypedArray;function fr(Q,nt,it){switch(it.length){case 0:return Q.call(nt);case 1:return Q.call(nt,it[0]);case 2:return Q.call(nt,it[0],it[1]);case 3:return Q.call(nt,it[0],it[1],it[2])}return Q.apply(nt,it)}function nv(Q,nt,it,Dt){for(var ee=-1,Ie=Q==null?0:Q.length;++ee<Ie;){var ar=Q[ee];nt(Dt,ar,it(ar),Q)}return Dt}function di(Q,nt){for(var it=-1,Dt=Q==null?0:Q.length;++it<Dt&&nt(Q[it],it,Q)!==!1;);return Q}function sv(Q,nt){for(var it=Q==null?0:Q.length;it--&&nt(Q[it],it,Q)!==!1;);return Q}function Tf(Q,nt){for(var it=-1,Dt=Q==null?0:Q.length;++it<Dt;)if(!nt(Q[it],it,Q))return!1;return!0}function zn(Q,nt){for(var it=-1,Dt=Q==null?0:Q.length,ee=0,Ie=[];++it<Dt;){var ar=Q[it];nt(ar,it,Q)&&(Ie[ee++]=ar)}return Ie}function ic(Q,nt){var it=Q==null?0:Q.length;return!!it&&Qs(Q,nt,0)>-1}function Gu(Q,nt,it){for(var Dt=-1,ee=Q==null?0:Q.length;++Dt<ee;)if(it(nt,Q[Dt]))return!0;return!1}function Ge(Q,nt){for(var it=-1,Dt=Q==null?0:Q.length,ee=Array(Dt);++it<Dt;)ee[it]=nt(Q[it],it,Q);return ee}function Hn(Q,nt){for(var it=-1,Dt=nt.length,ee=Q.length;++it<Dt;)Q[ee+it]=nt[it];return Q}function Wu(Q,nt,it,Dt){var ee=-1,Ie=Q==null?0:Q.length;for(Dt&&Ie&&(it=Q[++ee]);++ee<Ie;)it=nt(it,Q[ee],ee,Q);return it}function ov(Q,nt,it,Dt){var ee=Q==null?0:Q.length;for(Dt&&ee&&(it=Q[--ee]);ee--;)it=nt(it,Q[ee],ee,Q);return it}function Yu(Q,nt){for(var it=-1,Dt=Q==null?0:Q.length;++it<Dt;)if(nt(Q[it],it,Q))return!0;return!1}var av=Ju("length");function cv(Q){return Q.split("")}function uv(Q){return Q.match(te)||[]}function Rf(Q,nt,it){var Dt;return it(Q,function(ee,Ie,ar){if(nt(ee,Ie,ar))return Dt=Ie,!1}),Dt}function nc(Q,nt,it,Dt){for(var ee=Q.length,Ie=it+(Dt?1:-1);Dt?Ie--:++Ie<ee;)if(nt(Q[Ie],Ie,Q))return Ie;return-1}function Qs(Q,nt,it){return nt===nt?_v(Q,nt,it):nc(Q,Ff,it)}function hv(Q,nt,it,Dt){for(var ee=it-1,Ie=Q.length;++ee<Ie;)if(Dt(Q[ee],nt))return ee;return-1}function Ff(Q){return Q!==Q}function Uf(Q,nt){var it=Q==null?0:Q.length;return it?Xu(Q,nt)/it:D}function Ju(Q){return function(nt){return nt==null?e:nt[Q]}}function Qu(Q){return function(nt){return Q==null?e:Q[nt]}}function Lf(Q,nt,it,Dt,ee){return ee(Q,function(Ie,ar,je){it=Dt?(Dt=!1,Ie):nt(it,Ie,ar,je)}),it}function lv(Q,nt){var it=Q.length;for(Q.sort(nt);it--;)Q[it]=Q[it].value;return Q}function Xu(Q,nt){for(var it,Dt=-1,ee=Q.length;++Dt<ee;){var Ie=nt(Q[Dt]);Ie!==e&&(it=it===e?Ie:it+Ie)}return it}function Zu(Q,nt){for(var it=-1,Dt=Array(Q);++it<Q;)Dt[it]=nt(it);return Dt}function fv(Q,nt){return Ge(nt,function(it){return[it,Q[it]]})}function Bf(Q){return Q&&Q.slice(0,kf(Q)+1).replace(Yt,"")}function Xr(Q){return function(nt){return Q(nt)}}function th(Q,nt){return Ge(nt,function(it){return Q[it]})}function Lo(Q,nt){return Q.has(nt)}function qf(Q,nt){for(var it=-1,Dt=Q.length;++it<Dt&&Qs(nt,Q[it],0)>-1;);return it}function jf(Q,nt){for(var it=Q.length;it--&&Qs(nt,Q[it],0)>-1;);return it}function dv(Q,nt){for(var it=Q.length,Dt=0;it--;)Q[it]===nt&&++Dt;return Dt}var pv=Qu(j),gv=Qu(J);function mv(Q){return"\\"+St[Q]}function vv(Q,nt){return Q==null?e:Q[nt]}function Xs(Q){return ec.test(Q)}function yv(Q){return ys.test(Q)}function wv(Q){for(var nt,it=[];!(nt=Q.next()).done;)it.push(nt.value);return it}function eh(Q){var nt=-1,it=Array(Q.size);return Q.forEach(function(Dt,ee){it[++nt]=[ee,Dt]}),it}function $f(Q,nt){return function(it){return Q(nt(it))}}function Kn(Q,nt){for(var it=-1,Dt=Q.length,ee=0,Ie=[];++it<Dt;){var ar=Q[it];(ar===nt||ar===w)&&(Q[it]=w,Ie[ee++]=it)}return Ie}function sc(Q){var nt=-1,it=Array(Q.size);return Q.forEach(function(Dt){it[++nt]=Dt}),it}function bv(Q){var nt=-1,it=Array(Q.size);return Q.forEach(function(Dt){it[++nt]=[Dt,Dt]}),it}function _v(Q,nt,it){for(var Dt=it-1,ee=Q.length;++Dt<ee;)if(Q[Dt]===nt)return Dt;return-1}function Ev(Q,nt,it){for(var Dt=it+1;Dt--;)if(Q[Dt]===nt)return Dt;return Dt}function Zs(Q){return Xs(Q)?Sv(Q):av(Q)}function Oi(Q){return Xs(Q)?Iv(Q):cv(Q)}function kf(Q){for(var nt=Q.length;nt--&&Ce.test(Q.charAt(nt)););return nt}var Av=Qu(ht);function Sv(Q){for(var nt=Js.lastIndex=0;Js.test(Q);)++nt;return nt}function Iv(Q){return Q.match(Js)||[]}function Dv(Q){return Q.match(tc)||[]}var xv=function Q(nt){nt=nt==null?be:to.defaults(be.Object(),nt,to.pick(be,rc));var it=nt.Array,Dt=nt.Date,ee=nt.Error,Ie=nt.Function,ar=nt.Math,je=nt.Object,rh=nt.RegExp,Mv=nt.String,pi=nt.TypeError,oc=it.prototype,Pv=Ie.prototype,eo=je.prototype,ac=nt["__core-js_shared__"],cc=Pv.toString,Te=eo.hasOwnProperty,Cv=0,zf=function(){var n=/[^.]+$/.exec(ac&&ac.keys&&ac.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),uc=eo.toString,Ov=cc.call(je),Nv=be._,Tv=rh("^"+cc.call(Te).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hc=qr?nt.Buffer:e,Vn=nt.Symbol,lc=nt.Uint8Array,Hf=hc?hc.allocUnsafe:e,fc=$f(je.getPrototypeOf,je),Kf=je.create,Vf=eo.propertyIsEnumerable,dc=oc.splice,Gf=Vn?Vn.isConcatSpreadable:e,Bo=Vn?Vn.iterator:e,bs=Vn?Vn.toStringTag:e,pc=function(){try{var n=Is(je,"defineProperty");return n({},"",{}),n}catch{}}(),Rv=nt.clearTimeout!==be.clearTimeout&&nt.clearTimeout,Fv=Dt&&Dt.now!==be.Date.now&&Dt.now,Uv=nt.setTimeout!==be.setTimeout&&nt.setTimeout,gc=ar.ceil,mc=ar.floor,ih=je.getOwnPropertySymbols,Lv=hc?hc.isBuffer:e,Wf=nt.isFinite,Bv=oc.join,qv=$f(je.keys,je),cr=ar.max,Sr=ar.min,jv=Dt.now,$v=nt.parseInt,Yf=ar.random,kv=oc.reverse,nh=Is(nt,"DataView"),qo=Is(nt,"Map"),sh=Is(nt,"Promise"),ro=Is(nt,"Set"),jo=Is(nt,"WeakMap"),$o=Is(je,"create"),vc=jo&&new jo,io={},zv=Ds(nh),Hv=Ds(qo),Kv=Ds(sh),Vv=Ds(ro),Gv=Ds(jo),yc=Vn?Vn.prototype:e,ko=yc?yc.valueOf:e,Jf=yc?yc.toString:e;function x(n){if(Qe(n)&&!ie(n)&&!(n instanceof me)){if(n instanceof gi)return n;if(Te.call(n,"__wrapped__"))return Qd(n)}return new gi(n)}var no=function(){function n(){}return function(o){if(!Je(o))return{};if(Kf)return Kf(o);n.prototype=o;var c=new n;return n.prototype=e,c}}();function wc(){}function gi(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}x.templateSettings={escape:De,evaluate:Wt,interpolate:Kt,variable:"",imports:{_:x}},x.prototype=wc.prototype,x.prototype.constructor=x,gi.prototype=no(wc.prototype),gi.prototype.constructor=gi;function me(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function Wv(){var n=new me(this.__wrapped__);return n.__actions__=jr(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=jr(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=jr(this.__views__),n}function Yv(){if(this.__filtered__){var n=new me(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function Jv(){var n=this.__wrapped__.value(),o=this.__dir__,c=ie(n),m=o<0,A=c?n.length:0,N=cw(0,A,this.__views__),K=N.start,Y=N.end,X=Y-K,ct=m?Y:K-1,ut=this.__iteratees__,ft=ut.length,vt=0,Ft=Sr(X,this.__takeCount__);if(!c||!m&&A==X&&Ft==X)return bd(n,this.__actions__);var zt=[];t:for(;X--&&vt<Ft;){ct+=o;for(var he=-1,Ht=n[ct];++he<ft;){var de=ut[he],_e=de.iteratee,ei=de.type,Tr=_e(Ht);if(ei==b)Ht=Tr;else if(!Tr){if(ei==y)continue t;break t}}zt[vt++]=Ht}return zt}me.prototype=no(wc.prototype),me.prototype.constructor=me;function _s(n){var o=-1,c=n==null?0:n.length;for(this.clear();++o<c;){var m=n[o];this.set(m[0],m[1])}}function Qv(){this.__data__=$o?$o(null):{},this.size=0}function Xv(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o}function Zv(n){var o=this.__data__;if($o){var c=o[n];return c===d?e:c}return Te.call(o,n)?o[n]:e}function ty(n){var o=this.__data__;return $o?o[n]!==e:Te.call(o,n)}function ey(n,o){var c=this.__data__;return this.size+=this.has(n)?0:1,c[n]=$o&&o===e?d:o,this}_s.prototype.clear=Qv,_s.prototype.delete=Xv,_s.prototype.get=Zv,_s.prototype.has=ty,_s.prototype.set=ey;function _n(n){var o=-1,c=n==null?0:n.length;for(this.clear();++o<c;){var m=n[o];this.set(m[0],m[1])}}function ry(){this.__data__=[],this.size=0}function iy(n){var o=this.__data__,c=bc(o,n);if(c<0)return!1;var m=o.length-1;return c==m?o.pop():dc.call(o,c,1),--this.size,!0}function ny(n){var o=this.__data__,c=bc(o,n);return c<0?e:o[c][1]}function sy(n){return bc(this.__data__,n)>-1}function oy(n,o){var c=this.__data__,m=bc(c,n);return m<0?(++this.size,c.push([n,o])):c[m][1]=o,this}_n.prototype.clear=ry,_n.prototype.delete=iy,_n.prototype.get=ny,_n.prototype.has=sy,_n.prototype.set=oy;function En(n){var o=-1,c=n==null?0:n.length;for(this.clear();++o<c;){var m=n[o];this.set(m[0],m[1])}}function ay(){this.size=0,this.__data__={hash:new _s,map:new(qo||_n),string:new _s}}function cy(n){var o=Nc(this,n).delete(n);return this.size-=o?1:0,o}function uy(n){return Nc(this,n).get(n)}function hy(n){return Nc(this,n).has(n)}function ly(n,o){var c=Nc(this,n),m=c.size;return c.set(n,o),this.size+=c.size==m?0:1,this}En.prototype.clear=ay,En.prototype.delete=cy,En.prototype.get=uy,En.prototype.has=hy,En.prototype.set=ly;function Es(n){var o=-1,c=n==null?0:n.length;for(this.__data__=new En;++o<c;)this.add(n[o])}function fy(n){return this.__data__.set(n,d),this}function dy(n){return this.__data__.has(n)}Es.prototype.add=Es.prototype.push=fy,Es.prototype.has=dy;function Ni(n){var o=this.__data__=new _n(n);this.size=o.size}function py(){this.__data__=new _n,this.size=0}function gy(n){var o=this.__data__,c=o.delete(n);return this.size=o.size,c}function my(n){return this.__data__.get(n)}function vy(n){return this.__data__.has(n)}function yy(n,o){var c=this.__data__;if(c instanceof _n){var m=c.__data__;if(!qo||m.length<s-1)return m.push([n,o]),this.size=++c.size,this;c=this.__data__=new En(m)}return c.set(n,o),this.size=c.size,this}Ni.prototype.clear=py,Ni.prototype.delete=gy,Ni.prototype.get=my,Ni.prototype.has=vy,Ni.prototype.set=yy;function Qf(n,o){var c=ie(n),m=!c&&xs(n),A=!c&&!m&&Qn(n),N=!c&&!m&&!A&&co(n),K=c||m||A||N,Y=K?Zu(n.length,Mv):[],X=Y.length;for(var ct in n)(o||Te.call(n,ct))&&!(K&&(ct=="length"||A&&(ct=="offset"||ct=="parent")||N&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Dn(ct,X)))&&Y.push(ct);return Y}function Xf(n){var o=n.length;return o?n[mh(0,o-1)]:e}function wy(n,o){return Tc(jr(n),As(o,0,n.length))}function by(n){return Tc(jr(n))}function oh(n,o,c){(c!==e&&!Ti(n[o],c)||c===e&&!(o in n))&&An(n,o,c)}function zo(n,o,c){var m=n[o];(!(Te.call(n,o)&&Ti(m,c))||c===e&&!(o in n))&&An(n,o,c)}function bc(n,o){for(var c=n.length;c--;)if(Ti(n[c][0],o))return c;return-1}function _y(n,o,c,m){return Gn(n,function(A,N,K){o(m,A,c(A),K)}),m}function Zf(n,o){return n&&Qi(o,dr(o),n)}function Ey(n,o){return n&&Qi(o,kr(o),n)}function An(n,o,c){o=="__proto__"&&pc?pc(n,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):n[o]=c}function ah(n,o){for(var c=-1,m=o.length,A=it(m),N=n==null;++c<m;)A[c]=N?e:$h(n,o[c]);return A}function As(n,o,c){return n===n&&(c!==e&&(n=n<=c?n:c),o!==e&&(n=n>=o?n:o)),n}function mi(n,o,c,m,A,N){var K,Y=o&_,X=o&I,ct=o&S;if(c&&(K=A?c(n,m,A,N):c(n)),K!==e)return K;if(!Je(n))return n;var ut=ie(n);if(ut){if(K=hw(n),!Y)return jr(n,K)}else{var ft=Ir(n),vt=ft==et||ft==ot;if(Qn(n))return Ad(n,Y);if(ft==It||ft==E||vt&&!A){if(K=X||vt?{}:kd(n),!Y)return X?Zy(n,Ey(K,n)):Xy(n,Zf(K,n))}else{if(!Ue[ft])return A?n:{};K=lw(n,ft,Y)}}N||(N=new Ni);var Ft=N.get(n);if(Ft)return Ft;N.set(n,K),vp(n)?n.forEach(function(Ht){K.add(mi(Ht,o,c,Ht,n,N))}):gp(n)&&n.forEach(function(Ht,de){K.set(de,mi(Ht,o,c,de,n,N))});var zt=ct?X?xh:Dh:X?kr:dr,he=ut?e:zt(n);return di(he||n,function(Ht,de){he&&(de=Ht,Ht=n[de]),zo(K,de,mi(Ht,o,c,de,n,N))}),K}function Ay(n){var o=dr(n);return function(c){return td(c,n,o)}}function td(n,o,c){var m=c.length;if(n==null)return!m;for(n=je(n);m--;){var A=c[m],N=o[A],K=n[A];if(K===e&&!(A in n)||!N(K))return!1}return!0}function ed(n,o,c){if(typeof n!="function")throw new pi(u);return Jo(function(){n.apply(e,c)},o)}function Ho(n,o,c,m){var A=-1,N=ic,K=!0,Y=n.length,X=[],ct=o.length;if(!Y)return X;c&&(o=Ge(o,Xr(c))),m?(N=Gu,K=!1):o.length>=s&&(N=Lo,K=!1,o=new Es(o));t:for(;++A<Y;){var ut=n[A],ft=c==null?ut:c(ut);if(ut=m||ut!==0?ut:0,K&&ft===ft){for(var vt=ct;vt--;)if(o[vt]===ft)continue t;X.push(ut)}else N(o,ft,m)||X.push(ut)}return X}var Gn=Md(Ji),rd=Md(uh,!0);function Sy(n,o){var c=!0;return Gn(n,function(m,A,N){return c=!!o(m,A,N),c}),c}function _c(n,o,c){for(var m=-1,A=n.length;++m<A;){var N=n[m],K=o(N);if(K!=null&&(Y===e?K===K&&!ti(K):c(K,Y)))var Y=K,X=N}return X}function Iy(n,o,c,m){var A=n.length;for(c=ce(c),c<0&&(c=-c>A?0:A+c),m=m===e||m>A?A:ce(m),m<0&&(m+=A),m=c>m?0:wp(m);c<m;)n[c++]=o;return n}function id(n,o){var c=[];return Gn(n,function(m,A,N){o(m,A,N)&&c.push(m)}),c}function wr(n,o,c,m,A){var N=-1,K=n.length;for(c||(c=dw),A||(A=[]);++N<K;){var Y=n[N];o>0&&c(Y)?o>1?wr(Y,o-1,c,m,A):Hn(A,Y):m||(A[A.length]=Y)}return A}var ch=Pd(),nd=Pd(!0);function Ji(n,o){return n&&ch(n,o,dr)}function uh(n,o){return n&&nd(n,o,dr)}function Ec(n,o){return zn(o,function(c){return xn(n[c])})}function Ss(n,o){o=Yn(o,n);for(var c=0,m=o.length;n!=null&&c<m;)n=n[Xi(o[c++])];return c&&c==m?n:e}function sd(n,o,c){var m=o(n);return ie(n)?m:Hn(m,c(n))}function Or(n){return n==null?n===e?Vt:Ct:bs&&bs in je(n)?aw(n):bw(n)}function hh(n,o){return n>o}function Dy(n,o){return n!=null&&Te.call(n,o)}function xy(n,o){return n!=null&&o in je(n)}function My(n,o,c){return n>=Sr(o,c)&&n<cr(o,c)}function lh(n,o,c){for(var m=c?Gu:ic,A=n[0].length,N=n.length,K=N,Y=it(N),X=1/0,ct=[];K--;){var ut=n[K];K&&o&&(ut=Ge(ut,Xr(o))),X=Sr(ut.length,X),Y[K]=!c&&(o||A>=120&&ut.length>=120)?new Es(K&&ut):e}ut=n[0];var ft=-1,vt=Y[0];t:for(;++ft<A&&ct.length<X;){var Ft=ut[ft],zt=o?o(Ft):Ft;if(Ft=c||Ft!==0?Ft:0,!(vt?Lo(vt,zt):m(ct,zt,c))){for(K=N;--K;){var he=Y[K];if(!(he?Lo(he,zt):m(n[K],zt,c)))continue t}vt&&vt.push(zt),ct.push(Ft)}}return ct}function Py(n,o,c,m){return Ji(n,function(A,N,K){o(m,c(A),N,K)}),m}function Ko(n,o,c){o=Yn(o,n),n=Vd(n,o);var m=n==null?n:n[Xi(yi(o))];return m==null?e:fr(m,n,c)}function od(n){return Qe(n)&&Or(n)==E}function Cy(n){return Qe(n)&&Or(n)==Ut}function Oy(n){return Qe(n)&&Or(n)==z}function Vo(n,o,c,m,A){return n===o?!0:n==null||o==null||!Qe(n)&&!Qe(o)?n!==n&&o!==o:Ny(n,o,c,m,Vo,A)}function Ny(n,o,c,m,A,N){var K=ie(n),Y=ie(o),X=K?tt:Ir(n),ct=Y?tt:Ir(o);X=X==E?It:X,ct=ct==E?It:ct;var ut=X==It,ft=ct==It,vt=X==ct;if(vt&&Qn(n)){if(!Qn(o))return!1;K=!0,ut=!1}if(vt&&!ut)return N||(N=new Ni),K||co(n)?qd(n,o,c,m,A,N):sw(n,o,X,c,m,A,N);if(!(c&M)){var Ft=ut&&Te.call(n,"__wrapped__"),zt=ft&&Te.call(o,"__wrapped__");if(Ft||zt){var he=Ft?n.value():n,Ht=zt?o.value():o;return N||(N=new Ni),A(he,Ht,c,m,N)}}return vt?(N||(N=new Ni),ow(n,o,c,m,A,N)):!1}function Ty(n){return Qe(n)&&Ir(n)==at}function fh(n,o,c,m){var A=c.length,N=A,K=!m;if(n==null)return!N;for(n=je(n);A--;){var Y=c[A];if(K&&Y[2]?Y[1]!==n[Y[0]]:!(Y[0]in n))return!1}for(;++A<N;){Y=c[A];var X=Y[0],ct=n[X],ut=Y[1];if(K&&Y[2]){if(ct===e&&!(X in n))return!1}else{var ft=new Ni;if(m)var vt=m(ct,ut,X,n,o,ft);if(!(vt===e?Vo(ut,ct,M|G,m,ft):vt))return!1}}return!0}function ad(n){if(!Je(n)||gw(n))return!1;var o=xn(n)?Tv:ui;return o.test(Ds(n))}function Ry(n){return Qe(n)&&Or(n)==xt}function Fy(n){return Qe(n)&&Ir(n)==Lt}function Uy(n){return Qe(n)&&qc(n.length)&&!!Le[Or(n)]}function cd(n){return typeof n=="function"?n:n==null?zr:typeof n=="object"?ie(n)?ld(n[0],n[1]):hd(n):Cp(n)}function dh(n){if(!Yo(n))return qv(n);var o=[];for(var c in je(n))Te.call(n,c)&&c!="constructor"&&o.push(c);return o}function Ly(n){if(!Je(n))return ww(n);var o=Yo(n),c=[];for(var m in n)m=="constructor"&&(o||!Te.call(n,m))||c.push(m);return c}function ph(n,o){return n<o}function ud(n,o){var c=-1,m=$r(n)?it(n.length):[];return Gn(n,function(A,N,K){m[++c]=o(A,N,K)}),m}function hd(n){var o=Ph(n);return o.length==1&&o[0][2]?Hd(o[0][0],o[0][1]):function(c){return c===n||fh(c,n,o)}}function ld(n,o){return Oh(n)&&zd(o)?Hd(Xi(n),o):function(c){var m=$h(c,n);return m===e&&m===o?kh(c,n):Vo(o,m,M|G)}}function Ac(n,o,c,m,A){n!==o&&ch(o,function(N,K){if(A||(A=new Ni),Je(N))By(n,o,K,c,Ac,m,A);else{var Y=m?m(Th(n,K),N,K+"",n,o,A):e;Y===e&&(Y=N),oh(n,K,Y)}},kr)}function By(n,o,c,m,A,N,K){var Y=Th(n,c),X=Th(o,c),ct=K.get(X);if(ct){oh(n,c,ct);return}var ut=N?N(Y,X,c+"",n,o,K):e,ft=ut===e;if(ft){var vt=ie(X),Ft=!vt&&Qn(X),zt=!vt&&!Ft&&co(X);ut=X,vt||Ft||zt?ie(Y)?ut=Y:er(Y)?ut=jr(Y):Ft?(ft=!1,ut=Ad(X,!0)):zt?(ft=!1,ut=Sd(X,!0)):ut=[]:Qo(X)||xs(X)?(ut=Y,xs(Y)?ut=bp(Y):(!Je(Y)||xn(Y))&&(ut=kd(X))):ft=!1}ft&&(K.set(X,ut),A(ut,X,m,N,K),K.delete(X)),oh(n,c,ut)}function fd(n,o){var c=n.length;if(c)return o+=o<0?c:0,Dn(o,c)?n[o]:e}function dd(n,o,c){o.length?o=Ge(o,function(N){return ie(N)?function(K){return Ss(K,N.length===1?N[0]:N)}:N}):o=[zr];var m=-1;o=Ge(o,Xr(jt()));var A=ud(n,function(N,K,Y){var X=Ge(o,function(ct){return ct(N)});return{criteria:X,index:++m,value:N}});return lv(A,function(N,K){return Qy(N,K,c)})}function qy(n,o){return pd(n,o,function(c,m){return kh(n,m)})}function pd(n,o,c){for(var m=-1,A=o.length,N={};++m<A;){var K=o[m],Y=Ss(n,K);c(Y,K)&&Go(N,Yn(K,n),Y)}return N}function jy(n){return function(o){return Ss(o,n)}}function gh(n,o,c,m){var A=m?hv:Qs,N=-1,K=o.length,Y=n;for(n===o&&(o=jr(o)),c&&(Y=Ge(n,Xr(c)));++N<K;)for(var X=0,ct=o[N],ut=c?c(ct):ct;(X=A(Y,ut,X,m))>-1;)Y!==n&&dc.call(Y,X,1),dc.call(n,X,1);return n}function gd(n,o){for(var c=n?o.length:0,m=c-1;c--;){var A=o[c];if(c==m||A!==N){var N=A;Dn(A)?dc.call(n,A,1):wh(n,A)}}return n}function mh(n,o){return n+mc(Yf()*(o-n+1))}function $y(n,o,c,m){for(var A=-1,N=cr(gc((o-n)/(c||1)),0),K=it(N);N--;)K[m?N:++A]=n,n+=c;return K}function vh(n,o){var c="";if(!n||o<1||o>O)return c;do o%2&&(c+=n),o=mc(o/2),o&&(n+=n);while(o);return c}function le(n,o){return Rh(Kd(n,o,zr),n+"")}function ky(n){return Xf(uo(n))}function zy(n,o){var c=uo(n);return Tc(c,As(o,0,c.length))}function Go(n,o,c,m){if(!Je(n))return n;o=Yn(o,n);for(var A=-1,N=o.length,K=N-1,Y=n;Y!=null&&++A<N;){var X=Xi(o[A]),ct=c;if(X==="__proto__"||X==="constructor"||X==="prototype")return n;if(A!=K){var ut=Y[X];ct=m?m(ut,X,Y):e,ct===e&&(ct=Je(ut)?ut:Dn(o[A+1])?[]:{})}zo(Y,X,ct),Y=Y[X]}return n}var md=vc?function(n,o){return vc.set(n,o),n}:zr,Hy=pc?function(n,o){return pc(n,"toString",{configurable:!0,enumerable:!1,value:Hh(o),writable:!0})}:zr;function Ky(n){return Tc(uo(n))}function vi(n,o,c){var m=-1,A=n.length;o<0&&(o=-o>A?0:A+o),c=c>A?A:c,c<0&&(c+=A),A=o>c?0:c-o>>>0,o>>>=0;for(var N=it(A);++m<A;)N[m]=n[m+o];return N}function Vy(n,o){var c;return Gn(n,function(m,A,N){return c=o(m,A,N),!c}),!!c}function Sc(n,o,c){var m=0,A=n==null?m:n.length;if(typeof o=="number"&&o===o&&A<=rt){for(;m<A;){var N=m+A>>>1,K=n[N];K!==null&&!ti(K)&&(c?K<=o:K<o)?m=N+1:A=N}return A}return yh(n,o,zr,c)}function yh(n,o,c,m){var A=0,N=n==null?0:n.length;if(N===0)return 0;o=c(o);for(var K=o!==o,Y=o===null,X=ti(o),ct=o===e;A<N;){var ut=mc((A+N)/2),ft=c(n[ut]),vt=ft!==e,Ft=ft===null,zt=ft===ft,he=ti(ft);if(K)var Ht=m||zt;else ct?Ht=zt&&(m||vt):Y?Ht=zt&&vt&&(m||!Ft):X?Ht=zt&&vt&&!Ft&&(m||!he):Ft||he?Ht=!1:Ht=m?ft<=o:ft<o;Ht?A=ut+1:N=ut}return Sr(N,T)}function vd(n,o){for(var c=-1,m=n.length,A=0,N=[];++c<m;){var K=n[c],Y=o?o(K):K;if(!c||!Ti(Y,X)){var X=Y;N[A++]=K===0?0:K}}return N}function yd(n){return typeof n=="number"?n:ti(n)?D:+n}function Zr(n){if(typeof n=="string")return n;if(ie(n))return Ge(n,Zr)+"";if(ti(n))return Jf?Jf.call(n):"";var o=n+"";return o=="0"&&1/n==-C?"-0":o}function Wn(n,o,c){var m=-1,A=ic,N=n.length,K=!0,Y=[],X=Y;if(c)K=!1,A=Gu;else if(N>=s){var ct=o?null:iw(n);if(ct)return sc(ct);K=!1,A=Lo,X=new Es}else X=o?[]:Y;t:for(;++m<N;){var ut=n[m],ft=o?o(ut):ut;if(ut=c||ut!==0?ut:0,K&&ft===ft){for(var vt=X.length;vt--;)if(X[vt]===ft)continue t;o&&X.push(ft),Y.push(ut)}else A(X,ft,c)||(X!==Y&&X.push(ft),Y.push(ut))}return Y}function wh(n,o){return o=Yn(o,n),n=Vd(n,o),n==null||delete n[Xi(yi(o))]}function wd(n,o,c,m){return Go(n,o,c(Ss(n,o)),m)}function Ic(n,o,c,m){for(var A=n.length,N=m?A:-1;(m?N--:++N<A)&&o(n[N],N,n););return c?vi(n,m?0:N,m?N+1:A):vi(n,m?N+1:0,m?A:N)}function bd(n,o){var c=n;return c instanceof me&&(c=c.value()),Wu(o,function(m,A){return A.func.apply(A.thisArg,Hn([m],A.args))},c)}function bh(n,o,c){var m=n.length;if(m<2)return m?Wn(n[0]):[];for(var A=-1,N=it(m);++A<m;)for(var K=n[A],Y=-1;++Y<m;)Y!=A&&(N[A]=Ho(N[A]||K,n[Y],o,c));return Wn(wr(N,1),o,c)}function _d(n,o,c){for(var m=-1,A=n.length,N=o.length,K={};++m<A;){var Y=m<N?o[m]:e;c(K,n[m],Y)}return K}function _h(n){return er(n)?n:[]}function Eh(n){return typeof n=="function"?n:zr}function Yn(n,o){return ie(n)?n:Oh(n,o)?[n]:Jd(Me(n))}var Gy=le;function Jn(n,o,c){var m=n.length;return c=c===e?m:c,!o&&c>=m?n:vi(n,o,c)}var Ed=Rv||function(n){return be.clearTimeout(n)};function Ad(n,o){if(o)return n.slice();var c=n.length,m=Hf?Hf(c):new n.constructor(c);return n.copy(m),m}function Ah(n){var o=new n.constructor(n.byteLength);return new lc(o).set(new lc(n)),o}function Wy(n,o){var c=o?Ah(n.buffer):n.buffer;return new n.constructor(c,n.byteOffset,n.byteLength)}function Yy(n){var o=new n.constructor(n.source,fe.exec(n));return o.lastIndex=n.lastIndex,o}function Jy(n){return ko?je(ko.call(n)):{}}function Sd(n,o){var c=o?Ah(n.buffer):n.buffer;return new n.constructor(c,n.byteOffset,n.length)}function Id(n,o){if(n!==o){var c=n!==e,m=n===null,A=n===n,N=ti(n),K=o!==e,Y=o===null,X=o===o,ct=ti(o);if(!Y&&!ct&&!N&&n>o||N&&K&&X&&!Y&&!ct||m&&K&&X||!c&&X||!A)return 1;if(!m&&!N&&!ct&&n<o||ct&&c&&A&&!m&&!N||Y&&c&&A||!K&&A||!X)return-1}return 0}function Qy(n,o,c){for(var m=-1,A=n.criteria,N=o.criteria,K=A.length,Y=c.length;++m<K;){var X=Id(A[m],N[m]);if(X){if(m>=Y)return X;var ct=c[m];return X*(ct=="desc"?-1:1)}}return n.index-o.index}function Dd(n,o,c,m){for(var A=-1,N=n.length,K=c.length,Y=-1,X=o.length,ct=cr(N-K,0),ut=it(X+ct),ft=!m;++Y<X;)ut[Y]=o[Y];for(;++A<K;)(ft||A<N)&&(ut[c[A]]=n[A]);for(;ct--;)ut[Y++]=n[A++];return ut}function xd(n,o,c,m){for(var A=-1,N=n.length,K=-1,Y=c.length,X=-1,ct=o.length,ut=cr(N-Y,0),ft=it(ut+ct),vt=!m;++A<ut;)ft[A]=n[A];for(var Ft=A;++X<ct;)ft[Ft+X]=o[X];for(;++K<Y;)(vt||A<N)&&(ft[Ft+c[K]]=n[A++]);return ft}function jr(n,o){var c=-1,m=n.length;for(o||(o=it(m));++c<m;)o[c]=n[c];return o}function Qi(n,o,c,m){var A=!c;c||(c={});for(var N=-1,K=o.length;++N<K;){var Y=o[N],X=m?m(c[Y],n[Y],Y,c,n):e;X===e&&(X=n[Y]),A?An(c,Y,X):zo(c,Y,X)}return c}function Xy(n,o){return Qi(n,Ch(n),o)}function Zy(n,o){return Qi(n,jd(n),o)}function Dc(n,o){return function(c,m){var A=ie(c)?nv:_y,N=o?o():{};return A(c,n,jt(m,2),N)}}function so(n){return le(function(o,c){var m=-1,A=c.length,N=A>1?c[A-1]:e,K=A>2?c[2]:e;for(N=n.length>3&&typeof N=="function"?(A--,N):e,K&&Nr(c[0],c[1],K)&&(N=A<3?e:N,A=1),o=je(o);++m<A;){var Y=c[m];Y&&n(o,Y,m,N)}return o})}function Md(n,o){return function(c,m){if(c==null)return c;if(!$r(c))return n(c,m);for(var A=c.length,N=o?A:-1,K=je(c);(o?N--:++N<A)&&m(K[N],N,K)!==!1;);return c}}function Pd(n){return function(o,c,m){for(var A=-1,N=je(o),K=m(o),Y=K.length;Y--;){var X=K[n?Y:++A];if(c(N[X],X,N)===!1)break}return o}}function tw(n,o,c){var m=o&V,A=Wo(n);function N(){var K=this&&this!==be&&this instanceof N?A:n;return K.apply(m?c:this,arguments)}return N}function Cd(n){return function(o){o=Me(o);var c=Xs(o)?Oi(o):e,m=c?c[0]:o.charAt(0),A=c?Jn(c,1).join(""):o.slice(1);return m[n]()+A}}function oo(n){return function(o){return Wu(Mp(xp(o).replace(Fo,"")),n,"")}}function Wo(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var c=no(n.prototype),m=n.apply(c,o);return Je(m)?m:c}}function ew(n,o,c){var m=Wo(n);function A(){for(var N=arguments.length,K=it(N),Y=N,X=ao(A);Y--;)K[Y]=arguments[Y];var ct=N<3&&K[0]!==X&&K[N-1]!==X?[]:Kn(K,X);if(N-=ct.length,N<c)return Fd(n,o,xc,A.placeholder,e,K,ct,e,e,c-N);var ut=this&&this!==be&&this instanceof A?m:n;return fr(ut,this,K)}return A}function Od(n){return function(o,c,m){var A=je(o);if(!$r(o)){var N=jt(c,3);o=dr(o),c=function(Y){return N(A[Y],Y,A)}}var K=n(o,c,m);return K>-1?A[N?o[K]:K]:e}}function Nd(n){return In(function(o){var c=o.length,m=c,A=gi.prototype.thru;for(n&&o.reverse();m--;){var N=o[m];if(typeof N!="function")throw new pi(u);if(A&&!K&&Oc(N)=="wrapper")var K=new gi([],!0)}for(m=K?m:c;++m<c;){N=o[m];var Y=Oc(N),X=Y=="wrapper"?Mh(N):e;X&&Nh(X[0])&&X[1]==(v|W|$|R)&&!X[4].length&&X[9]==1?K=K[Oc(X[0])].apply(K,X[3]):K=N.length==1&&Nh(N)?K[Y]():K.thru(N)}return function(){var ct=arguments,ut=ct[0];if(K&&ct.length==1&&ie(ut))return K.plant(ut).value();for(var ft=0,vt=c?o[ft].apply(this,ct):ut;++ft<c;)vt=o[ft].call(this,vt);return vt}})}function xc(n,o,c,m,A,N,K,Y,X,ct){var ut=o&v,ft=o&V,vt=o&Z,Ft=o&(W|U),zt=o&st,he=vt?e:Wo(n);function Ht(){for(var de=arguments.length,_e=it(de),ei=de;ei--;)_e[ei]=arguments[ei];if(Ft)var Tr=ao(Ht),ri=dv(_e,Tr);if(m&&(_e=Dd(_e,m,A,Ft)),N&&(_e=xd(_e,N,K,Ft)),de-=ri,Ft&&de<ct){var rr=Kn(_e,Tr);return Fd(n,o,xc,Ht.placeholder,c,_e,rr,Y,X,ct-de)}var Ri=ft?c:this,Pn=vt?Ri[n]:n;return de=_e.length,Y?_e=_w(_e,Y):zt&&de>1&&_e.reverse(),ut&&X<de&&(_e.length=X),this&&this!==be&&this instanceof Ht&&(Pn=he||Wo(Pn)),Pn.apply(Ri,_e)}return Ht}function Td(n,o){return function(c,m){return Py(c,n,o(m),{})}}function Mc(n,o){return function(c,m){var A;if(c===e&&m===e)return o;if(c!==e&&(A=c),m!==e){if(A===e)return m;typeof c=="string"||typeof m=="string"?(c=Zr(c),m=Zr(m)):(c=yd(c),m=yd(m)),A=n(c,m)}return A}}function Sh(n){return In(function(o){return o=Ge(o,Xr(jt())),le(function(c){var m=this;return n(o,function(A){return fr(A,m,c)})})})}function Pc(n,o){o=o===e?" ":Zr(o);var c=o.length;if(c<2)return c?vh(o,n):o;var m=vh(o,gc(n/Zs(o)));return Xs(o)?Jn(Oi(m),0,n).join(""):m.slice(0,n)}function rw(n,o,c,m){var A=o&V,N=Wo(n);function K(){for(var Y=-1,X=arguments.length,ct=-1,ut=m.length,ft=it(ut+X),vt=this&&this!==be&&this instanceof K?N:n;++ct<ut;)ft[ct]=m[ct];for(;X--;)ft[ct++]=arguments[++Y];return fr(vt,A?c:this,ft)}return K}function Rd(n){return function(o,c,m){return m&&typeof m!="number"&&Nr(o,c,m)&&(c=m=e),o=Mn(o),c===e?(c=o,o=0):c=Mn(c),m=m===e?o<c?1:-1:Mn(m),$y(o,c,m,n)}}function Cc(n){return function(o,c){return typeof o=="string"&&typeof c=="string"||(o=wi(o),c=wi(c)),n(o,c)}}function Fd(n,o,c,m,A,N,K,Y,X,ct){var ut=o&W,ft=ut?K:e,vt=ut?e:K,Ft=ut?N:e,zt=ut?e:N;o|=ut?$:k,o&=~(ut?k:$),o&H||(o&=~(V|Z));var he=[n,o,A,Ft,ft,zt,vt,Y,X,ct],Ht=c.apply(e,he);return Nh(n)&&Gd(Ht,he),Ht.placeholder=m,Wd(Ht,n,o)}function Ih(n){var o=ar[n];return function(c,m){if(c=wi(c),m=m==null?0:Sr(ce(m),292),m&&Wf(c)){var A=(Me(c)+"e").split("e"),N=o(A[0]+"e"+(+A[1]+m));return A=(Me(N)+"e").split("e"),+(A[0]+"e"+(+A[1]-m))}return o(c)}}var iw=ro&&1/sc(new ro([,-0]))[1]==C?function(n){return new ro(n)}:Gh;function Ud(n){return function(o){var c=Ir(o);return c==at?eh(o):c==Lt?bv(o):fv(o,n(o))}}function Sn(n,o,c,m,A,N,K,Y){var X=o&Z;if(!X&&typeof n!="function")throw new pi(u);var ct=m?m.length:0;if(ct||(o&=~($|k),m=A=e),K=K===e?K:cr(ce(K),0),Y=Y===e?Y:ce(Y),ct-=A?A.length:0,o&k){var ut=m,ft=A;m=A=e}var vt=X?e:Mh(n),Ft=[n,o,c,m,A,ut,ft,N,K,Y];if(vt&&yw(Ft,vt),n=Ft[0],o=Ft[1],c=Ft[2],m=Ft[3],A=Ft[4],Y=Ft[9]=Ft[9]===e?X?0:n.length:cr(Ft[9]-ct,0),!Y&&o&(W|U)&&(o&=~(W|U)),!o||o==V)var zt=tw(n,o,c);else o==W||o==U?zt=ew(n,o,Y):(o==$||o==(V|$))&&!A.length?zt=rw(n,o,c,m):zt=xc.apply(e,Ft);var he=vt?md:Gd;return Wd(he(zt,Ft),n,o)}function Ld(n,o,c,m){return n===e||Ti(n,eo[c])&&!Te.call(m,c)?o:n}function Bd(n,o,c,m,A,N){return Je(n)&&Je(o)&&(N.set(o,n),Ac(n,o,e,Bd,N),N.delete(o)),n}function nw(n){return Qo(n)?e:n}function qd(n,o,c,m,A,N){var K=c&M,Y=n.length,X=o.length;if(Y!=X&&!(K&&X>Y))return!1;var ct=N.get(n),ut=N.get(o);if(ct&&ut)return ct==o&&ut==n;var ft=-1,vt=!0,Ft=c&G?new Es:e;for(N.set(n,o),N.set(o,n);++ft<Y;){var zt=n[ft],he=o[ft];if(m)var Ht=K?m(he,zt,ft,o,n,N):m(zt,he,ft,n,o,N);if(Ht!==e){if(Ht)continue;vt=!1;break}if(Ft){if(!Yu(o,function(de,_e){if(!Lo(Ft,_e)&&(zt===de||A(zt,de,c,m,N)))return Ft.push(_e)})){vt=!1;break}}else if(!(zt===he||A(zt,he,c,m,N))){vt=!1;break}}return N.delete(n),N.delete(o),vt}function sw(n,o,c,m,A,N,K){switch(c){case bt:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case Ut:return!(n.byteLength!=o.byteLength||!N(new lc(n),new lc(o)));case q:case z:case Mt:return Ti(+n,+o);case F:return n.name==o.name&&n.message==o.message;case xt:case _t:return n==o+"";case at:var Y=eh;case Lt:var X=m&M;if(Y||(Y=sc),n.size!=o.size&&!X)return!1;var ct=K.get(n);if(ct)return ct==o;m|=G,K.set(n,o);var ut=qd(Y(n),Y(o),m,A,N,K);return K.delete(n),ut;case Et:if(ko)return ko.call(n)==ko.call(o)}return!1}function ow(n,o,c,m,A,N){var K=c&M,Y=Dh(n),X=Y.length,ct=Dh(o),ut=ct.length;if(X!=ut&&!K)return!1;for(var ft=X;ft--;){var vt=Y[ft];if(!(K?vt in o:Te.call(o,vt)))return!1}var Ft=N.get(n),zt=N.get(o);if(Ft&&zt)return Ft==o&&zt==n;var he=!0;N.set(n,o),N.set(o,n);for(var Ht=K;++ft<X;){vt=Y[ft];var de=n[vt],_e=o[vt];if(m)var ei=K?m(_e,de,vt,o,n,N):m(de,_e,vt,n,o,N);if(!(ei===e?de===_e||A(de,_e,c,m,N):ei)){he=!1;break}Ht||(Ht=vt=="constructor")}if(he&&!Ht){var Tr=n.constructor,ri=o.constructor;Tr!=ri&&"constructor"in n&&"constructor"in o&&!(typeof Tr=="function"&&Tr instanceof Tr&&typeof ri=="function"&&ri instanceof ri)&&(he=!1)}return N.delete(n),N.delete(o),he}function In(n){return Rh(Kd(n,e,tp),n+"")}function Dh(n){return sd(n,dr,Ch)}function xh(n){return sd(n,kr,jd)}var Mh=vc?function(n){return vc.get(n)}:Gh;function Oc(n){for(var o=n.name+"",c=io[o],m=Te.call(io,o)?c.length:0;m--;){var A=c[m],N=A.func;if(N==null||N==n)return A.name}return o}function ao(n){var o=Te.call(x,"placeholder")?x:n;return o.placeholder}function jt(){var n=x.iteratee||Kh;return n=n===Kh?cd:n,arguments.length?n(arguments[0],arguments[1]):n}function Nc(n,o){var c=n.__data__;return pw(o)?c[typeof o=="string"?"string":"hash"]:c.map}function Ph(n){for(var o=dr(n),c=o.length;c--;){var m=o[c],A=n[m];o[c]=[m,A,zd(A)]}return o}function Is(n,o){var c=vv(n,o);return ad(c)?c:e}function aw(n){var o=Te.call(n,bs),c=n[bs];try{n[bs]=e;var m=!0}catch{}var A=uc.call(n);return m&&(o?n[bs]=c:delete n[bs]),A}var Ch=ih?function(n){return n==null?[]:(n=je(n),zn(ih(n),function(o){return Vf.call(n,o)}))}:Wh,jd=ih?function(n){for(var o=[];n;)Hn(o,Ch(n)),n=fc(n);return o}:Wh,Ir=Or;(nh&&Ir(new nh(new ArrayBuffer(1)))!=bt||qo&&Ir(new qo)!=at||sh&&Ir(sh.resolve())!=Ae||ro&&Ir(new ro)!=Lt||jo&&Ir(new jo)!=wt)&&(Ir=function(n){var o=Or(n),c=o==It?n.constructor:e,m=c?Ds(c):"";if(m)switch(m){case zv:return bt;case Hv:return at;case Kv:return Ae;case Vv:return Lt;case Gv:return wt}return o});function cw(n,o,c){for(var m=-1,A=c.length;++m<A;){var N=c[m],K=N.size;switch(N.type){case"drop":n+=K;break;case"dropRight":o-=K;break;case"take":o=Sr(o,n+K);break;case"takeRight":n=cr(n,o-K);break}}return{start:n,end:o}}function uw(n){var o=n.match(qt);return o?o[1].split(Fe):[]}function $d(n,o,c){o=Yn(o,n);for(var m=-1,A=o.length,N=!1;++m<A;){var K=Xi(o[m]);if(!(N=n!=null&&c(n,K)))break;n=n[K]}return N||++m!=A?N:(A=n==null?0:n.length,!!A&&qc(A)&&Dn(K,A)&&(ie(n)||xs(n)))}function hw(n){var o=n.length,c=new n.constructor(o);return o&&typeof n[0]=="string"&&Te.call(n,"index")&&(c.index=n.index,c.input=n.input),c}function kd(n){return typeof n.constructor=="function"&&!Yo(n)?no(fc(n)):{}}function lw(n,o,c){var m=n.constructor;switch(o){case Ut:return Ah(n);case q:case z:return new m(+n);case bt:return Wy(n,c);case Pt:case Bt:case Ot:case Nt:case se:case Rt:case Tt:case We:case ue:return Sd(n,c);case at:return new m;case Mt:case _t:return new m(n);case xt:return Yy(n);case Lt:return new m;case Et:return Jy(n)}}function fw(n,o){var c=o.length;if(!c)return n;var m=c-1;return o[m]=(c>1?"& ":"")+o[m],o=o.join(c>2?", ":" "),n.replace(Jt,`{
/* [wrapped with `+o+`] */
`)}function dw(n){return ie(n)||xs(n)||!!(Gf&&n&&n[Gf])}function Dn(n,o){var c=typeof n;return o=o??O,!!o&&(c=="number"||c!="symbol"&&li.test(n))&&n>-1&&n%1==0&&n<o}function Nr(n,o,c){if(!Je(c))return!1;var m=typeof o;return(m=="number"?$r(c)&&Dn(o,c.length):m=="string"&&o in c)?Ti(c[o],n):!1}function Oh(n,o){if(ie(n))return!1;var c=typeof n;return c=="number"||c=="symbol"||c=="boolean"||n==null||ti(n)?!0:Qt.test(n)||!Se.test(n)||o!=null&&n in je(o)}function pw(n){var o=typeof n;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null}function Nh(n){var o=Oc(n),c=x[o];if(typeof c!="function"||!(o in me.prototype))return!1;if(n===c)return!0;var m=Mh(c);return!!m&&n===m[0]}function gw(n){return!!zf&&zf in n}var mw=ac?xn:Yh;function Yo(n){var o=n&&n.constructor,c=typeof o=="function"&&o.prototype||eo;return n===c}function zd(n){return n===n&&!Je(n)}function Hd(n,o){return function(c){return c==null?!1:c[n]===o&&(o!==e||n in je(c))}}function vw(n){var o=Lc(n,function(m){return c.size===l&&c.clear(),m}),c=o.cache;return o}function yw(n,o){var c=n[1],m=o[1],A=c|m,N=A<(V|Z|v),K=m==v&&c==W||m==v&&c==R&&n[7].length<=o[8]||m==(v|R)&&o[7].length<=o[8]&&c==W;if(!(N||K))return n;m&V&&(n[2]=o[2],A|=c&V?0:H);var Y=o[3];if(Y){var X=n[3];n[3]=X?Dd(X,Y,o[4]):Y,n[4]=X?Kn(n[3],w):o[4]}return Y=o[5],Y&&(X=n[5],n[5]=X?xd(X,Y,o[6]):Y,n[6]=X?Kn(n[5],w):o[6]),Y=o[7],Y&&(n[7]=Y),m&v&&(n[8]=n[8]==null?o[8]:Sr(n[8],o[8])),n[9]==null&&(n[9]=o[9]),n[0]=o[0],n[1]=A,n}function ww(n){var o=[];if(n!=null)for(var c in je(n))o.push(c);return o}function bw(n){return uc.call(n)}function Kd(n,o,c){return o=cr(o===e?n.length-1:o,0),function(){for(var m=arguments,A=-1,N=cr(m.length-o,0),K=it(N);++A<N;)K[A]=m[o+A];A=-1;for(var Y=it(o+1);++A<o;)Y[A]=m[A];return Y[o]=c(K),fr(n,this,Y)}}function Vd(n,o){return o.length<2?n:Ss(n,vi(o,0,-1))}function _w(n,o){for(var c=n.length,m=Sr(o.length,c),A=jr(n);m--;){var N=o[m];n[m]=Dn(N,c)?A[N]:e}return n}function Th(n,o){if(!(o==="constructor"&&typeof n[o]=="function")&&o!="__proto__")return n[o]}var Gd=Yd(md),Jo=Uv||function(n,o){return be.setTimeout(n,o)},Rh=Yd(Hy);function Wd(n,o,c){var m=o+"";return Rh(n,fw(m,Ew(uw(m),c)))}function Yd(n){var o=0,c=0;return function(){var m=jv(),A=f-(m-c);if(c=m,A>0){if(++o>=yt)return arguments[0]}else o=0;return n.apply(e,arguments)}}function Tc(n,o){var c=-1,m=n.length,A=m-1;for(o=o===e?m:o;++c<o;){var N=mh(c,A),K=n[N];n[N]=n[c],n[c]=K}return n.length=o,n}var Jd=vw(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(Xt,function(c,m,A,N){o.push(A?N.replace(Pi,"$1"):m||c)}),o});function Xi(n){if(typeof n=="string"||ti(n))return n;var o=n+"";return o=="0"&&1/n==-C?"-0":o}function Ds(n){if(n!=null){try{return cc.call(n)}catch{}try{return n+""}catch{}}return""}function Ew(n,o){return di(lt,function(c){var m="_."+c[0];o&c[1]&&!ic(n,m)&&n.push(m)}),n.sort()}function Qd(n){if(n instanceof me)return n.clone();var o=new gi(n.__wrapped__,n.__chain__);return o.__actions__=jr(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}function Aw(n,o,c){(c?Nr(n,o,c):o===e)?o=1:o=cr(ce(o),0);var m=n==null?0:n.length;if(!m||o<1)return[];for(var A=0,N=0,K=it(gc(m/o));A<m;)K[N++]=vi(n,A,A+=o);return K}function Sw(n){for(var o=-1,c=n==null?0:n.length,m=0,A=[];++o<c;){var N=n[o];N&&(A[m++]=N)}return A}function Iw(){var n=arguments.length;if(!n)return[];for(var o=it(n-1),c=arguments[0],m=n;m--;)o[m-1]=arguments[m];return Hn(ie(c)?jr(c):[c],wr(o,1))}var Dw=le(function(n,o){return er(n)?Ho(n,wr(o,1,er,!0)):[]}),xw=le(function(n,o){var c=yi(o);return er(c)&&(c=e),er(n)?Ho(n,wr(o,1,er,!0),jt(c,2)):[]}),Mw=le(function(n,o){var c=yi(o);return er(c)&&(c=e),er(n)?Ho(n,wr(o,1,er,!0),e,c):[]});function Pw(n,o,c){var m=n==null?0:n.length;return m?(o=c||o===e?1:ce(o),vi(n,o<0?0:o,m)):[]}function Cw(n,o,c){var m=n==null?0:n.length;return m?(o=c||o===e?1:ce(o),o=m-o,vi(n,0,o<0?0:o)):[]}function Ow(n,o){return n&&n.length?Ic(n,jt(o,3),!0,!0):[]}function Nw(n,o){return n&&n.length?Ic(n,jt(o,3),!0):[]}function Tw(n,o,c,m){var A=n==null?0:n.length;return A?(c&&typeof c!="number"&&Nr(n,o,c)&&(c=0,m=A),Iy(n,o,c,m)):[]}function Xd(n,o,c){var m=n==null?0:n.length;if(!m)return-1;var A=c==null?0:ce(c);return A<0&&(A=cr(m+A,0)),nc(n,jt(o,3),A)}function Zd(n,o,c){var m=n==null?0:n.length;if(!m)return-1;var A=m-1;return c!==e&&(A=ce(c),A=c<0?cr(m+A,0):Sr(A,m-1)),nc(n,jt(o,3),A,!0)}function tp(n){var o=n==null?0:n.length;return o?wr(n,1):[]}function Rw(n){var o=n==null?0:n.length;return o?wr(n,C):[]}function Fw(n,o){var c=n==null?0:n.length;return c?(o=o===e?1:ce(o),wr(n,o)):[]}function Uw(n){for(var o=-1,c=n==null?0:n.length,m={};++o<c;){var A=n[o];m[A[0]]=A[1]}return m}function ep(n){return n&&n.length?n[0]:e}function Lw(n,o,c){var m=n==null?0:n.length;if(!m)return-1;var A=c==null?0:ce(c);return A<0&&(A=cr(m+A,0)),Qs(n,o,A)}function Bw(n){var o=n==null?0:n.length;return o?vi(n,0,-1):[]}var qw=le(function(n){var o=Ge(n,_h);return o.length&&o[0]===n[0]?lh(o):[]}),jw=le(function(n){var o=yi(n),c=Ge(n,_h);return o===yi(c)?o=e:c.pop(),c.length&&c[0]===n[0]?lh(c,jt(o,2)):[]}),$w=le(function(n){var o=yi(n),c=Ge(n,_h);return o=typeof o=="function"?o:e,o&&c.pop(),c.length&&c[0]===n[0]?lh(c,e,o):[]});function kw(n,o){return n==null?"":Bv.call(n,o)}function yi(n){var o=n==null?0:n.length;return o?n[o-1]:e}function zw(n,o,c){var m=n==null?0:n.length;if(!m)return-1;var A=m;return c!==e&&(A=ce(c),A=A<0?cr(m+A,0):Sr(A,m-1)),o===o?Ev(n,o,A):nc(n,Ff,A,!0)}function Hw(n,o){return n&&n.length?fd(n,ce(o)):e}var Kw=le(rp);function rp(n,o){return n&&n.length&&o&&o.length?gh(n,o):n}function Vw(n,o,c){return n&&n.length&&o&&o.length?gh(n,o,jt(c,2)):n}function Gw(n,o,c){return n&&n.length&&o&&o.length?gh(n,o,e,c):n}var Ww=In(function(n,o){var c=n==null?0:n.length,m=ah(n,o);return gd(n,Ge(o,function(A){return Dn(A,c)?+A:A}).sort(Id)),m});function Yw(n,o){var c=[];if(!(n&&n.length))return c;var m=-1,A=[],N=n.length;for(o=jt(o,3);++m<N;){var K=n[m];o(K,m,n)&&(c.push(K),A.push(m))}return gd(n,A),c}function Fh(n){return n==null?n:kv.call(n)}function Jw(n,o,c){var m=n==null?0:n.length;return m?(c&&typeof c!="number"&&Nr(n,o,c)?(o=0,c=m):(o=o==null?0:ce(o),c=c===e?m:ce(c)),vi(n,o,c)):[]}function Qw(n,o){return Sc(n,o)}function Xw(n,o,c){return yh(n,o,jt(c,2))}function Zw(n,o){var c=n==null?0:n.length;if(c){var m=Sc(n,o);if(m<c&&Ti(n[m],o))return m}return-1}function tb(n,o){return Sc(n,o,!0)}function eb(n,o,c){return yh(n,o,jt(c,2),!0)}function rb(n,o){var c=n==null?0:n.length;if(c){var m=Sc(n,o,!0)-1;if(Ti(n[m],o))return m}return-1}function ib(n){return n&&n.length?vd(n):[]}function nb(n,o){return n&&n.length?vd(n,jt(o,2)):[]}function sb(n){var o=n==null?0:n.length;return o?vi(n,1,o):[]}function ob(n,o,c){return n&&n.length?(o=c||o===e?1:ce(o),vi(n,0,o<0?0:o)):[]}function ab(n,o,c){var m=n==null?0:n.length;return m?(o=c||o===e?1:ce(o),o=m-o,vi(n,o<0?0:o,m)):[]}function cb(n,o){return n&&n.length?Ic(n,jt(o,3),!1,!0):[]}function ub(n,o){return n&&n.length?Ic(n,jt(o,3)):[]}var hb=le(function(n){return Wn(wr(n,1,er,!0))}),lb=le(function(n){var o=yi(n);return er(o)&&(o=e),Wn(wr(n,1,er,!0),jt(o,2))}),fb=le(function(n){var o=yi(n);return o=typeof o=="function"?o:e,Wn(wr(n,1,er,!0),e,o)});function db(n){return n&&n.length?Wn(n):[]}function pb(n,o){return n&&n.length?Wn(n,jt(o,2)):[]}function gb(n,o){return o=typeof o=="function"?o:e,n&&n.length?Wn(n,e,o):[]}function Uh(n){if(!(n&&n.length))return[];var o=0;return n=zn(n,function(c){if(er(c))return o=cr(c.length,o),!0}),Zu(o,function(c){return Ge(n,Ju(c))})}function ip(n,o){if(!(n&&n.length))return[];var c=Uh(n);return o==null?c:Ge(c,function(m){return fr(o,e,m)})}var mb=le(function(n,o){return er(n)?Ho(n,o):[]}),vb=le(function(n){return bh(zn(n,er))}),yb=le(function(n){var o=yi(n);return er(o)&&(o=e),bh(zn(n,er),jt(o,2))}),wb=le(function(n){var o=yi(n);return o=typeof o=="function"?o:e,bh(zn(n,er),e,o)}),bb=le(Uh);function _b(n,o){return _d(n||[],o||[],zo)}function Eb(n,o){return _d(n||[],o||[],Go)}var Ab=le(function(n){var o=n.length,c=o>1?n[o-1]:e;return c=typeof c=="function"?(n.pop(),c):e,ip(n,c)});function np(n){var o=x(n);return o.__chain__=!0,o}function Sb(n,o){return o(n),n}function Rc(n,o){return o(n)}var Ib=In(function(n){var o=n.length,c=o?n[0]:0,m=this.__wrapped__,A=function(N){return ah(N,n)};return o>1||this.__actions__.length||!(m instanceof me)||!Dn(c)?this.thru(A):(m=m.slice(c,+c+(o?1:0)),m.__actions__.push({func:Rc,args:[A],thisArg:e}),new gi(m,this.__chain__).thru(function(N){return o&&!N.length&&N.push(e),N}))});function Db(){return np(this)}function xb(){return new gi(this.value(),this.__chain__)}function Mb(){this.__values__===e&&(this.__values__=yp(this.value()));var n=this.__index__>=this.__values__.length,o=n?e:this.__values__[this.__index__++];return{done:n,value:o}}function Pb(){return this}function Cb(n){for(var o,c=this;c instanceof wc;){var m=Qd(c);m.__index__=0,m.__values__=e,o?A.__wrapped__=m:o=m;var A=m;c=c.__wrapped__}return A.__wrapped__=n,o}function Ob(){var n=this.__wrapped__;if(n instanceof me){var o=n;return this.__actions__.length&&(o=new me(this)),o=o.reverse(),o.__actions__.push({func:Rc,args:[Fh],thisArg:e}),new gi(o,this.__chain__)}return this.thru(Fh)}function Nb(){return bd(this.__wrapped__,this.__actions__)}var Tb=Dc(function(n,o,c){Te.call(n,c)?++n[c]:An(n,c,1)});function Rb(n,o,c){var m=ie(n)?Tf:Sy;return c&&Nr(n,o,c)&&(o=e),m(n,jt(o,3))}function Fb(n,o){var c=ie(n)?zn:id;return c(n,jt(o,3))}var Ub=Od(Xd),Lb=Od(Zd);function Bb(n,o){return wr(Fc(n,o),1)}function qb(n,o){return wr(Fc(n,o),C)}function jb(n,o,c){return c=c===e?1:ce(c),wr(Fc(n,o),c)}function sp(n,o){var c=ie(n)?di:Gn;return c(n,jt(o,3))}function op(n,o){var c=ie(n)?sv:rd;return c(n,jt(o,3))}var $b=Dc(function(n,o,c){Te.call(n,c)?n[c].push(o):An(n,c,[o])});function kb(n,o,c,m){n=$r(n)?n:uo(n),c=c&&!m?ce(c):0;var A=n.length;return c<0&&(c=cr(A+c,0)),jc(n)?c<=A&&n.indexOf(o,c)>-1:!!A&&Qs(n,o,c)>-1}var zb=le(function(n,o,c){var m=-1,A=typeof o=="function",N=$r(n)?it(n.length):[];return Gn(n,function(K){N[++m]=A?fr(o,K,c):Ko(K,o,c)}),N}),Hb=Dc(function(n,o,c){An(n,c,o)});function Fc(n,o){var c=ie(n)?Ge:ud;return c(n,jt(o,3))}function Kb(n,o,c,m){return n==null?[]:(ie(o)||(o=o==null?[]:[o]),c=m?e:c,ie(c)||(c=c==null?[]:[c]),dd(n,o,c))}var Vb=Dc(function(n,o,c){n[c?0:1].push(o)},function(){return[[],[]]});function Gb(n,o,c){var m=ie(n)?Wu:Lf,A=arguments.length<3;return m(n,jt(o,4),c,A,Gn)}function Wb(n,o,c){var m=ie(n)?ov:Lf,A=arguments.length<3;return m(n,jt(o,4),c,A,rd)}function Yb(n,o){var c=ie(n)?zn:id;return c(n,Bc(jt(o,3)))}function Jb(n){var o=ie(n)?Xf:ky;return o(n)}function Qb(n,o,c){(c?Nr(n,o,c):o===e)?o=1:o=ce(o);var m=ie(n)?wy:zy;return m(n,o)}function Xb(n){var o=ie(n)?by:Ky;return o(n)}function Zb(n){if(n==null)return 0;if($r(n))return jc(n)?Zs(n):n.length;var o=Ir(n);return o==at||o==Lt?n.size:dh(n).length}function t_(n,o,c){var m=ie(n)?Yu:Vy;return c&&Nr(n,o,c)&&(o=e),m(n,jt(o,3))}var e_=le(function(n,o){if(n==null)return[];var c=o.length;return c>1&&Nr(n,o[0],o[1])?o=[]:c>2&&Nr(o[0],o[1],o[2])&&(o=[o[0]]),dd(n,wr(o,1),[])}),Uc=Fv||function(){return be.Date.now()};function r_(n,o){if(typeof o!="function")throw new pi(u);return n=ce(n),function(){if(--n<1)return o.apply(this,arguments)}}function ap(n,o,c){return o=c?e:o,o=n&&o==null?n.length:o,Sn(n,v,e,e,e,e,o)}function cp(n,o){var c;if(typeof o!="function")throw new pi(u);return n=ce(n),function(){return--n>0&&(c=o.apply(this,arguments)),n<=1&&(o=e),c}}var Lh=le(function(n,o,c){var m=V;if(c.length){var A=Kn(c,ao(Lh));m|=$}return Sn(n,m,o,c,A)}),up=le(function(n,o,c){var m=V|Z;if(c.length){var A=Kn(c,ao(up));m|=$}return Sn(o,m,n,c,A)});function hp(n,o,c){o=c?e:o;var m=Sn(n,W,e,e,e,e,e,o);return m.placeholder=hp.placeholder,m}function lp(n,o,c){o=c?e:o;var m=Sn(n,U,e,e,e,e,e,o);return m.placeholder=lp.placeholder,m}function fp(n,o,c){var m,A,N,K,Y,X,ct=0,ut=!1,ft=!1,vt=!0;if(typeof n!="function")throw new pi(u);o=wi(o)||0,Je(c)&&(ut=!!c.leading,ft="maxWait"in c,N=ft?cr(wi(c.maxWait)||0,o):N,vt="trailing"in c?!!c.trailing:vt);function Ft(rr){var Ri=m,Pn=A;return m=A=e,ct=rr,K=n.apply(Pn,Ri),K}function zt(rr){return ct=rr,Y=Jo(de,o),ut?Ft(rr):K}function he(rr){var Ri=rr-X,Pn=rr-ct,Op=o-Ri;return ft?Sr(Op,N-Pn):Op}function Ht(rr){var Ri=rr-X,Pn=rr-ct;return X===e||Ri>=o||Ri<0||ft&&Pn>=N}function de(){var rr=Uc();if(Ht(rr))return _e(rr);Y=Jo(de,he(rr))}function _e(rr){return Y=e,vt&&m?Ft(rr):(m=A=e,K)}function ei(){Y!==e&&Ed(Y),ct=0,m=X=A=Y=e}function Tr(){return Y===e?K:_e(Uc())}function ri(){var rr=Uc(),Ri=Ht(rr);if(m=arguments,A=this,X=rr,Ri){if(Y===e)return zt(X);if(ft)return Ed(Y),Y=Jo(de,o),Ft(X)}return Y===e&&(Y=Jo(de,o)),K}return ri.cancel=ei,ri.flush=Tr,ri}var i_=le(function(n,o){return ed(n,1,o)}),n_=le(function(n,o,c){return ed(n,wi(o)||0,c)});function s_(n){return Sn(n,st)}function Lc(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new pi(u);var c=function(){var m=arguments,A=o?o.apply(this,m):m[0],N=c.cache;if(N.has(A))return N.get(A);var K=n.apply(this,m);return c.cache=N.set(A,K)||N,K};return c.cache=new(Lc.Cache||En),c}Lc.Cache=En;function Bc(n){if(typeof n!="function")throw new pi(u);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}function o_(n){return cp(2,n)}var a_=Gy(function(n,o){o=o.length==1&&ie(o[0])?Ge(o[0],Xr(jt())):Ge(wr(o,1),Xr(jt()));var c=o.length;return le(function(m){for(var A=-1,N=Sr(m.length,c);++A<N;)m[A]=o[A].call(this,m[A]);return fr(n,this,m)})}),Bh=le(function(n,o){var c=Kn(o,ao(Bh));return Sn(n,$,e,o,c)}),dp=le(function(n,o){var c=Kn(o,ao(dp));return Sn(n,k,e,o,c)}),c_=In(function(n,o){return Sn(n,R,e,e,e,o)});function u_(n,o){if(typeof n!="function")throw new pi(u);return o=o===e?o:ce(o),le(n,o)}function h_(n,o){if(typeof n!="function")throw new pi(u);return o=o==null?0:cr(ce(o),0),le(function(c){var m=c[o],A=Jn(c,0,o);return m&&Hn(A,m),fr(n,this,A)})}function l_(n,o,c){var m=!0,A=!0;if(typeof n!="function")throw new pi(u);return Je(c)&&(m="leading"in c?!!c.leading:m,A="trailing"in c?!!c.trailing:A),fp(n,o,{leading:m,maxWait:o,trailing:A})}function f_(n){return ap(n,1)}function d_(n,o){return Bh(Eh(o),n)}function p_(){if(!arguments.length)return[];var n=arguments[0];return ie(n)?n:[n]}function g_(n){return mi(n,S)}function m_(n,o){return o=typeof o=="function"?o:e,mi(n,S,o)}function v_(n){return mi(n,_|S)}function y_(n,o){return o=typeof o=="function"?o:e,mi(n,_|S,o)}function w_(n,o){return o==null||td(n,o,dr(o))}function Ti(n,o){return n===o||n!==n&&o!==o}var b_=Cc(hh),__=Cc(function(n,o){return n>=o}),xs=od(function(){return arguments}())?od:function(n){return Qe(n)&&Te.call(n,"callee")&&!Vf.call(n,"callee")},ie=it.isArray,E_=Cr?Xr(Cr):Cy;function $r(n){return n!=null&&qc(n.length)&&!xn(n)}function er(n){return Qe(n)&&$r(n)}function A_(n){return n===!0||n===!1||Qe(n)&&Or(n)==q}var Qn=Lv||Yh,S_=Ci?Xr(Ci):Oy;function I_(n){return Qe(n)&&n.nodeType===1&&!Qo(n)}function D_(n){if(n==null)return!0;if($r(n)&&(ie(n)||typeof n=="string"||typeof n.splice=="function"||Qn(n)||co(n)||xs(n)))return!n.length;var o=Ir(n);if(o==at||o==Lt)return!n.size;if(Yo(n))return!dh(n).length;for(var c in n)if(Te.call(n,c))return!1;return!0}function x_(n,o){return Vo(n,o)}function M_(n,o,c){c=typeof c=="function"?c:e;var m=c?c(n,o):e;return m===e?Vo(n,o,e,c):!!m}function qh(n){if(!Qe(n))return!1;var o=Or(n);return o==F||o==p||typeof n.message=="string"&&typeof n.name=="string"&&!Qo(n)}function P_(n){return typeof n=="number"&&Wf(n)}function xn(n){if(!Je(n))return!1;var o=Or(n);return o==et||o==ot||o==L||o==$t}function pp(n){return typeof n=="number"&&n==ce(n)}function qc(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=O}function Je(n){var o=typeof n;return n!=null&&(o=="object"||o=="function")}function Qe(n){return n!=null&&typeof n=="object"}var gp=fi?Xr(fi):Ty;function C_(n,o){return n===o||fh(n,o,Ph(o))}function O_(n,o,c){return c=typeof c=="function"?c:e,fh(n,o,Ph(o),c)}function N_(n){return mp(n)&&n!=+n}function T_(n){if(mw(n))throw new ee(a);return ad(n)}function R_(n){return n===null}function F_(n){return n==null}function mp(n){return typeof n=="number"||Qe(n)&&Or(n)==Mt}function Qo(n){if(!Qe(n)||Or(n)!=It)return!1;var o=fc(n);if(o===null)return!0;var c=Te.call(o,"constructor")&&o.constructor;return typeof c=="function"&&c instanceof c&&cc.call(c)==Ov}var jh=Yi?Xr(Yi):Ry;function U_(n){return pp(n)&&n>=-O&&n<=O}var vp=Uo?Xr(Uo):Fy;function jc(n){return typeof n=="string"||!ie(n)&&Qe(n)&&Or(n)==_t}function ti(n){return typeof n=="symbol"||Qe(n)&&Or(n)==Et}var co=ws?Xr(ws):Uy;function L_(n){return n===e}function B_(n){return Qe(n)&&Ir(n)==wt}function q_(n){return Qe(n)&&Or(n)==At}var j_=Cc(ph),$_=Cc(function(n,o){return n<=o});function yp(n){if(!n)return[];if($r(n))return jc(n)?Oi(n):jr(n);if(Bo&&n[Bo])return wv(n[Bo]());var o=Ir(n),c=o==at?eh:o==Lt?sc:uo;return c(n)}function Mn(n){if(!n)return n===0?n:0;if(n=wi(n),n===C||n===-C){var o=n<0?-1:1;return o*B}return n===n?n:0}function ce(n){var o=Mn(n),c=o%1;return o===o?c?o-c:o:0}function wp(n){return n?As(ce(n),0,g):0}function wi(n){if(typeof n=="number")return n;if(ti(n))return D;if(Je(n)){var o=typeof n.valueOf=="function"?n.valueOf():n;n=Je(o)?o+"":o}if(typeof n!="string")return n===0?n:+n;n=Bf(n);var c=ci.test(n);return c||hi.test(n)?re(n.slice(2),c?2:8):ai.test(n)?D:+n}function bp(n){return Qi(n,kr(n))}function k_(n){return n?As(ce(n),-O,O):n===0?n:0}function Me(n){return n==null?"":Zr(n)}var z_=so(function(n,o){if(Yo(o)||$r(o)){Qi(o,dr(o),n);return}for(var c in o)Te.call(o,c)&&zo(n,c,o[c])}),_p=so(function(n,o){Qi(o,kr(o),n)}),$c=so(function(n,o,c,m){Qi(o,kr(o),n,m)}),H_=so(function(n,o,c,m){Qi(o,dr(o),n,m)}),K_=In(ah);function V_(n,o){var c=no(n);return o==null?c:Zf(c,o)}var G_=le(function(n,o){n=je(n);var c=-1,m=o.length,A=m>2?o[2]:e;for(A&&Nr(o[0],o[1],A)&&(m=1);++c<m;)for(var N=o[c],K=kr(N),Y=-1,X=K.length;++Y<X;){var ct=K[Y],ut=n[ct];(ut===e||Ti(ut,eo[ct])&&!Te.call(n,ct))&&(n[ct]=N[ct])}return n}),W_=le(function(n){return n.push(e,Bd),fr(Ep,e,n)});function Y_(n,o){return Rf(n,jt(o,3),Ji)}function J_(n,o){return Rf(n,jt(o,3),uh)}function Q_(n,o){return n==null?n:ch(n,jt(o,3),kr)}function X_(n,o){return n==null?n:nd(n,jt(o,3),kr)}function Z_(n,o){return n&&Ji(n,jt(o,3))}function t2(n,o){return n&&uh(n,jt(o,3))}function e2(n){return n==null?[]:Ec(n,dr(n))}function r2(n){return n==null?[]:Ec(n,kr(n))}function $h(n,o,c){var m=n==null?e:Ss(n,o);return m===e?c:m}function i2(n,o){return n!=null&&$d(n,o,Dy)}function kh(n,o){return n!=null&&$d(n,o,xy)}var n2=Td(function(n,o,c){o!=null&&typeof o.toString!="function"&&(o=uc.call(o)),n[o]=c},Hh(zr)),s2=Td(function(n,o,c){o!=null&&typeof o.toString!="function"&&(o=uc.call(o)),Te.call(n,o)?n[o].push(c):n[o]=[c]},jt),o2=le(Ko);function dr(n){return $r(n)?Qf(n):dh(n)}function kr(n){return $r(n)?Qf(n,!0):Ly(n)}function a2(n,o){var c={};return o=jt(o,3),Ji(n,function(m,A,N){An(c,o(m,A,N),m)}),c}function c2(n,o){var c={};return o=jt(o,3),Ji(n,function(m,A,N){An(c,A,o(m,A,N))}),c}var u2=so(function(n,o,c){Ac(n,o,c)}),Ep=so(function(n,o,c,m){Ac(n,o,c,m)}),h2=In(function(n,o){var c={};if(n==null)return c;var m=!1;o=Ge(o,function(N){return N=Yn(N,n),m||(m=N.length>1),N}),Qi(n,xh(n),c),m&&(c=mi(c,_|I|S,nw));for(var A=o.length;A--;)wh(c,o[A]);return c});function l2(n,o){return Ap(n,Bc(jt(o)))}var f2=In(function(n,o){return n==null?{}:qy(n,o)});function Ap(n,o){if(n==null)return{};var c=Ge(xh(n),function(m){return[m]});return o=jt(o),pd(n,c,function(m,A){return o(m,A[0])})}function d2(n,o,c){o=Yn(o,n);var m=-1,A=o.length;for(A||(A=1,n=e);++m<A;){var N=n==null?e:n[Xi(o[m])];N===e&&(m=A,N=c),n=xn(N)?N.call(n):N}return n}function p2(n,o,c){return n==null?n:Go(n,o,c)}function g2(n,o,c,m){return m=typeof m=="function"?m:e,n==null?n:Go(n,o,c,m)}var Sp=Ud(dr),Ip=Ud(kr);function m2(n,o,c){var m=ie(n),A=m||Qn(n)||co(n);if(o=jt(o,4),c==null){var N=n&&n.constructor;A?c=m?new N:[]:Je(n)?c=xn(N)?no(fc(n)):{}:c={}}return(A?di:Ji)(n,function(K,Y,X){return o(c,K,Y,X)}),c}function v2(n,o){return n==null?!0:wh(n,o)}function y2(n,o,c){return n==null?n:wd(n,o,Eh(c))}function w2(n,o,c,m){return m=typeof m=="function"?m:e,n==null?n:wd(n,o,Eh(c),m)}function uo(n){return n==null?[]:th(n,dr(n))}function b2(n){return n==null?[]:th(n,kr(n))}function _2(n,o,c){return c===e&&(c=o,o=e),c!==e&&(c=wi(c),c=c===c?c:0),o!==e&&(o=wi(o),o=o===o?o:0),As(wi(n),o,c)}function E2(n,o,c){return o=Mn(o),c===e?(c=o,o=0):c=Mn(c),n=wi(n),My(n,o,c)}function A2(n,o,c){if(c&&typeof c!="boolean"&&Nr(n,o,c)&&(o=c=e),c===e&&(typeof o=="boolean"?(c=o,o=e):typeof n=="boolean"&&(c=n,n=e)),n===e&&o===e?(n=0,o=1):(n=Mn(n),o===e?(o=n,n=0):o=Mn(o)),n>o){var m=n;n=o,o=m}if(c||n%1||o%1){var A=Yf();return Sr(n+A*(o-n+Be("1e-"+((A+"").length-1))),o)}return mh(n,o)}var S2=oo(function(n,o,c){return o=o.toLowerCase(),n+(c?Dp(o):o)});function Dp(n){return zh(Me(n).toLowerCase())}function xp(n){return n=Me(n),n&&n.replace(lr,pv).replace(Ku,"")}function I2(n,o,c){n=Me(n),o=Zr(o);var m=n.length;c=c===e?m:As(ce(c),0,m);var A=c;return c-=o.length,c>=0&&n.slice(c,A)==o}function D2(n){return n=Me(n),n&&kt.test(n)?n.replace(Mr,gv):n}function x2(n){return n=Me(n),n&&Zt.test(n)?n.replace(xe,"\\$&"):n}var M2=oo(function(n,o,c){return n+(c?"-":"")+o.toLowerCase()}),P2=oo(function(n,o,c){return n+(c?" ":"")+o.toLowerCase()}),C2=Cd("toLowerCase");function O2(n,o,c){n=Me(n),o=ce(o);var m=o?Zs(n):0;if(!o||m>=o)return n;var A=(o-m)/2;return Pc(mc(A),c)+n+Pc(gc(A),c)}function N2(n,o,c){n=Me(n),o=ce(o);var m=o?Zs(n):0;return o&&m<o?n+Pc(o-m,c):n}function T2(n,o,c){n=Me(n),o=ce(o);var m=o?Zs(n):0;return o&&m<o?Pc(o-m,c)+n:n}function R2(n,o,c){return c||o==null?o=0:o&&(o=+o),$v(Me(n).replace(Yt,""),o||0)}function F2(n,o,c){return(c?Nr(n,o,c):o===e)?o=1:o=ce(o),vh(Me(n),o)}function U2(){var n=arguments,o=Me(n[0]);return n.length<3?o:o.replace(n[1],n[2])}var L2=oo(function(n,o,c){return n+(c?"_":"")+o.toLowerCase()});function B2(n,o,c){return c&&typeof c!="number"&&Nr(n,o,c)&&(o=c=e),c=c===e?g:c>>>0,c?(n=Me(n),n&&(typeof o=="string"||o!=null&&!jh(o))&&(o=Zr(o),!o&&Xs(n))?Jn(Oi(n),0,c):n.split(o,c)):[]}var q2=oo(function(n,o,c){return n+(c?" ":"")+zh(o)});function j2(n,o,c){return n=Me(n),c=c==null?0:As(ce(c),0,n.length),o=Zr(o),n.slice(c,c+o.length)==o}function $2(n,o,c){var m=x.templateSettings;c&&Nr(n,o,c)&&(o=e),n=Me(n),o=$c({},o,m,Ld);var A=$c({},o.imports,m.imports,Ld),N=dr(A),K=th(A,N),Y,X,ct=0,ut=o.interpolate||Ki,ft="__p += '",vt=rh((o.escape||Ki).source+"|"+ut.source+"|"+(ut===Kt?Ne:Ki).source+"|"+(o.evaluate||Ki).source+"|$","g"),Ft="//# sourceURL="+(Te.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Vu+"]")+`
`;n.replace(vt,function(Ht,de,_e,ei,Tr,ri){return _e||(_e=ei),ft+=n.slice(ct,ri).replace(cs,mv),de&&(Y=!0,ft+=`' +
__e(`+de+`) +
'`),Tr&&(X=!0,ft+=`';
`+Tr+`;
__p += '`),_e&&(ft+=`' +
((__t = (`+_e+`)) == null ? '' : __t) +
'`),ct=ri+Ht.length,Ht}),ft+=`';
`;var zt=Te.call(o,"variable")&&o.variable;if(!zt)ft=`with (obj) {
`+ft+`
}
`;else if(Oe.test(zt))throw new ee(h);ft=(X?ft.replace(ge,""):ft).replace(Ye,"$1").replace(we,"$1;"),ft="function("+(zt||"obj")+`) {
`+(zt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Y?", __e = _.escape":"")+(X?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ft+`return __p
}`;var he=Pp(function(){return Ie(N,Ft+"return "+ft).apply(e,K)});if(he.source=ft,qh(he))throw he;return he}function k2(n){return Me(n).toLowerCase()}function z2(n){return Me(n).toUpperCase()}function H2(n,o,c){if(n=Me(n),n&&(c||o===e))return Bf(n);if(!n||!(o=Zr(o)))return n;var m=Oi(n),A=Oi(o),N=qf(m,A),K=jf(m,A)+1;return Jn(m,N,K).join("")}function K2(n,o,c){if(n=Me(n),n&&(c||o===e))return n.slice(0,kf(n)+1);if(!n||!(o=Zr(o)))return n;var m=Oi(n),A=jf(m,Oi(o))+1;return Jn(m,0,A).join("")}function V2(n,o,c){if(n=Me(n),n&&(c||o===e))return n.replace(Yt,"");if(!n||!(o=Zr(o)))return n;var m=Oi(n),A=qf(m,Oi(o));return Jn(m,A).join("")}function G2(n,o){var c=dt,m=pt;if(Je(o)){var A="separator"in o?o.separator:A;c="length"in o?ce(o.length):c,m="omission"in o?Zr(o.omission):m}n=Me(n);var N=n.length;if(Xs(n)){var K=Oi(n);N=K.length}if(c>=N)return n;var Y=c-Zs(m);if(Y<1)return m;var X=K?Jn(K,0,Y).join(""):n.slice(0,Y);if(A===e)return X+m;if(K&&(Y+=X.length-Y),jh(A)){if(n.slice(Y).search(A)){var ct,ut=X;for(A.global||(A=rh(A.source,Me(fe.exec(A))+"g")),A.lastIndex=0;ct=A.exec(ut);)var ft=ct.index;X=X.slice(0,ft===e?Y:ft)}}else if(n.indexOf(Zr(A),Y)!=Y){var vt=X.lastIndexOf(A);vt>-1&&(X=X.slice(0,vt))}return X+m}function W2(n){return n=Me(n),n&&Gt.test(n)?n.replace(Ee,Av):n}var Y2=oo(function(n,o,c){return n+(c?" ":"")+o.toUpperCase()}),zh=Cd("toUpperCase");function Mp(n,o,c){return n=Me(n),o=c?e:o,o===e?yv(n)?Dv(n):uv(n):n.match(o)||[]}var Pp=le(function(n,o){try{return fr(n,e,o)}catch(c){return qh(c)?c:new ee(c)}}),J2=In(function(n,o){return di(o,function(c){c=Xi(c),An(n,c,Lh(n[c],n))}),n});function Q2(n){var o=n==null?0:n.length,c=jt();return n=o?Ge(n,function(m){if(typeof m[1]!="function")throw new pi(u);return[c(m[0]),m[1]]}):[],le(function(m){for(var A=-1;++A<o;){var N=n[A];if(fr(N[0],this,m))return fr(N[1],this,m)}})}function X2(n){return Ay(mi(n,_))}function Hh(n){return function(){return n}}function Z2(n,o){return n==null||n!==n?o:n}var t3=Nd(),e3=Nd(!0);function zr(n){return n}function Kh(n){return cd(typeof n=="function"?n:mi(n,_))}function r3(n){return hd(mi(n,_))}function i3(n,o){return ld(n,mi(o,_))}var n3=le(function(n,o){return function(c){return Ko(c,n,o)}}),s3=le(function(n,o){return function(c){return Ko(n,c,o)}});function Vh(n,o,c){var m=dr(o),A=Ec(o,m);c==null&&!(Je(o)&&(A.length||!m.length))&&(c=o,o=n,n=this,A=Ec(o,dr(o)));var N=!(Je(c)&&"chain"in c)||!!c.chain,K=xn(n);return di(A,function(Y){var X=o[Y];n[Y]=X,K&&(n.prototype[Y]=function(){var ct=this.__chain__;if(N||ct){var ut=n(this.__wrapped__),ft=ut.__actions__=jr(this.__actions__);return ft.push({func:X,args:arguments,thisArg:n}),ut.__chain__=ct,ut}return X.apply(n,Hn([this.value()],arguments))})}),n}function o3(){return be._===this&&(be._=Nv),this}function Gh(){}function a3(n){return n=ce(n),le(function(o){return fd(o,n)})}var c3=Sh(Ge),u3=Sh(Tf),h3=Sh(Yu);function Cp(n){return Oh(n)?Ju(Xi(n)):jy(n)}function l3(n){return function(o){return n==null?e:Ss(n,o)}}var f3=Rd(),d3=Rd(!0);function Wh(){return[]}function Yh(){return!1}function p3(){return{}}function g3(){return""}function m3(){return!0}function v3(n,o){if(n=ce(n),n<1||n>O)return[];var c=g,m=Sr(n,g);o=jt(o),n-=g;for(var A=Zu(m,o);++c<n;)o(c);return A}function y3(n){return ie(n)?Ge(n,Xi):ti(n)?[n]:jr(Jd(Me(n)))}function w3(n){var o=++Cv;return Me(n)+o}var b3=Mc(function(n,o){return n+o},0),_3=Ih("ceil"),E3=Mc(function(n,o){return n/o},1),A3=Ih("floor");function S3(n){return n&&n.length?_c(n,zr,hh):e}function I3(n,o){return n&&n.length?_c(n,jt(o,2),hh):e}function D3(n){return Uf(n,zr)}function x3(n,o){return Uf(n,jt(o,2))}function M3(n){return n&&n.length?_c(n,zr,ph):e}function P3(n,o){return n&&n.length?_c(n,jt(o,2),ph):e}var C3=Mc(function(n,o){return n*o},1),O3=Ih("round"),N3=Mc(function(n,o){return n-o},0);function T3(n){return n&&n.length?Xu(n,zr):0}function R3(n,o){return n&&n.length?Xu(n,jt(o,2)):0}return x.after=r_,x.ary=ap,x.assign=z_,x.assignIn=_p,x.assignInWith=$c,x.assignWith=H_,x.at=K_,x.before=cp,x.bind=Lh,x.bindAll=J2,x.bindKey=up,x.castArray=p_,x.chain=np,x.chunk=Aw,x.compact=Sw,x.concat=Iw,x.cond=Q2,x.conforms=X2,x.constant=Hh,x.countBy=Tb,x.create=V_,x.curry=hp,x.curryRight=lp,x.debounce=fp,x.defaults=G_,x.defaultsDeep=W_,x.defer=i_,x.delay=n_,x.difference=Dw,x.differenceBy=xw,x.differenceWith=Mw,x.drop=Pw,x.dropRight=Cw,x.dropRightWhile=Ow,x.dropWhile=Nw,x.fill=Tw,x.filter=Fb,x.flatMap=Bb,x.flatMapDeep=qb,x.flatMapDepth=jb,x.flatten=tp,x.flattenDeep=Rw,x.flattenDepth=Fw,x.flip=s_,x.flow=t3,x.flowRight=e3,x.fromPairs=Uw,x.functions=e2,x.functionsIn=r2,x.groupBy=$b,x.initial=Bw,x.intersection=qw,x.intersectionBy=jw,x.intersectionWith=$w,x.invert=n2,x.invertBy=s2,x.invokeMap=zb,x.iteratee=Kh,x.keyBy=Hb,x.keys=dr,x.keysIn=kr,x.map=Fc,x.mapKeys=a2,x.mapValues=c2,x.matches=r3,x.matchesProperty=i3,x.memoize=Lc,x.merge=u2,x.mergeWith=Ep,x.method=n3,x.methodOf=s3,x.mixin=Vh,x.negate=Bc,x.nthArg=a3,x.omit=h2,x.omitBy=l2,x.once=o_,x.orderBy=Kb,x.over=c3,x.overArgs=a_,x.overEvery=u3,x.overSome=h3,x.partial=Bh,x.partialRight=dp,x.partition=Vb,x.pick=f2,x.pickBy=Ap,x.property=Cp,x.propertyOf=l3,x.pull=Kw,x.pullAll=rp,x.pullAllBy=Vw,x.pullAllWith=Gw,x.pullAt=Ww,x.range=f3,x.rangeRight=d3,x.rearg=c_,x.reject=Yb,x.remove=Yw,x.rest=u_,x.reverse=Fh,x.sampleSize=Qb,x.set=p2,x.setWith=g2,x.shuffle=Xb,x.slice=Jw,x.sortBy=e_,x.sortedUniq=ib,x.sortedUniqBy=nb,x.split=B2,x.spread=h_,x.tail=sb,x.take=ob,x.takeRight=ab,x.takeRightWhile=cb,x.takeWhile=ub,x.tap=Sb,x.throttle=l_,x.thru=Rc,x.toArray=yp,x.toPairs=Sp,x.toPairsIn=Ip,x.toPath=y3,x.toPlainObject=bp,x.transform=m2,x.unary=f_,x.union=hb,x.unionBy=lb,x.unionWith=fb,x.uniq=db,x.uniqBy=pb,x.uniqWith=gb,x.unset=v2,x.unzip=Uh,x.unzipWith=ip,x.update=y2,x.updateWith=w2,x.values=uo,x.valuesIn=b2,x.without=mb,x.words=Mp,x.wrap=d_,x.xor=vb,x.xorBy=yb,x.xorWith=wb,x.zip=bb,x.zipObject=_b,x.zipObjectDeep=Eb,x.zipWith=Ab,x.entries=Sp,x.entriesIn=Ip,x.extend=_p,x.extendWith=$c,Vh(x,x),x.add=b3,x.attempt=Pp,x.camelCase=S2,x.capitalize=Dp,x.ceil=_3,x.clamp=_2,x.clone=g_,x.cloneDeep=v_,x.cloneDeepWith=y_,x.cloneWith=m_,x.conformsTo=w_,x.deburr=xp,x.defaultTo=Z2,x.divide=E3,x.endsWith=I2,x.eq=Ti,x.escape=D2,x.escapeRegExp=x2,x.every=Rb,x.find=Ub,x.findIndex=Xd,x.findKey=Y_,x.findLast=Lb,x.findLastIndex=Zd,x.findLastKey=J_,x.floor=A3,x.forEach=sp,x.forEachRight=op,x.forIn=Q_,x.forInRight=X_,x.forOwn=Z_,x.forOwnRight=t2,x.get=$h,x.gt=b_,x.gte=__,x.has=i2,x.hasIn=kh,x.head=ep,x.identity=zr,x.includes=kb,x.indexOf=Lw,x.inRange=E2,x.invoke=o2,x.isArguments=xs,x.isArray=ie,x.isArrayBuffer=E_,x.isArrayLike=$r,x.isArrayLikeObject=er,x.isBoolean=A_,x.isBuffer=Qn,x.isDate=S_,x.isElement=I_,x.isEmpty=D_,x.isEqual=x_,x.isEqualWith=M_,x.isError=qh,x.isFinite=P_,x.isFunction=xn,x.isInteger=pp,x.isLength=qc,x.isMap=gp,x.isMatch=C_,x.isMatchWith=O_,x.isNaN=N_,x.isNative=T_,x.isNil=F_,x.isNull=R_,x.isNumber=mp,x.isObject=Je,x.isObjectLike=Qe,x.isPlainObject=Qo,x.isRegExp=jh,x.isSafeInteger=U_,x.isSet=vp,x.isString=jc,x.isSymbol=ti,x.isTypedArray=co,x.isUndefined=L_,x.isWeakMap=B_,x.isWeakSet=q_,x.join=kw,x.kebabCase=M2,x.last=yi,x.lastIndexOf=zw,x.lowerCase=P2,x.lowerFirst=C2,x.lt=j_,x.lte=$_,x.max=S3,x.maxBy=I3,x.mean=D3,x.meanBy=x3,x.min=M3,x.minBy=P3,x.stubArray=Wh,x.stubFalse=Yh,x.stubObject=p3,x.stubString=g3,x.stubTrue=m3,x.multiply=C3,x.nth=Hw,x.noConflict=o3,x.noop=Gh,x.now=Uc,x.pad=O2,x.padEnd=N2,x.padStart=T2,x.parseInt=R2,x.random=A2,x.reduce=Gb,x.reduceRight=Wb,x.repeat=F2,x.replace=U2,x.result=d2,x.round=O3,x.runInContext=Q,x.sample=Jb,x.size=Zb,x.snakeCase=L2,x.some=t_,x.sortedIndex=Qw,x.sortedIndexBy=Xw,x.sortedIndexOf=Zw,x.sortedLastIndex=tb,x.sortedLastIndexBy=eb,x.sortedLastIndexOf=rb,x.startCase=q2,x.startsWith=j2,x.subtract=N3,x.sum=T3,x.sumBy=R3,x.template=$2,x.times=v3,x.toFinite=Mn,x.toInteger=ce,x.toLength=wp,x.toLower=k2,x.toNumber=wi,x.toSafeInteger=k_,x.toString=Me,x.toUpper=z2,x.trim=H2,x.trimEnd=K2,x.trimStart=V2,x.truncate=G2,x.unescape=W2,x.uniqueId=w3,x.upperCase=Y2,x.upperFirst=zh,x.each=sp,x.eachRight=op,x.first=ep,Vh(x,function(){var n={};return Ji(x,function(o,c){Te.call(x.prototype,c)||(n[c]=o)}),n}(),{chain:!1}),x.VERSION=i,di(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){x[n].placeholder=x}),di(["drop","take"],function(n,o){me.prototype[n]=function(c){c=c===e?1:cr(ce(c),0);var m=this.__filtered__&&!o?new me(this):this.clone();return m.__filtered__?m.__takeCount__=Sr(c,m.__takeCount__):m.__views__.push({size:Sr(c,g),type:n+(m.__dir__<0?"Right":"")}),m},me.prototype[n+"Right"]=function(c){return this.reverse()[n](c).reverse()}}),di(["filter","map","takeWhile"],function(n,o){var c=o+1,m=c==y||c==P;me.prototype[n]=function(A){var N=this.clone();return N.__iteratees__.push({iteratee:jt(A,3),type:c}),N.__filtered__=N.__filtered__||m,N}}),di(["head","last"],function(n,o){var c="take"+(o?"Right":"");me.prototype[n]=function(){return this[c](1).value()[0]}}),di(["initial","tail"],function(n,o){var c="drop"+(o?"":"Right");me.prototype[n]=function(){return this.__filtered__?new me(this):this[c](1)}}),me.prototype.compact=function(){return this.filter(zr)},me.prototype.find=function(n){return this.filter(n).head()},me.prototype.findLast=function(n){return this.reverse().find(n)},me.prototype.invokeMap=le(function(n,o){return typeof n=="function"?new me(this):this.map(function(c){return Ko(c,n,o)})}),me.prototype.reject=function(n){return this.filter(Bc(jt(n)))},me.prototype.slice=function(n,o){n=ce(n);var c=this;return c.__filtered__&&(n>0||o<0)?new me(c):(n<0?c=c.takeRight(-n):n&&(c=c.drop(n)),o!==e&&(o=ce(o),c=o<0?c.dropRight(-o):c.take(o-n)),c)},me.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},me.prototype.toArray=function(){return this.take(g)},Ji(me.prototype,function(n,o){var c=/^(?:filter|find|map|reject)|While$/.test(o),m=/^(?:head|last)$/.test(o),A=x[m?"take"+(o=="last"?"Right":""):o],N=m||/^find/.test(o);A&&(x.prototype[o]=function(){var K=this.__wrapped__,Y=m?[1]:arguments,X=K instanceof me,ct=Y[0],ut=X||ie(K),ft=function(de){var _e=A.apply(x,Hn([de],Y));return m&&vt?_e[0]:_e};ut&&c&&typeof ct=="function"&&ct.length!=1&&(X=ut=!1);var vt=this.__chain__,Ft=!!this.__actions__.length,zt=N&&!vt,he=X&&!Ft;if(!N&&ut){K=he?K:new me(this);var Ht=n.apply(K,Y);return Ht.__actions__.push({func:Rc,args:[ft],thisArg:e}),new gi(Ht,vt)}return zt&&he?n.apply(this,Y):(Ht=this.thru(ft),zt?m?Ht.value()[0]:Ht.value():Ht)})}),di(["pop","push","shift","sort","splice","unshift"],function(n){var o=oc[n],c=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",m=/^(?:pop|shift)$/.test(n);x.prototype[n]=function(){var A=arguments;if(m&&!this.__chain__){var N=this.value();return o.apply(ie(N)?N:[],A)}return this[c](function(K){return o.apply(ie(K)?K:[],A)})}}),Ji(me.prototype,function(n,o){var c=x[o];if(c){var m=c.name+"";Te.call(io,m)||(io[m]=[]),io[m].push({name:o,func:c})}}),io[xc(e,Z).name]=[{name:"wrapper",func:e}],me.prototype.clone=Wv,me.prototype.reverse=Yv,me.prototype.value=Jv,x.prototype.at=Ib,x.prototype.chain=Db,x.prototype.commit=xb,x.prototype.next=Mb,x.prototype.plant=Cb,x.prototype.reverse=Ob,x.prototype.toJSON=x.prototype.valueOf=x.prototype.value=Nb,x.prototype.first=x.prototype.head,Bo&&(x.prototype[Bo]=Pb),x},to=xv();tr?((tr.exports=to)._=to,qe._=to):be._=to}).call(ua)})(rf,rf.exports);var PP=Object.defineProperty,CP=Object.defineProperties,OP=Object.getOwnPropertyDescriptors,jg=Object.getOwnPropertySymbols,NP=Object.prototype.hasOwnProperty,TP=Object.prototype.propertyIsEnumerable,$g=(r,t,e)=>t in r?PP(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Qc=(r,t)=>{for(var e in t||(t={}))NP.call(t,e)&&$g(r,e,t[e]);if(jg)for(var e of jg(t))TP.call(t,e)&&$g(r,e,t[e]);return r},RP=(r,t)=>CP(r,OP(t));function ki(r,t,e){var i;const s=pa(r);return((i=t.rpcMap)==null?void 0:i[s.reference])||`${ev}?chainId=${s.namespace}:${s.reference}&projectId=${e}`}function Vs(r){return r.includes(":")?r.split(":")[1]:r}function rv(r){return r.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function FP(r,t){const e=Object.keys(t.namespaces).filter(s=>s.includes(r));if(!e.length)return[];const i=[];return e.forEach(s=>{const a=t.namespaces[s].accounts;i.push(...a)}),i}function Il(r={},t={}){const e=kg(r),i=kg(t);return rf.exports.merge(e,i)}function kg(r){var t,e,i,s;const a={};if(!xa(r))return a;for(const[u,h]of Object.entries(r)){const d=Sf(u)?[u]:h.chains,l=h.methods||[],w=h.events||[],_=h.rpcMap||{},I=fa(u);a[I]=RP(Qc(Qc({},a[I]),h),{chains:iu(d,(t=a[I])==null?void 0:t.chains),methods:iu(l,(e=a[I])==null?void 0:e.methods),events:iu(w,(i=a[I])==null?void 0:i.events),rpcMap:Qc(Qc({},_),(s=a[I])==null?void 0:s.rpcMap)})}return a}function UP(r){return r.includes(":")?r.split(":")[2]:r}function zg(r){const t={};for(const[e,i]of Object.entries(r)){const s=i.methods||[],a=i.events||[],u=i.accounts||[],h=Sf(e)?[e]:i.chains?i.chains:rv(i.accounts);t[e]={chains:h,methods:s,events:a,accounts:u}}return t}function Dl(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const iv={},Pe=r=>iv[r],xl=(r,t)=>{iv[r]=t};class LP{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;const s=Vs(e);t[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}var BP=Object.defineProperty,qP=Object.defineProperties,jP=Object.getOwnPropertyDescriptors,Hg=Object.getOwnPropertySymbols,$P=Object.prototype.hasOwnProperty,kP=Object.prototype.propertyIsEnumerable,Kg=(r,t,e)=>t in r?BP(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Vg=(r,t)=>{for(var e in t||(t={}))$P.call(t,e)&&Kg(r,e,t[e]);if(Hg)for(var e of Hg(t))kP.call(t,e)&&Kg(r,e,t[e]);return r},Gg=(r,t)=>qP(r,jP(t));class zP{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(t);case"wallet_getCallsStatus":return await this.getCallStatus(t)}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(parseInt(t),e),this.chainId=parseInt(t),this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,e){const i=e||ki(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;const s=parseInt(Vs(e));t[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}async handleSwitchChain(t){var e,i;let s=t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const a=parseInt(s,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}async getCapabilities(t){var e,i,s;const a=(i=(e=t.request)==null?void 0:e.params)==null?void 0:i[0];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const u=this.client.session.get(t.topic),h=((s=u==null?void 0:u.sessionProperties)==null?void 0:s.capabilities)||{};if(h!=null&&h[a])return h==null?void 0:h[a];const d=await this.client.request(t);try{await this.client.session.update(t.topic,{sessionProperties:Gg(Vg({},u.sessionProperties||{}),{capabilities:Gg(Vg({},h||{}),{[a]:d})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return d}async getCallStatus(t){var e,i;const s=this.client.session.get(t.topic),a=(e=s.sessionProperties)==null?void 0:e.bundler_name;if(a){const h=this.getBundlerUrl(t.chainId,a);try{return await this.getUserOperationReceipt(h,t)}catch(d){console.warn("Failed to fetch call status from bundler",d,h)}}const u=(i=s.sessionProperties)==null?void 0:i.bundler_url;if(u)try{return await this.getUserOperationReceipt(u,t)}catch(h){console.warn("Failed to fetch call status from custom bundler",h,u)}if(this.namespace.methods.includes(t.request.method))return await this.client.request(t);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(t,e){var i;const s=new URL(t),a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ns("eth_getUserOperationReceipt",[(i=e.request.params)==null?void 0:i[0]]))});if(!a.ok)throw new Error(`Failed to fetch user operation receipt - ${a.status}`);return await a.json()}getBundlerUrl(t,e){return`${MP}?projectId=${this.client.core.projectId}&chainId=${t}&bundler=${e}`}}class HP{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;const s=Vs(e);t[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}class KP{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;const s=Vs(e);t[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}class VP{constructor(t){this.name="algorand",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){const i=e||ki(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new zi(new wn(i,Pe("disableProviderPing")))}}class GP{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{const i=this.getCardanoRPCUrl(e),s=Vs(e);t[s]=this.createHttpProvider(s,i)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}getCardanoRPCUrl(t){const e=this.namespace.rpcMap;if(e)return e[t]}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||this.getCardanoRPCUrl(t);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}class WP{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;const s=Vs(e);t[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}class YP{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;const s=Vs(e);t[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}class JP{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const i=e||ki(`${this.name}:${t}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace);return typeof i>"u"?void 0:new zi(new wn(i,Pe("disableProviderPing")))}}class QP{constructor(t){this.name=vo,this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(t.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(t.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(t.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(t.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider(t.chainId).request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var t,e;const i={};return(e=(t=this.namespace)==null?void 0:t.accounts)==null||e.forEach(s=>{const a=pa(s);i[`${a.namespace}:${a.reference}`]=this.createHttpProvider(s)}),i}getHttpProvider(t){const e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){const i=e||ki(t,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);return new zi(new wn(i,Pe("disableProviderPing")))}}var XP=Object.defineProperty,ZP=Object.defineProperties,tC=Object.getOwnPropertyDescriptors,Wg=Object.getOwnPropertySymbols,eC=Object.prototype.hasOwnProperty,rC=Object.prototype.propertyIsEnumerable,Yg=(r,t,e)=>t in r?XP(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Xc=(r,t)=>{for(var e in t||(t={}))eC.call(t,e)&&Yg(r,e,t[e]);if(Wg)for(var e of Wg(t))rC.call(t,e)&&Yg(r,e,t[e]);return r},Ml=(r,t)=>ZP(r,tC(t));class Of{constructor(t){this.events=new of,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Pa(xu({level:(t==null?void 0:t.logger)||Bg})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const e=new Of(t);return await e.initialize(),e}async request(t,e,i){const[s,a]=this.validateChain(e);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Xc({},t),chainId:`${s}:${a}`,topic:this.session.topic,expiry:i})}sendAsync(t,e,i,s){const a=new Date().getTime();this.request(t,i,s).then(u=>e(null,Fu(a,u))).catch(u=>e(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Re("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t,e){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();const{uri:i,response:s}=await this.client.authenticate(t,e);i&&(this.uri=i,this.events.emit("display_uri",i));const a=await s();if(this.session=a.session,this.session){const u=zg(this.session.namespaces);this.namespaces=Il(this.namespaces,u),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let e=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(e>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:s}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await s().then(a=>{this.session=a;const u=zg(a.namespaces);this.namespaces=Il(this.namespaces,u),this.persist("namespaces",this.namespaces)}).catch(a=>{if(a.message!==tv)throw a;e++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,e){try{if(!this.session)return;const[i,s]=this.validateChain(t),a=this.getProvider(i);a.name===vo?a.setDefaultChain(`${i}:${s}`,e):a.setDefaultChain(s,e)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll();if(mn(e)){for(const i of e)t.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Cf.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Bg,relayUrl:this.providerOpts.relayUrl||IP,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(e=>fa(e)))];xl("client",this.client),xl("events",this.events),xl("disableProviderPing",this.disableProviderPing),t.forEach(e=>{if(!this.session)return;const i=FP(e,this.session),s=rv(i),a=Il(this.namespaces,this.optionalNamespaces),u=Ml(Xc({},a[e]),{accounts:i,chains:s});switch(e){case"eip155":this.rpcProviders[e]=new zP({namespace:u});break;case"algorand":this.rpcProviders[e]=new VP({namespace:u});break;case"solana":this.rpcProviders[e]=new HP({namespace:u});break;case"cosmos":this.rpcProviders[e]=new KP({namespace:u});break;case"polkadot":this.rpcProviders[e]=new LP({namespace:u});break;case"cip34":this.rpcProviders[e]=new GP({namespace:u});break;case"elrond":this.rpcProviders[e]=new WP({namespace:u});break;case"multiversx":this.rpcProviders[e]=new YP({namespace:u});break;case"near":this.rpcProviders[e]=new JP({namespace:u});break;default:this.rpcProviders[vo]?this.rpcProviders[vo].updateNamespace(u):this.rpcProviders[vo]=new QP({namespace:u})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:e}=t,{event:i}=e;if(i.name==="accountsChanged"){const s=i.data;s&&mn(s)&&this.events.emit("accountsChanged",s.map(UP))}else if(i.name==="chainChanged"){const s=e.chainId,a=e.event.data,u=fa(s),h=Dl(s)!==Dl(a)?`${u}:${Dl(a)}`:s;this.onChainChanged(h)}else this.events.emit(i.name,i.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:e})=>{var i;const{namespaces:s}=e,a=(i=this.client)==null?void 0:i.session.get(t);this.session=Ml(Xc({},a),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ml(Xc({},Re("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Hi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){return this.rpcProviders[t]||this.rpcProviders[vo]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var e;this.getProvider(t).updateNamespace((e=this.session)==null?void 0:e.namespaces[t])})}setNamespaces(t){const{namespaces:e,optionalNamespaces:i,sessionProperties:s}=t;e&&Object.keys(e).length&&(this.namespaces=e),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=s,this.persist("namespaces",e),this.persist("optionalNamespaces",i)}validateChain(t){const[e,i]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[e,i];if(e&&!Object.keys(this.namespaces||{}).map(u=>fa(u)).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);if(e&&i)return[e,i];const s=fa(Object.keys(this.namespaces)[0]),a=this.rpcProviders[s].getDefaultChain();return[s,a]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,e=!1){if(!this.namespaces)return;const[i,s]=this.validateChain(t);s&&(e||this.getProvider(i).setDefaultChain(s),this.namespaces[i]?this.namespaces[i].defaultChain=s:this.namespaces[`${i}:${s}`]?this.namespaces[`${i}:${s}`].defaultChain=s:this.namespaces[`${i}:${s}`]={defaultChain:s},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",s))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,e){this.client.core.storage.setItem(`${qg}/${t}`,e)}async getFromStore(t){return await this.client.core.storage.getItem(`${qg}/${t}`)}}const iC=Of,nC="wc",sC="ethereum_provider",oC=`${nC}@2:${sC}:`,aC="https://rpc.walletconnect.org/v1/",nf=["eth_sendTransaction","personal_sign"],cC=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],sf=["chainChanged","accountsChanged"],uC=["chainChanged","accountsChanged","message","disconnect","connect"];var hC=Object.defineProperty,lC=Object.defineProperties,fC=Object.getOwnPropertyDescriptors,Jg=Object.getOwnPropertySymbols,dC=Object.prototype.hasOwnProperty,pC=Object.prototype.propertyIsEnumerable,Qg=(r,t,e)=>t in r?hC(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,yo=(r,t)=>{for(var e in t||(t={}))dC.call(t,e)&&Qg(r,e,t[e]);if(Jg)for(var e of Jg(t))pC.call(t,e)&&Qg(r,e,t[e]);return r},Pl=(r,t)=>lC(r,fC(t));function Su(r){return Number(r[0].split(":")[1])}function Zc(r){return`0x${r.toString(16)}`}function gC(r){const{chains:t,optionalChains:e,methods:i,optionalMethods:s,events:a,optionalEvents:u,rpcMap:h}=r;if(!mn(t))throw new Error("Invalid chains");const d={chains:t,methods:i||nf,events:a||sf,rpcMap:yo({},t.length?{[Su(t)]:h[Su(t)]}:{})},l=a==null?void 0:a.filter(S=>!sf.includes(S)),w=i==null?void 0:i.filter(S=>!nf.includes(S));if(!e&&!u&&!s&&!(l!=null&&l.length)&&!(w!=null&&w.length))return{required:t.length?d:void 0};const _=(l==null?void 0:l.length)&&(w==null?void 0:w.length)||!e,I={chains:[...new Set(_?d.chains.concat(e||[]):e)],methods:[...new Set(d.methods.concat(s!=null&&s.length?s:cC))],events:[...new Set(d.events.concat(u!=null&&u.length?u:uC))],rpcMap:h};return{required:t.length?d:void 0,optional:e.length?I:void 0}}class Nf{constructor(){this.events=new Mi.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=oC,this.on=(t,e)=>(this.events.on(t,e),this),this.once=(t,e)=>(this.events.once(t,e),this),this.removeListener=(t,e)=>(this.events.removeListener(t,e),this),this.off=(t,e)=>(this.events.off(t,e),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const e=new Nf;return await e.initialize(t),e}async request(t,e){return await this.signer.request(t,this.formatChainId(this.chainId),e)}sendAsync(t,e,i){this.signer.sendAsync(t,e,this.formatChainId(this.chainId),i)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:e,optional:i}=gC(this.rpc);try{const s=await new Promise(async(u,h)=>{var d;this.rpc.showQrModal&&((d=this.modal)==null||d.subscribeModal(l=>{!l.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),h(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Pl(yo({namespaces:yo({},e&&{[this.namespace]:e})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(l=>{u(l)}).catch(l=>{h(new Error(l.message))})});if(!s)return;const a=f0(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Zc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async authenticate(t,e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:t==null?void 0:t.chains});try{const i=await new Promise(async(a,u)=>{var h;this.rpc.showQrModal&&((h=this.modal)==null||h.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),u(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Pl(yo({},t),{chains:this.rpc.chains}),e).then(d=>{a(d)}).catch(d=>{u(new Error(d.message))})}),s=i.session;if(s){const a=f0(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Zc(this.chainId)})}return i}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:e}=t,{event:i}=e;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const e=parseInt(t);this.chainId=e,this.events.emit("chainChanged",Zc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Pl(yo({},Re("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var e,i;this.rpc.showQrModal&&((e=this.modal)==null||e.closeModal(),(i=this.modal)==null||i.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const e=t.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));e.length&&(this.chainId=e[0],this.events.emit("chainChanged",Zc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const e=this.parseChainId(t);this.chainId=e,this.switchEthereumChain(e)}}parseAccountId(t){const[e,i,s]=t.split(":");return{chainId:`${e}:${i}`,address:s}}setAccounts(t){this.accounts=t.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var e,i;const s=(e=t==null?void 0:t.chains)!=null?e:[],a=(i=t==null?void 0:t.optionalChains)!=null?i:[],u=s.concat(a);if(!u.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const h=s.length?(t==null?void 0:t.methods)||nf:[],d=s.length?(t==null?void 0:t.events)||sf:[],l=(t==null?void 0:t.optionalMethods)||[],w=(t==null?void 0:t.optionalEvents)||[],_=(t==null?void 0:t.rpcMap)||this.buildRpcMap(u,t.projectId),I=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(S=>this.formatChainId(S)),optionalChains:a.map(S=>this.formatChainId(S)),methods:h,events:d,optionalMethods:l,optionalEvents:w,rpcMap:_,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:I,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,e){const i={};return t.forEach(s=>{i[s]=this.getRpcUrl(s,e)}),i}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Su(this.rpc.chains):Su(this.rpc.optionalChains),this.signer=await iC.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions,customStoragePrefix:t.customStoragePrefix,telemetryEnabled:t.telemetryEnabled}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{const{WalletConnectModal:i}=await B3(()=>import("./index-96QSbOuv.js").then(s=>s.i),__vite__mapDeps([0,1,2]));e=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e(yo({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:e,optionalChains:i,rpcMap:s}=t;e&&mn(e)&&(this.rpc.chains=e.map(a=>this.formatChainId(a)),e.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)})),i&&mn(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(a=>this.formatChainId(a)),i.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)}))}getRpcUrl(t,e){var i;return((i=this.rpc.rpcMap)==null?void 0:i[t])||`${aC}?chainId=eip155:${t}&projectId=${e||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),e=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:e==null?void 0:e.accounts),this.setAccounts(e==null?void 0:e.accounts)}catch(t){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(t),await this.disconnect().catch(e=>this.signer.logger.warn(e))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(e=>this.parseAccount(e))}}const jC=Nf;export{jC as EthereumProvider,uC as OPTIONAL_EVENTS,cC as OPTIONAL_METHODS,sf as REQUIRED_EVENTS,nf as REQUIRED_METHODS,Nf as default};
